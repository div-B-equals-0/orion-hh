* UVES observations of HH objects in Orion

** Original Proposal
+ [[file:docs/092.C-0323.pdf]]
+ [[https://www.evernote.com/l/ACQYu1coCdVPE5VGdvX8V1HmLkwqEcXjmRM][Evernote note]] with finding charts


| Object        |
|---------------|
| HH 514        |
| HH 528        |
| HH 523        |
| HH 529-I      |
| HH 529-II/III |
| HH 202-N      |
| HH 203        |
| HH 204        |




** Discussions 2019 August
+ Discussions between Eduardo and Will during Eduardo's visit to Morelia
*** The back-scattered component
+ Gives red-shifted shoulder/wing to many lines
  + More prominent in higher ionization (e.g., [O III]) but also seen in [N II]
+ See the positive channels of these isovelocity maps:
  + [[file:figs/multi-panel-isovel-oiii-nii.pdf]]
  + Based on Doi:2004a and Garcia-Diaz:2008a
+ This mainly maps the distribution of dust in the neutral/molecular filaments
  + Same ones that are traced by fluorescent O I lines
+ Secondary influence of orientation effects
  + In the most red-shifted channels (Vhel > +50 km/s), face-on illuminated filaments predominate
  + Edge-on illuminated filaments are seen at intermediate red-shifted velocities (Vhel ~ +40 km/s).  Examples are:
    + Bright Bar
    + SW Compact Bar
*** Finding chart for nebular features 
This is from Garcia-Diaz:2007a
[[figs/finding-chart-orion.png]]
*** Other ideas for Eduardo to pursue
1. Diagnostics of density/temperature from the O II permitted lines
   - See Peimbert & Peimbert 2013ApJ...778...89P
   - Also, see Will's notes on analysis of this for nebula
     - [X] Add those notes to project. Done
     - [[file:notebooks/Adal%20spectra.ipynb][Adal spectra]]
     - [[file:notebooks/Manu%20Spectra.ipynb][Manu spectra]]

** Background reading
+ OW Coordinate notation
  + See Fig 3 of Doi:2004a
+ Orion velocity maps
  + Odell:1997b "High Velocity Features in the Orion Nebula"
    + http://adsabs.harvard.edu/abs/1997AJ....114.2016O
    + FP spectra of Huygens region, HH 203/4
  + Doi:2004a "Internal Velocities in the Orion Nebula: Large Radial Velocity Features"
    + http://adsabs.harvard.edu/abs/2004AJ....127.3456D
    + Multiple longslit echelle spectra
    + HH objects, Big Arc, DOH objects
  + Henney:2007b "Large-Scale Flows from Orion South"
    + http://adsabs.harvard.edu/abs/2007AJ....133.2192H
  + Garcia-Diaz:2007a "Velocity Structure in the Orion Nebula. I. Spectral Mapping in Low-Ionization Lines"
    + http://adsabs.harvard.edu/abs/2007AJ....133..952G
  + Garcia-Diaz:2008a "Velocity Structure in the Orion Nebula. II. Emission Line Atlas of Partially Ionized to Fully Ionized Gas"
    + http://adsabs.harvard.edu/abs/2008RMxAA..44..181G
+ Orion proper motions and imaging
  + Hester:1991a
  + Odell:1997a "Herbig Haro Objects in the Orion Nebula."
    + http://adsabs.harvard.edu/abs/1997AJ....114..730O
    + HST imaging: HH 202, 202, 204/4
  + Odell:2015a "THE NATURE AND FREQUENCY OF OUTFLOWS FROM STARS IN THE CENTRAL ORION NEBULA CLUSTER"
    + http://adsabs.harvard.edu/abs/2015AJ....150..108O
+ Spectrophotometry
  + Blagrave:2006a "A Photoionized Herbig-Haro Object in the Orion Nebula"
    + http://adsabs.harvard.edu/abs/2006ApJ...644.1006B
    + HH 529 spectra
  + Mesa-Delgado:2009a "Properties of the ionized gas in HH 202. II: Results from echelle spectrophotometry with UVES"
    + http://adsabs.harvard.edu/abs/2009MNRAS.395..855M
  + Espiritu:2017a "DUST DESTRUCTION AND THERMAL INHOMOGENEITIES IN THE ORION NEBULA. RESULTS OF HH 202."
    + http://adsabs.harvard.edu/abs/2017cfe..confE..10E
  + Weilbacher:2015a "A MUSE map of the central Orion Nebula (M 42)"
    + http://adsabs.harvard.edu/abs/2015A%26A...582A.114W
  + McLeod:2016a "A nebular analysis of the central Orion nebula with MUSE"
    + http://adsabs.harvard.edu/abs/2016MNRAS.455.4057M
+ Infrared imaging
  + Smith:2005a "Thermal Dust Emission from Proplyds, Unresolved Disks, and Shocks in the Orion Nebula"
    + http://adsabs.harvard.edu/abs/2005AJ....130.1763S
    + 11.7 micron emission from HH 529 I and III, and jet
+ Neutral gas
  + van-der-Werf:2013a
+ Atomic physics
  + Laha:2017a "Emission Line Ratios of FE III as Astrophysical Plasma Diagnostics"
    + http://adsabs.harvard.edu/abs/2017ApJ...841....3L




** Large-scale velocity maps
*** Combined channel maps of [O III] and [N II]
+ [[file:figs/multi-panel-isovel-oiii-nii.pdf]]
*** Velocity-colorized [O III] 5007 image
#+attr_html: :width 300
[[./figs/final502-colorized.jpg]]

*** Velocity-colorized [N II] 6583 image
#+attr_html: :width 300
[[./figs/final658-colorized.jpg]]
 

** Shock emission in HH 204

*** [O III] versus H\alpha emission
#+attr_html: :width 300
[[./figs/HH204-shock-shell_1.png]]

+ [O III] is in red
+ H\alpha is in cyan
+ You can see a very thin [O III] layer at the leading edge of the shock
+ But why is the [O III] emission not limb-brightened?


** Results from Adal's previous UVES observations of HH202-S

*** Dust destruction
Fe, Ni, Cr abundance higher by factor of about 10 in shocked gas

*** ADFs
+ Gets high ADF for C^{2+} but
  + might be fluorescence if it is from the 723X lines
    + No, seems mainly based on 4267 which should be unaffected
  + Also it is based on 3rd party [C III] NUV observations


** First look at data
#+attr_html: :width 200
[[file:figs/uves-data-description.png]]

*** HH 529 dataset


* Proper motions

** HH 529 
+ Disagreement between OH2008 and OD2015
  |            | Vt 08 | Vr\odot 08 |   |
  | HH 529-I   |    54 |    -31 |   |
  | HH 529-II  |    92 |    -31 |   |
  | HH 529-III |    40 |    -30 |   |
 
+ So recalculate the proper motions
+ 
** Relevant programs
+ Used in OD2015
  + GO 5085 - WFPC2 - O'Dell - 1995-01
  + GO 5469 - WFPC2 - Bally - 1995-03
    + Turns out I already aligned these to Robberto using Astrodrizzle
    + See [[file:~/Dropbox/OrionHST-2012/Combine/]]
    + I have done all the PC frames in F502N but only HST3 frame (PC+WFC) in F656N
    + But this is enough for HH 529
  + GO 11038 - WFPC2 - 2007-11 - Biretta
  + GO 12543 - WFC3 - 2012-01
+ Newer and unused programs
  + GO 13826 - ACS - 2015-10 - Robberto - F775W only
  + GO 13419 - WFC3 - 2015-01 - Bally
    + I already have these in [[file:~/Dropbox/OrionBally-2016/data-2016-01-11/]]
    + See also [[id:5829A70B-76BB-43E5-A057-2F691B291F7A][Proper motion of helical jet]]
  + GO 9825 - ACS - 2004-01 - Bally - Ha
    + These are longer exposures than Robberto
      + Which is good for faint stuff
      + But bad for saturated stars
      + Also, in the HH 529 field they have the spikes at an annoying angle
      + And the alignment isn't quite right either
  + GO 10246 - ACS - 2005-04 - Robberto - Ha and continuum only
+ OH2008
  + GO 10921 - WFPC2 - 2007-12 - O'Dell
  + 5193, 5469 as above
  + Also 8121, 9460 for HH 502 (way to S) and BN/KL
+ Also
  + Megeath Cycle 25 Program 15141
  + Uses a novel drift and shift technique to survey much of the Orion molecular filament at 1.6 micron
    + See Momcheva:2017a
  + Epoch 2019-05 to 2019-08
  + Might be useful, but data reduction could be difficult
** Plan of action
+ We have several options that use the same instrument:
  + GO 12543 \to 13419 is 3 years of WFC3 0.045 arcsec
  + GO 10246 \to 13826 is 10 years of ACS 0.05 arcsec, *but* F775W only
    + Try this first
  + 5085 \to 11038 is 12 years of WFPC2 0.1 arcsec
** WFPC2 1996 \to ACS 2005 \to WFC3 2015 F656N
+ This is better because no stars
+ All the files are in [[file:~/Dropbox/Orion-HH-data/ACS/]]
+ On the other hand, the filters aren't quite the same
  + But we do have the WFPC2 images from the Robberto program too
  + Although unfortunately they are not aligned very well
+ We also have both Bally and Robberto for 2005 ACS
  + But Bally needs to be shifted a little bit

*** Extract just a window of the ACS 2005 Ha+[N II] image
+ In the F775W version below, I am now taking a very large window
+ But here I want to concentrate on HH 529 for now
#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS

  datadir = Path("../Orion-HH-data/ACS")

  # Corners of window to extract from image
  xmin, xmax, ymin, ymax = 8120, 9670, 3770, 5710
  rect = slice(ymin, ymax), slice(xmin, xmax)

  # Big file from Robberto 2005 program
  hdu0 = fits.open(datadir / "hlsp_orion_hst_acs_strip0l_f658n_v1_drz.fits")["SCI"]
  # Fix stupid SIP keywords that shouldn't be there
  bad_kwds = [_ for _ in hdu0.header if _[:2] in ("A_", "B_")]
  for kwd in bad_kwds:
      hdu0.header.remove(kwd)
  # Now we are ready to create the WCS
  w = WCS(hdu0.header)

  outdir = Path("proper-motions/data")
  fits.PrimaryHDU(
      data=hdu0.data[rect],
      header=w.slice(rect).to_header(),
  ).writeto(
      outdir / "hh529_acs_f658n_2005.fits",
      overwrite=True,
  )
#+end_src

#+RESULTS:
: None

*** Reproject the 1996 and 2015 epochs onto 2005
#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS
  from reproject import reproject_interp

  datadir = Path("proper-motions/data")
  bigdatadir = Path("../Orion-HH-data/ACS")

  # Orig file from Bally 2015 program
  hdu2 = fits.open(bigdatadir / "icaz01040_drz.fits")["SCI"]
  # Use the alignment from trap-south-align-robberto.wcs
  hdu2.header["CRPIX1"] = 2060
  hdu2.header["CRPIX2"] = 2185.5
  hdu2.header["CRVAL1"] = 83.8261121432188
  hdu2.header["CRVAL2"] = -5.40646485004188

  # Cropped file from Robberto 2005 program
  hdu1, = fits.open(datadir / "hh529_acs_f658n_2005.fits")

  # Reproject 2->1
  newdata, _ = reproject_interp(hdu2, hdu1.header)
  newheader = hdu2.header.copy()
  newheader.update(WCS(hdu1.header).to_header())

  fits.PrimaryHDU(
      data=newdata,
      header=newheader,
  ).writeto(
      datadir / "hh529_wfc3_f656n_2015.fits",
      overwrite=True,
  )

  # Orig file from Bally 1996 program
  hdu3 = fits.open(bigdatadir / "F656N-HST3-align-rob_drz_sci.fits")[0]
  # Alignment tweak
  hdu3.header["CRVAL1"] += 0.05/3600
  hdu3.header["CRVAL2"] -= 0.05/3600

  # Reproject 2->1
  newdata, _ = reproject_interp(hdu3, hdu1.header)
  newheader = hdu3.header.copy()
  newheader.update(WCS(hdu1.header).to_header())

  fits.PrimaryHDU(
      data=newdata,
      header=newheader,
  ).writeto(
      datadir / "hh529_wfpc2_f656n_1996.fits",
      overwrite=True,
  )
#+end_src

#+RESULTS:
: None


*** Use FLCT to calculate proper motions 1996 \to 2005 \to 2015 
#+begin_src python :results output
  import sys
  sys.path.append("../../Source/pyflct")
  import os
  from pathlib import Path
  import numpy as np
  import pyflct
  from astropy.io import fits
  from astropy.wcs import WCS

  os.environ["PATH"] = ":".join((os.environ["PATH"], "/Users/will/.local/bin"))
  datadir = Path("proper-motions/data")

  h1, = fits.open(datadir / "hh529_wfpc2_f656n_1996.fits")
  h2, = fits.open(datadir / "hh529_acs_f658n_2005.fits")

  data_scale = h1.data.max()
  sigma = 10.0
  vx, vy, vm = pyflct.flct(h1.data.T, h2.data.T,
                           deltat=1.0, deltas=1.0, sigma=sigma,
                           thresh=0.1/data_scale,
  )
  vx[vm==0] = np.nan
  vy[vm==0] = np.nan

  fits.PrimaryHDU(
      header=h1.header,
      data=vx.T,
  ).writeto(datadir / f"hh529_f656n_1996_2005_vx_sig{int(sigma):02d}.fits", overwrite=True)

  fits.PrimaryHDU(
      header=h1.header,
      data=vy.T,
  ).writeto(datadir / f"hh529_f656n_1996_2005_vy_sig{int(sigma):02d}.fits", overwrite=True)
#+end_src

#+RESULTS:
#+begin_example
flct: Version 1.07     Copyright: 2007-2018 University of California
flct: small endian machine; i/o will be byteswapped
flct: infile = testin.dat
flct: outfile = testout.dat
flct: column major order assumed for data arrays
flct: deltat = 1
flct: deltas = 1
flct: sigma = 10
flct: threshold image value for LCT is 0
flct: threshold forced to be in abs. units
flct: bias correction not enabled
flct: complex.h is not included
flct: from input file, nx = 1550, ny = 940
flct: nominal sliding box size = 40
flct: progress  i = 0 out of 939flct: progress  i = 1 out of 939flct: progress  i = 2 out of 939flct: progress  i = 3 out of 939flct: progress  i = 4 out of 939flct: progress  i = 5 out of 939flct: progress  i = 6 out of 939flct: progress  i = 7 out of 939flct: progress  i = 8 out of 939flct: progress  i = 9 out of 939flct: progress  i = 10 out of 939flct: progress  i = 11 out of 939flct: progress  i = 12 out of 939flct: progress  i = 13 out of 939flct: progress  i = 14 out of 939flct: progress  i = 15 out of 939flct: progress  i = 16 out of 939flct: progress  i = 17 out of 939flct: progress  i = 18 out of 939flct: progress  i = 19 out of 939flct: progress  i = 20 out of 939flct: progress  i = 21 out of 939flct: progress  i = 22 out of 939flct: progress  i = 23 out of 939flct: progress  i = 24 out of 939flct: progress  i = 25 out of 939flct: progress  i = 26 out of 939flct: progress  i = 27 out of 939flct: progress  i = 28 out of 939flct: progress  i = 29 out of 939flct: progress  i = 30 out of 939flct: progress  i = 31 out of 939flct: progress  i = 32 out of 939flct: progress  i = 33 out of 939flct: progress  i = 34 out of 939flct: progress  i = 35 out of 939flct: progress  i = 36 out of 939flct: progress  i = 37 out of 939flct: progress  i = 38 out of 939flct: progress  i = 39 out of 939flct: progress  i = 40 out of 939flct: progress  i = 41 out of 939flct: progress  i = 42 out of 939flct: progress  i = 43 out of 939flct: progress  i = 44 out of 939flct: progress  i = 45 out of 939flct: progress  i = 46 out of 939flct: progress  i = 47 out of 939flct: progress  i = 48 out of 939flct: progress  i = 49 out of 939flct: progress  i = 50 out of 939flct: progress  i = 51 out of 939flct: progress  i = 52 out of 939flct: progress  i = 53 out of 939flct: progress  i = 54 out of 939flct: progress  i = 55 out of 939flct: progress  i = 56 out of 939flct: progress  i = 57 out of 939flct: progress  i = 58 out of 939flct: progress  i = 59 out of 939flct: progress  i = 60 out of 939flct: progress  i = 61 out of 939flct: progress  i = 62 out of 939flct: progress  i = 63 out of 939flct: progress  i = 64 out of 939flct: progress  i = 65 out of 939flct: progress  i = 66 out of 939flct: progress  i = 67 out of 939flct: progress  i = 68 out of 939flct: progress  i = 69 out of 939flct: progress  i = 70 out of 939flct: progress  i = 71 out of 939flct: progress  i = 72 out of 939flct: progress  i = 73 out of 939flct: progress  i = 74 out of 939flct: progress  i = 75 out of 939flct: progress  i = 76 out of 939flct: progress  i = 77 out of 939flct: progress  i = 78 out of 939flct: progress  i = 79 out of 939flct: progress  i = 80 out of 939flct: progress  i = 81 out of 939flct: progress  i = 82 out of 939flct: progress  i = 83 out of 939flct: progress  i = 84 out of 939flct: progress  i = 85 out of 939flct: progress  i = 86 out of 939flct: progress  i = 87 out of 939flct: progress  i = 88 out of 939flct: progress  i = 89 out of 939flct: progress  i = 90 out of 939flct: progress  i = 91 out of 939flct: progress  i = 92 out of 939flct: progress  i = 93 out of 939flct: progress  i = 94 out of 939flct: progress  i = 95 out of 939flct: progress  i = 96 out of 939flct: progress  i = 97 out of 939flct: progress  i = 98 out of 939flct: progress  i = 99 out of 939flct: progress  i = 100 out of 939flct: progress  i = 101 out of 939flct: progress  i = 102 out of 939flct: progress  i = 103 out of 939flct: progress  i = 104 out of 939flct: progress  i = 105 out of 939flct: progress  i = 106 out of 939flct: progress  i = 107 out of 939flct: progress  i = 108 out of 939flct: progress  i = 109 out of 939flct: progress  i = 110 out of 939flct: progress  i = 111 out of 939flct: progress  i = 112 out of 939flct: progress  i = 113 out of 939flct: progress  i = 114 out of 939flct: progress  i = 115 out of 939flct: progress  i = 116 out of 939flct: progress  i = 117 out of 939flct: progress  i = 118 out of 939flct: progress  i = 119 out of 939flct: progress  i = 120 out of 939flct: progress  i = 121 out of 939flct: progress  i = 122 out of 939flct: progress  i = 123 out of 939flct: progress  i = 124 out of 939flct: progress  i = 125 out of 939flct: progress  i = 126 out of 939flct: progress  i = 127 out of 939flct: progress  i = 128 out of 939flct: progress  i = 129 out of 939flct: progress  i = 130 out of 939flct: progress  i = 131 out of 939flct: progress  i = 132 out of 939flct: progress  i = 133 out of 939flct: progress  i = 134 out of 939flct: progress  i = 135 out of 939flct: progress  i = 136 out of 939flct: progress  i = 137 out of 939flct: progress  i = 138 out of 939flct: progress  i = 139 out of 939flct: progress  i = 140 out of 939flct: progress  i = 141 out of 939flct: progress  i = 142 out of 939flct: progress  i = 143 out of 939flct: progress  i = 144 out of 939flct: progress  i = 145 out of 939flct: progress  i = 146 out of 939flct: progress  i = 147 out of 939flct: progress  i = 148 out of 939flct: progress  i = 149 out of 939flct: progress  i = 150 out of 939flct: progress  i = 151 out of 939flct: progress  i = 152 out of 939flct: progress  i = 153 out of 939flct: progress  i = 154 out of 939flct: progress  i = 155 out of 939flct: progress  i = 156 out of 939flct: progress  i = 157 out of 939flct: progress  i = 158 out of 939flct: progress  i = 159 out of 939flct: progress  i = 160 out of 939flct: progress  i = 161 out of 939flct: progress  i = 162 out of 939flct: progress  i = 163 out of 939flct: progress  i = 164 out of 939flct: progress  i = 165 out of 939flct: progress  i = 166 out of 939flct: progress  i = 167 out of 939flct: progress  i = 168 out of 939flct: progress  i = 169 out of 939flct: progress  i = 170 out of 939flct: progress  i = 171 out of 939flct: progress  i = 172 out of 939flct: progress  i = 173 out of 939flct: progress  i = 174 out of 939flct: progress  i = 175 out of 939flct: progress  i = 176 out of 939flct: progress  i = 177 out of 939flct: progress  i = 178 out of 939flct: progress  i = 179 out of 939flct: progress  i = 180 out of 939flct: progress  i = 181 out of 939flct: progress  i = 182 out of 939flct: progress  i = 183 out of 939flct: progress  i = 184 out of 939flct: progress  i = 185 out of 939flct: progress  i = 186 out of 939flct: progress  i = 187 out of 939flct: progress  i = 188 out of 939flct: progress  i = 189 out of 939flct: progress  i = 190 out of 939flct: progress  i = 191 out of 939flct: progress  i = 192 out of 939flct: progress  i = 193 out of 939flct: progress  i = 194 out of 939flct: progress  i = 195 out of 939flct: progress  i = 196 out of 939flct: progress  i = 197 out of 939flct: progress  i = 198 out of 939flct: progress  i = 199 out of 939flct: progress  i = 200 out of 939flct: progress  i = 201 out of 939flct: progress  i = 202 out of 939flct: progress  i = 203 out of 939flct: progress  i = 204 out of 939flct: progress  i = 205 out of 939flct: progress  i = 206 out of 939flct: progress  i = 207 out of 939flct: progress  i = 208 out of 939flct: progress  i = 209 out of 939flct: progress  i = 210 out of 939flct: progress  i = 211 out of 939flct: progress  i = 212 out of 939flct: progress  i = 213 out of 939flct: progress  i = 214 out of 939flct: progress  i = 215 out of 939flct: progress  i = 216 out of 939flct: progress  i = 217 out of 939flct: progress  i = 218 out of 939flct: progress  i = 219 out of 939flct: progress  i = 220 out of 939flct: progress  i = 221 out of 939flct: progress  i = 222 out of 939flct: progress  i = 223 out of 939flct: progress  i = 224 out of 939flct: progress  i = 225 out of 939flct: progress  i = 226 out of 939flct: progress  i = 227 out of 939flct: progress  i = 228 out of 939flct: progress  i = 229 out of 939flct: progress  i = 230 out of 939flct: progress  i = 231 out of 939flct: progress  i = 232 out of 939flct: progress  i = 233 out of 939flct: progress  i = 234 out of 939flct: progress  i = 235 out of 939flct: progress  i = 236 out of 939flct: progress  i = 237 out of 939flct: progress  i = 238 out of 939flct: progress  i = 239 out of 939flct: progress  i = 240 out of 939flct: progress  i = 241 out of 939flct: progress  i = 242 out of 939flct: progress  i = 243 out of 939flct: progress  i = 244 out of 939flct: progress  i = 245 out of 939flct: progress  i = 246 out of 939flct: progress  i = 247 out of 939flct: progress  i = 248 out of 939flct: progress  i = 249 out of 939flct: progress  i = 250 out of 939flct: progress  i = 251 out of 939flct: progress  i = 252 out of 939flct: progress  i = 253 out of 939flct: progress  i = 254 out of 939flct: progress  i = 255 out of 939flct: progress  i = 256 out of 939flct: progress  i = 257 out of 939flct: progress  i = 258 out of 939flct: progress  i = 259 out of 939flct: progress  i = 260 out of 939flct: progress  i = 261 out of 939flct: progress  i = 262 out of 939flct: progress  i = 263 out of 939flct: progress  i = 264 out of 939flct: progress  i = 265 out of 939flct: progress  i = 266 out of 939flct: progress  i = 267 out of 939flct: progress  i = 268 out of 939flct: progress  i = 269 out of 939flct: progress  i = 270 out of 939flct: progress  i = 271 out of 939flct: progress  i = 272 out of 939flct: progress  i = 273 out of 939flct: progress  i = 274 out of 939flct: progress  i = 275 out of 939flct: progress  i = 276 out of 939flct: progress  i = 277 out of 939flct: progress  i = 278 out of 939flct: progress  i = 279 out of 939flct: progress  i = 280 out of 939flct: progress  i = 281 out of 939flct: progress  i = 282 out of 939flct: progress  i = 283 out of 939flct: progress  i = 284 out of 939flct: progress  i = 285 out of 939flct: progress  i = 286 out of 939flct: progress  i = 287 out of 939flct: progress  i = 288 out of 939flct: progress  i = 289 out of 939flct: progress  i = 290 out of 939flct: progress  i = 291 out of 939flct: progress  i = 292 out of 939flct: progress  i = 293 out of 939flct: progress  i = 294 out of 939flct: progress  i = 295 out of 939flct: progress  i = 296 out of 939flct: progress  i = 297 out of 939flct: progress  i = 298 out of 939flct: progress  i = 299 out of 939flct: progress  i = 300 out of 939flct: progress  i = 301 out of 939flct: progress  i = 302 out of 939flct: progress  i = 303 out of 939flct: progress  i = 304 out of 939flct: progress  i = 305 out of 939flct: progress  i = 306 out of 939flct: progress  i = 307 out of 939flct: progress  i = 308 out of 939flct: progress  i = 309 out of 939flct: progress  i = 310 out of 939flct: progress  i = 311 out of 939flct: progress  i = 312 out of 939flct: progress  i = 313 out of 939flct: progress  i = 314 out of 939flct: progress  i = 315 out of 939flct: progress  i = 316 out of 939flct: progress  i = 317 out of 939flct: progress  i = 318 out of 939flct: progress  i = 319 out of 939flct: progress  i = 320 out of 939flct: progress  i = 321 out of 939flct: progress  i = 322 out of 939flct: progress  i = 323 out of 939flct: progress  i = 324 out of 939flct: progress  i = 325 out of 939flct: progress  i = 326 out of 939flct: progress  i = 327 out of 939flct: progress  i = 328 out of 939flct: progress  i = 329 out of 939flct: progress  i = 330 out of 939flct: progress  i = 331 out of 939flct: progress  i = 332 out of 939flct: progress  i = 333 out of 939flct: progress  i = 334 out of 939flct: progress  i = 335 out of 939flct: progress  i = 336 out of 939flct: progress  i = 337 out of 939flct: progress  i = 338 out of 939flct: progress  i = 339 out of 939flct: progress  i = 340 out of 939flct: progress  i = 341 out of 939flct: progress  i = 342 out of 939flct: progress  i = 343 out of 939flct: progress  i = 344 out of 939flct: progress  i = 345 out of 939flct: progress  i = 346 out of 939flct: progress  i = 347 out of 939flct: progress  i = 348 out of 939flct: progress  i = 349 out of 939flct: progress  i = 350 out of 939flct: progress  i = 351 out of 939flct: progress  i = 352 out of 939flct: progress  i = 353 out of 939flct: progress  i = 354 out of 939flct: progress  i = 355 out of 939flct: progress  i = 356 out of 939flct: progress  i = 357 out of 939flct: progress  i = 358 out of 939flct: progress  i = 359 out of 939flct: progress  i = 360 out of 939flct: progress  i = 361 out of 939flct: progress  i = 362 out of 939flct: progress  i = 363 out of 939flct: progress  i = 364 out of 939flct: progress  i = 365 out of 939flct: progress  i = 366 out of 939flct: progress  i = 367 out of 939flct: progress  i = 368 out of 939flct: progress  i = 369 out of 939flct: progress  i = 370 out of 939flct: progress  i = 371 out of 939flct: progress  i = 372 out of 939flct: progress  i = 373 out of 939flct: progress  i = 374 out of 939flct: progress  i = 375 out of 939flct: progress  i = 376 out of 939flct: progress  i = 377 out of 939flct: progress  i = 378 out of 939flct: progress  i = 379 out of 939flct: progress  i = 380 out of 939flct: progress  i = 381 out of 939flct: progress  i = 382 out of 939flct: progress  i = 383 out of 939flct: progress  i = 384 out of 939flct: progress  i = 385 out of 939flct: progress  i = 386 out of 939flct: progress  i = 387 out of 939flct: progress  i = 388 out of 939flct: progress  i = 389 out of 939flct: progress  i = 390 out of 939flct: progress  i = 391 out of 939flct: progress  i = 392 out of 939flct: progress  i = 393 out of 939flct: progress  i = 394 out of 939flct: progress  i = 395 out of 939flct: progress  i = 396 out of 939flct: progress  i = 397 out of 939flct: progress  i = 398 out of 939flct: progress  i = 399 out of 939flct: progress  i = 400 out of 939flct: progress  i = 401 out of 939flct: progress  i = 402 out of 939flct: progress  i = 403 out of 939flct: progress  i = 404 out of 939flct: progress  i = 405 out of 939flct: progress  i = 406 out of 939flct: progress  i = 407 out of 939flct: progress  i = 408 out of 939flct: progress  i = 409 out of 939flct: progress  i = 410 out of 939flct: progress  i = 411 out of 939flct: progress  i = 412 out of 939flct: progress  i = 413 out of 939flct: progress  i = 414 out of 939flct: progress  i = 415 out of 939flct: progress  i = 416 out of 939flct: progress  i = 417 out of 939flct: progress  i = 418 out of 939flct: progress  i = 419 out of 939flct: progress  i = 420 out of 939flct: progress  i = 421 out of 939flct: progress  i = 422 out of 939flct: progress  i = 423 out of 939flct: progress  i = 424 out of 939flct: progress  i = 425 out of 939flct: progress  i = 426 out of 939flct: progress  i = 427 out of 939flct: progress  i = 428 out of 939flct: progress  i = 429 out of 939flct: progress  i = 430 out of 939flct: progress  i = 431 out of 939flct: progress  i = 432 out of 939flct: progress  i = 433 out of 939flct: progress  i = 434 out of 939flct: progress  i = 435 out of 939flct: progress  i = 436 out of 939flct: progress  i = 437 out of 939flct: progress  i = 438 out of 939flct: progress  i = 439 out of 939flct: progress  i = 440 out of 939flct: progress  i = 441 out of 939flct: progress  i = 442 out of 939flct: progress  i = 443 out of 939flct: progress  i = 444 out of 939flct: progress  i = 445 out of 939flct: progress  i = 446 out of 939flct: progress  i = 447 out of 939flct: progress  i = 448 out of 939flct: progress  i = 449 out of 939flct: progress  i = 450 out of 939flct: progress  i = 451 out of 939flct: progress  i = 452 out of 939flct: progress  i = 453 out of 939flct: progress  i = 454 out of 939flct: progress  i = 455 out of 939flct: progress  i = 456 out of 939flct: progress  i = 457 out of 939flct: progress  i = 458 out of 939flct: progress  i = 459 out of 939flct: progress  i = 460 out of 939flct: progress  i = 461 out of 939flct: progress  i = 462 out of 939flct: progress  i = 463 out of 939flct: progress  i = 464 out of 939flct: progress  i = 465 out of 939flct: progress  i = 466 out of 939flct: progress  i = 467 out of 939flct: progress  i = 468 out of 939flct: progress  i = 469 out of 939flct: progress  i = 470 out of 939flct: progress  i = 471 out of 939flct: progress  i = 472 out of 939flct: progress  i = 473 out of 939flct: progress  i = 474 out of 939flct: progress  i = 475 out of 939flct: progress  i = 476 out of 939flct: progress  i = 477 out of 939flct: progress  i = 478 out of 939flct: progress  i = 479 out of 939flct: progress  i = 480 out of 939flct: progress  i = 481 out of 939flct: progress  i = 482 out of 939flct: progress  i = 483 out of 939flct: progress  i = 484 out of 939flct: progress  i = 485 out of 939flct: progress  i = 486 out of 939flct: progress  i = 487 out of 939flct: progress  i = 488 out of 939flct: progress  i = 489 out of 939flct: progress  i = 490 out of 939flct: progress  i = 491 out of 939flct: progress  i = 492 out of 939flct: progress  i = 493 out of 939flct: progress  i = 494 out of 939flct: progress  i = 495 out of 939flct: progress  i = 496 out of 939flct: progress  i = 497 out of 939flct: progress  i = 498 out of 939flct: progress  i = 499 out of 939flct: progress  i = 500 out of 939flct: progress  i = 501 out of 939flct: progress  i = 502 out of 939flct: progress  i = 503 out of 939flct: progress  i = 504 out of 939flct: progress  i = 505 out of 939flct: progress  i = 506 out of 939flct: progress  i = 507 out of 939flct: progress  i = 508 out of 939flct: progress  i = 509 out of 939flct: progress  i = 510 out of 939flct: progress  i = 511 out of 939flct: progress  i = 512 out of 939flct: progress  i = 513 out of 939flct: progress  i = 514 out of 939flct: progress  i = 515 out of 939flct: progress  i = 516 out of 939flct: progress  i = 517 out of 939flct: progress  i = 518 out of 939flct: progress  i = 519 out of 939flct: progress  i = 520 out of 939flct: progress  i = 521 out of 939flct: progress  i = 522 out of 939flct: progress  i = 523 out of 939flct: progress  i = 524 out of 939flct: progress  i = 525 out of 939flct: progress  i = 526 out of 939flct: progress  i = 527 out of 939flct: progress  i = 528 out of 939flct: progress  i = 529 out of 939flct: progress  i = 530 out of 939flct: progress  i = 531 out of 939flct: progress  i = 532 out of 939flct: progress  i = 533 out of 939flct: progress  i = 534 out of 939flct: progress  i = 535 out of 939flct: progress  i = 536 out of 939flct: progress  i = 537 out of 939flct: progress  i = 538 out of 939flct: progress  i = 539 out of 939flct: progress  i = 540 out of 939flct: progress  i = 541 out of 939flct: progress  i = 542 out of 939flct: progress  i = 543 out of 939flct: progress  i = 544 out of 939flct: progress  i = 545 out of 939flct: progress  i = 546 out of 939flct: progress  i = 547 out of 939flct: progress  i = 548 out of 939flct: progress  i = 549 out of 939flct: progress  i = 550 out of 939flct: progress  i = 551 out of 939flct: progress  i = 552 out of 939flct: progress  i = 553 out of 939flct: progress  i = 554 out of 939flct: progress  i = 555 out of 939flct: progress  i = 556 out of 939flct: progress  i = 557 out of 939flct: progress  i = 558 out of 939flct: progress  i = 559 out of 939flct: progress  i = 560 out of 939flct: progress  i = 561 out of 939flct: progress  i = 562 out of 939flct: progress  i = 563 out of 939flct: progress  i = 564 out of 939flct: progress  i = 565 out of 939flct: progress  i = 566 out of 939flct: progress  i = 567 out of 939flct: progress  i = 568 out of 939flct: progress  i = 569 out of 939flct: progress  i = 570 out of 939flct: progress  i = 571 out of 939flct: progress  i = 572 out of 939flct: progress  i = 573 out of 939flct: progress  i = 574 out of 939flct: progress  i = 575 out of 939flct: progress  i = 576 out of 939flct: progress  i = 577 out of 939flct: progress  i = 578 out of 939flct: progress  i = 579 out of 939flct: progress  i = 580 out of 939flct: progress  i = 581 out of 939flct: progress  i = 582 out of 939flct: progress  i = 583 out of 939flct: progress  i = 584 out of 939flct: progress  i = 585 out of 939flct: progress  i = 586 out of 939flct: progress  i = 587 out of 939flct: progress  i = 588 out of 939flct: progress  i = 589 out of 939flct: progress  i = 590 out of 939flct: progress  i = 591 out of 939flct: progress  i = 592 out of 939flct: progress  i = 593 out of 939flct: progress  i = 594 out of 939flct: progress  i = 595 out of 939flct: progress  i = 596 out of 939flct: progress  i = 597 out of 939flct: progress  i = 598 out of 939flct: progress  i = 599 out of 939flct: progress  i = 600 out of 939flct: progress  i = 601 out of 939flct: progress  i = 602 out of 939flct: progress  i = 603 out of 939flct: progress  i = 604 out of 939flct: progress  i = 605 out of 939flct: progress  i = 606 out of 939flct: progress  i = 607 out of 939flct: progress  i = 608 out of 939flct: progress  i = 609 out of 939flct: progress  i = 610 out of 939flct: progress  i = 611 out of 939flct: progress  i = 612 out of 939flct: progress  i = 613 out of 939flct: progress  i = 614 out of 939flct: progress  i = 615 out of 939flct: progress  i = 616 out of 939flct: progress  i = 617 out of 939flct: progress  i = 618 out of 939flct: progress  i = 619 out of 939flct: progress  i = 620 out of 939flct: progress  i = 621 out of 939flct: progress  i = 622 out of 939flct: progress  i = 623 out of 939flct: progress  i = 624 out of 939flct: progress  i = 625 out of 939flct: progress  i = 626 out of 939flct: progress  i = 627 out of 939flct: progress  i = 628 out of 939flct: progress  i = 629 out of 939flct: progress  i = 630 out of 939flct: progress  i = 631 out of 939flct: progress  i = 632 out of 939flct: progress  i = 633 out of 939flct: progress  i = 634 out of 939flct: progress  i = 635 out of 939flct: progress  i = 636 out of 939flct: progress  i = 637 out of 939flct: progress  i = 638 out of 939flct: progress  i = 639 out of 939flct: progress  i = 640 out of 939flct: progress  i = 641 out of 939flct: progress  i = 642 out of 939flct: progress  i = 643 out of 939flct: progress  i = 644 out of 939flct: progress  i = 645 out of 939flct: progress  i = 646 out of 939flct: progress  i = 647 out of 939flct: progress  i = 648 out of 939flct: progress  i = 649 out of 939flct: progress  i = 650 out of 939flct: progress  i = 651 out of 939flct: progress  i = 652 out of 939flct: progress  i = 653 out of 939flct: progress  i = 654 out of 939flct: progress  i = 655 out of 939flct: progress  i = 656 out of 939flct: progress  i = 657 out of 939flct: progress  i = 658 out of 939flct: progress  i = 659 out of 939flct: progress  i = 660 out of 939flct: progress  i = 661 out of 939flct: progress  i = 662 out of 939flct: progress  i = 663 out of 939flct: progress  i = 664 out of 939flct: progress  i = 665 out of 939flct: progress  i = 666 out of 939flct: progress  i = 667 out of 939flct: progress  i = 668 out of 939flct: progress  i = 669 out of 939flct: progress  i = 670 out of 939flct: progress  i = 671 out of 939flct: progress  i = 672 out of 939flct: progress  i = 673 out of 939flct: progress  i = 674 out of 939flct: progress  i = 675 out of 939flct: progress  i = 676 out of 939flct: progress  i = 677 out of 939flct: progress  i = 678 out of 939flct: progress  i = 679 out of 939flct: progress  i = 680 out of 939flct: progress  i = 681 out of 939flct: progress  i = 682 out of 939flct: progress  i = 683 out of 939flct: progress  i = 684 out of 939flct: progress  i = 685 out of 939flct: progress  i = 686 out of 939flct: progress  i = 687 out of 939flct: progress  i = 688 out of 939flct: progress  i = 689 out of 939flct: progress  i = 690 out of 939flct: progress  i = 691 out of 939flct: progress  i = 692 out of 939flct: progress  i = 693 out of 939flct: progress  i = 694 out of 939flct: progress  i = 695 out of 939flct: progress  i = 696 out of 939flct: progress  i = 697 out of 939flct: progress  i = 698 out of 939flct: progress  i = 699 out of 939flct: progress  i = 700 out of 939flct: progress  i = 701 out of 939flct: progress  i = 702 out of 939flct: progress  i = 703 out of 939flct: progress  i = 704 out of 939flct: progress  i = 705 out of 939flct: progress  i = 706 out of 939flct: progress  i = 707 out of 939flct: progress  i = 708 out of 939flct: progress  i = 709 out of 939flct: progress  i = 710 out of 939flct: progress  i = 711 out of 939flct: progress  i = 712 out of 939flct: progress  i = 713 out of 939flct: progress  i = 714 out of 939flct: progress  i = 715 out of 939flct: progress  i = 716 out of 939flct: progress  i = 717 out of 939flct: progress  i = 718 out of 939flct: progress  i = 719 out of 939flct: progress  i = 720 out of 939flct: progress  i = 721 out of 939flct: progress  i = 722 out of 939flct: progress  i = 723 out of 939flct: progress  i = 724 out of 939flct: progress  i = 725 out of 939flct: progress  i = 726 out of 939flct: progress  i = 727 out of 939flct: progress  i = 728 out of 939flct: progress  i = 729 out of 939flct: progress  i = 730 out of 939flct: progress  i = 731 out of 939flct: progress  i = 732 out of 939flct: progress  i = 733 out of 939flct: progress  i = 734 out of 939flct: progress  i = 735 out of 939flct: progress  i = 736 out of 939flct: progress  i = 737 out of 939flct: progress  i = 738 out of 939flct: progress  i = 739 out of 939flct: progress  i = 740 out of 939flct: progress  i = 741 out of 939flct: progress  i = 742 out of 939flct: progress  i = 743 out of 939flct: progress  i = 744 out of 939flct: progress  i = 745 out of 939flct: progress  i = 746 out of 939flct: progress  i = 747 out of 939flct: progress  i = 748 out of 939flct: progress  i = 749 out of 939flct: progress  i = 750 out of 939flct: progress  i = 751 out of 939flct: progress  i = 752 out of 939flct: progress  i = 753 out of 939flct: progress  i = 754 out of 939flct: progress  i = 755 out of 939flct: progress  i = 756 out of 939flct: progress  i = 757 out of 939flct: progress  i = 758 out of 939flct: progress  i = 759 out of 939flct: progress  i = 760 out of 939flct: progress  i = 761 out of 939flct: progress  i = 762 out of 939flct: progress  i = 763 out of 939flct: progress  i = 764 out of 939flct: progress  i = 765 out of 939flct: progress  i = 766 out of 939flct: progress  i = 767 out of 939flct: progress  i = 768 out of 939flct: progress  i = 769 out of 939flct: progress  i = 770 out of 939flct: progress  i = 771 out of 939flct: progress  i = 772 out of 939flct: progress  i = 773 out of 939flct: progress  i = 774 out of 939flct: progress  i = 775 out of 939flct: progress  i = 776 out of 939flct: progress  i = 777 out of 939flct: progress  i = 778 out of 939flct: progress  i = 779 out of 939flct: progress  i = 780 out of 939flct: progress  i = 781 out of 939flct: progress  i = 782 out of 939flct: progress  i = 783 out of 939flct: progress  i = 784 out of 939flct: progress  i = 785 out of 939flct: progress  i = 786 out of 939flct: progress  i = 787 out of 939flct: progress  i = 788 out of 939flct: progress  i = 789 out of 939flct: progress  i = 790 out of 939flct: progress  i = 791 out of 939flct: progress  i = 792 out of 939flct: progress  i = 793 out of 939flct: progress  i = 794 out of 939flct: progress  i = 795 out of 939flct: progress  i = 796 out of 939flct: progress  i = 797 out of 939flct: progress  i = 798 out of 939flct: progress  i = 799 out of 939flct: progress  i = 800 out of 939flct: progress  i = 801 out of 939flct: progress  i = 802 out of 939flct: progress  i = 803 out of 939flct: progress  i = 804 out of 939flct: progress  i = 805 out of 939flct: progress  i = 806 out of 939flct: progress  i = 807 out of 939flct: progress  i = 808 out of 939flct: progress  i = 809 out of 939flct: progress  i = 810 out of 939flct: progress  i = 811 out of 939flct: progress  i = 812 out of 939flct: progress  i = 813 out of 939flct: progress  i = 814 out of 939flct: progress  i = 815 out of 939flct: progress  i = 816 out of 939flct: progress  i = 817 out of 939flct: progress  i = 818 out of 939flct: progress  i = 819 out of 939flct: progress  i = 820 out of 939flct: progress  i = 821 out of 939flct: progress  i = 822 out of 939flct: progress  i = 823 out of 939flct: progress  i = 824 out of 939flct: progress  i = 825 out of 939flct: progress  i = 826 out of 939flct: progress  i = 827 out of 939flct: progress  i = 828 out of 939flct: progress  i = 829 out of 939flct: progress  i = 830 out of 939flct: progress  i = 831 out of 939flct: progress  i = 832 out of 939flct: progress  i = 833 out of 939flct: progress  i = 834 out of 939flct: progress  i = 835 out of 939flct: progress  i = 836 out of 939flct: progress  i = 837 out of 939flct: progress  i = 838 out of 939flct: progress  i = 839 out of 939flct: progress  i = 840 out of 939flct: progress  i = 841 out of 939flct: progress  i = 842 out of 939flct: progress  i = 843 out of 939flct: progress  i = 844 out of 939flct: progress  i = 845 out of 939flct: progress  i = 846 out of 939flct: progress  i = 847 out of 939flct: progress  i = 848 out of 939flct: progress  i = 849 out of 939flct: progress  i = 850 out of 939flct: progress  i = 851 out of 939flct: progress  i = 852 out of 939flct: progress  i = 853 out of 939flct: progress  i = 854 out of 939flct: progress  i = 855 out of 939flct: progress  i = 856 out of 939flct: progress  i = 857 out of 939flct: progress  i = 858 out of 939flct: progress  i = 859 out of 939flct: progress  i = 860 out of 939flct: progress  i = 861 out of 939flct: progress  i = 862 out of 939flct: progress  i = 863 out of 939flct: progress  i = 864 out of 939flct: progress  i = 865 out of 939flct: progress  i = 866 out of 939flct: progress  i = 867 out of 939flct: progress  i = 868 out of 939flct: progress  i = 869 out of 939flct: progress  i = 870 out of 939flct: progress  i = 871 out of 939flct: progress  i = 872 out of 939flct: progress  i = 873 out of 939flct: progress  i = 874 out of 939flct: progress  i = 875 out of 939flct: progress  i = 876 out of 939flct: progress  i = 877 out of 939flct: progress  i = 878 out of 939flct: progress  i = 879 out of 939flct: progress  i = 880 out of 939flct: progress  i = 881 out of 939flct: progress  i = 882 out of 939flct: progress  i = 883 out of 939flct: progress  i = 884 out of 939flct: progress  i = 885 out of 939flct: progress  i = 886 out of 939flct: progress  i = 887 out of 939flct: progress  i = 888 out of 939flct: progress  i = 889 out of 939flct: progress  i = 890 out of 939flct: progress  i = 891 out of 939flct: progress  i = 892 out of 939flct: progress  i = 893 out of 939flct: progress  i = 894 out of 939flct: progress  i = 895 out of 939flct: progress  i = 896 out of 939flct: progress  i = 897 out of 939flct: progress  i = 898 out of 939flct: progress  i = 899 out of 939flct: progress  i = 900 out of 939flct: progress  i = 901 out of 939flct: progress  i = 902 out of 939flct: progress  i = 903 out of 939flct: progress  i = 904 out of 939flct: progress  i = 905 out of 939flct: progress  i = 906 out of 939flct: progress  i = 907 out of 939flct: progress  i = 908 out of 939flct: progress  i = 909 out of 939flct: progress  i = 910 out of 939flct: progress  i = 911 out of 939flct: progress  i = 912 out of 939flct: progress  i = 913 out of 939flct: progress  i = 914 out of 939flct: progress  i = 915 out of 939flct: progress  i = 916 out of 939flct: progress  i = 917 out of 939flct: progress  i = 918 out of 939flct: progress  i = 919 out of 939flct: progress  i = 920 out of 939flct: progress  i = 921 out of 939flct: progress  i = 922 out of 939flct: progress  i = 923 out of 939flct: progress  i = 924 out of 939flct: progress  i = 925 out of 939flct: progress  i = 926 out of 939flct: progress  i = 927 out of 939flct: progress  i = 928 out of 939flct: progress  i = 929 out of 939flct: progress  i = 930 out of 939flct: progress  i = 931 out of 939flct: progress  i = 932 out of 939flct: progress  i = 933 out of 939flct: progress  i = 934 out of 939flct: progress  i = 935 out of 939flct: progress  i = 936 out of 939flct: progress  i = 937 out of 939flct: progress  i = 938 out of 939flct: progress  i = 939 out of 939flct: mean value of gamma^2/sigma^2 = 0.284761

flct: finished
#+end_example

#+begin_src python :results output
  import sys
  sys.path.append("../../Source/pyflct")
  import os
  from pathlib import Path
  import numpy as np
  import pyflct
  from astropy.io import fits
  from astropy.wcs import WCS

  os.environ["PATH"] = ":".join((os.environ["PATH"], "/Users/will/.local/bin"))
  datadir = Path("proper-motions/data")

  h1, = fits.open(datadir / "hh529_acs_f658n_2005.fits")
  h2, = fits.open(datadir / "hh529_wfc3_f656n_2015.fits")

  data_scale = h2.data.max()
  sigma = 10.0
  vx, vy, vm = pyflct.flct(h1.data.T, h2.data.T,
                           deltat=1.0, deltas=1.0, sigma=sigma,
                           thresh=0.1/data_scale,
  )
  vx[vm==0] = np.nan
  vy[vm==0] = np.nan

  fits.PrimaryHDU(
      header=h1.header,
      data=vx.T,
  ).writeto(datadir / f"hh529_f656n_2005_2015_vx_sig{int(sigma):02d}.fits", overwrite=True)

  fits.PrimaryHDU(
      header=h1.header,
      data=vy.T,
  ).writeto(datadir / f"hh529_f656n_2005_2015_vy_sig{int(sigma):02d}.fits", overwrite=True)
#+end_src

#+RESULTS:
#+begin_example
flct: Version 1.07     Copyright: 2007-2018 University of California
flct: small endian machine; i/o will be byteswapped
flct: infile = testin.dat
flct: outfile = testout.dat
flct: column major order assumed for data arrays
flct: deltat = 1
flct: deltas = 1
flct: sigma = 10
flct: threshold image value for LCT is 0
flct: bias correction not enabled
flct: complex.h is not included
flct: from input file, nx = 1550, ny = 940
flct: nominal sliding box size = 40
flct: progress  i = 0 out of 939flct: progress  i = 1 out of 939flct: progress  i = 2 out of 939flct: progress  i = 3 out of 939flct: progress  i = 4 out of 939flct: progress  i = 5 out of 939flct: progress  i = 6 out of 939flct: progress  i = 7 out of 939flct: progress  i = 8 out of 939flct: progress  i = 9 out of 939flct: progress  i = 10 out of 939flct: progress  i = 11 out of 939flct: progress  i = 12 out of 939flct: progress  i = 13 out of 939flct: progress  i = 14 out of 939flct: progress  i = 15 out of 939flct: progress  i = 16 out of 939flct: progress  i = 17 out of 939flct: progress  i = 18 out of 939flct: progress  i = 19 out of 939flct: progress  i = 20 out of 939flct: progress  i = 21 out of 939flct: progress  i = 22 out of 939flct: progress  i = 23 out of 939flct: progress  i = 24 out of 939flct: progress  i = 25 out of 939flct: progress  i = 26 out of 939flct: progress  i = 27 out of 939flct: progress  i = 28 out of 939flct: progress  i = 29 out of 939flct: progress  i = 30 out of 939flct: progress  i = 31 out of 939flct: progress  i = 32 out of 939flct: progress  i = 33 out of 939flct: progress  i = 34 out of 939flct: progress  i = 35 out of 939flct: progress  i = 36 out of 939flct: progress  i = 37 out of 939flct: progress  i = 38 out of 939flct: progress  i = 39 out of 939flct: progress  i = 40 out of 939flct: progress  i = 41 out of 939flct: progress  i = 42 out of 939flct: progress  i = 43 out of 939flct: progress  i = 44 out of 939flct: progress  i = 45 out of 939flct: progress  i = 46 out of 939flct: progress  i = 47 out of 939flct: progress  i = 48 out of 939flct: progress  i = 49 out of 939flct: progress  i = 50 out of 939flct: progress  i = 51 out of 939flct: progress  i = 52 out of 939flct: progress  i = 53 out of 939flct: progress  i = 54 out of 939flct: progress  i = 55 out of 939flct: progress  i = 56 out of 939flct: progress  i = 57 out of 939flct: progress  i = 58 out of 939flct: progress  i = 59 out of 939flct: progress  i = 60 out of 939flct: progress  i = 61 out of 939flct: progress  i = 62 out of 939flct: progress  i = 63 out of 939flct: progress  i = 64 out of 939flct: progress  i = 65 out of 939flct: progress  i = 66 out of 939flct: progress  i = 67 out of 939flct: progress  i = 68 out of 939flct: progress  i = 69 out of 939flct: progress  i = 70 out of 939flct: progress  i = 71 out of 939flct: progress  i = 72 out of 939flct: progress  i = 73 out of 939flct: progress  i = 74 out of 939flct: progress  i = 75 out of 939flct: progress  i = 76 out of 939flct: progress  i = 77 out of 939flct: progress  i = 78 out of 939flct: progress  i = 79 out of 939flct: progress  i = 80 out of 939flct: progress  i = 81 out of 939flct: progress  i = 82 out of 939flct: progress  i = 83 out of 939flct: progress  i = 84 out of 939flct: progress  i = 85 out of 939flct: progress  i = 86 out of 939flct: progress  i = 87 out of 939flct: progress  i = 88 out of 939flct: progress  i = 89 out of 939flct: progress  i = 90 out of 939flct: progress  i = 91 out of 939flct: progress  i = 92 out of 939flct: progress  i = 93 out of 939flct: progress  i = 94 out of 939flct: progress  i = 95 out of 939flct: progress  i = 96 out of 939flct: progress  i = 97 out of 939flct: progress  i = 98 out of 939flct: progress  i = 99 out of 939flct: progress  i = 100 out of 939flct: progress  i = 101 out of 939flct: progress  i = 102 out of 939flct: progress  i = 103 out of 939flct: progress  i = 104 out of 939flct: progress  i = 105 out of 939flct: progress  i = 106 out of 939flct: progress  i = 107 out of 939flct: progress  i = 108 out of 939flct: progress  i = 109 out of 939flct: progress  i = 110 out of 939flct: progress  i = 111 out of 939flct: progress  i = 112 out of 939flct: progress  i = 113 out of 939flct: progress  i = 114 out of 939flct: progress  i = 115 out of 939flct: progress  i = 116 out of 939flct: progress  i = 117 out of 939flct: progress  i = 118 out of 939flct: progress  i = 119 out of 939flct: progress  i = 120 out of 939flct: progress  i = 121 out of 939flct: progress  i = 122 out of 939flct: progress  i = 123 out of 939flct: progress  i = 124 out of 939flct: progress  i = 125 out of 939flct: progress  i = 126 out of 939flct: progress  i = 127 out of 939flct: progress  i = 128 out of 939flct: progress  i = 129 out of 939flct: progress  i = 130 out of 939flct: progress  i = 131 out of 939flct: progress  i = 132 out of 939flct: progress  i = 133 out of 939flct: progress  i = 134 out of 939flct: progress  i = 135 out of 939flct: progress  i = 136 out of 939flct: progress  i = 137 out of 939flct: progress  i = 138 out of 939flct: progress  i = 139 out of 939flct: progress  i = 140 out of 939flct: progress  i = 141 out of 939flct: progress  i = 142 out of 939flct: progress  i = 143 out of 939flct: progress  i = 144 out of 939flct: progress  i = 145 out of 939flct: progress  i = 146 out of 939flct: progress  i = 147 out of 939flct: progress  i = 148 out of 939flct: progress  i = 149 out of 939flct: progress  i = 150 out of 939flct: progress  i = 151 out of 939flct: progress  i = 152 out of 939flct: progress  i = 153 out of 939flct: progress  i = 154 out of 939flct: progress  i = 155 out of 939flct: progress  i = 156 out of 939flct: progress  i = 157 out of 939flct: progress  i = 158 out of 939flct: progress  i = 159 out of 939flct: progress  i = 160 out of 939flct: progress  i = 161 out of 939flct: progress  i = 162 out of 939flct: progress  i = 163 out of 939flct: progress  i = 164 out of 939flct: progress  i = 165 out of 939flct: progress  i = 166 out of 939flct: progress  i = 167 out of 939flct: progress  i = 168 out of 939flct: progress  i = 169 out of 939flct: progress  i = 170 out of 939flct: progress  i = 171 out of 939flct: progress  i = 172 out of 939flct: progress  i = 173 out of 939flct: progress  i = 174 out of 939flct: progress  i = 175 out of 939flct: progress  i = 176 out of 939flct: progress  i = 177 out of 939flct: progress  i = 178 out of 939flct: progress  i = 179 out of 939flct: progress  i = 180 out of 939flct: progress  i = 181 out of 939flct: progress  i = 182 out of 939flct: progress  i = 183 out of 939flct: progress  i = 184 out of 939flct: progress  i = 185 out of 939flct: progress  i = 186 out of 939flct: progress  i = 187 out of 939flct: progress  i = 188 out of 939flct: progress  i = 189 out of 939flct: progress  i = 190 out of 939flct: progress  i = 191 out of 939flct: progress  i = 192 out of 939flct: progress  i = 193 out of 939flct: progress  i = 194 out of 939flct: progress  i = 195 out of 939flct: progress  i = 196 out of 939flct: progress  i = 197 out of 939flct: progress  i = 198 out of 939flct: progress  i = 199 out of 939flct: progress  i = 200 out of 939flct: progress  i = 201 out of 939flct: progress  i = 202 out of 939flct: progress  i = 203 out of 939flct: progress  i = 204 out of 939flct: progress  i = 205 out of 939flct: progress  i = 206 out of 939flct: progress  i = 207 out of 939flct: progress  i = 208 out of 939flct: progress  i = 209 out of 939flct: progress  i = 210 out of 939flct: progress  i = 211 out of 939flct: progress  i = 212 out of 939flct: progress  i = 213 out of 939flct: progress  i = 214 out of 939flct: progress  i = 215 out of 939flct: progress  i = 216 out of 939flct: progress  i = 217 out of 939flct: progress  i = 218 out of 939flct: progress  i = 219 out of 939flct: progress  i = 220 out of 939flct: progress  i = 221 out of 939flct: progress  i = 222 out of 939flct: progress  i = 223 out of 939flct: progress  i = 224 out of 939flct: progress  i = 225 out of 939flct: progress  i = 226 out of 939flct: progress  i = 227 out of 939flct: progress  i = 228 out of 939flct: progress  i = 229 out of 939flct: progress  i = 230 out of 939flct: progress  i = 231 out of 939flct: progress  i = 232 out of 939flct: progress  i = 233 out of 939flct: progress  i = 234 out of 939flct: progress  i = 235 out of 939flct: progress  i = 236 out of 939flct: progress  i = 237 out of 939flct: progress  i = 238 out of 939flct: progress  i = 239 out of 939flct: progress  i = 240 out of 939flct: progress  i = 241 out of 939flct: progress  i = 242 out of 939flct: progress  i = 243 out of 939flct: progress  i = 244 out of 939flct: progress  i = 245 out of 939flct: progress  i = 246 out of 939flct: progress  i = 247 out of 939flct: progress  i = 248 out of 939flct: progress  i = 249 out of 939flct: progress  i = 250 out of 939flct: progress  i = 251 out of 939flct: progress  i = 252 out of 939flct: progress  i = 253 out of 939flct: progress  i = 254 out of 939flct: progress  i = 255 out of 939flct: progress  i = 256 out of 939flct: progress  i = 257 out of 939flct: progress  i = 258 out of 939flct: progress  i = 259 out of 939flct: progress  i = 260 out of 939flct: progress  i = 261 out of 939flct: progress  i = 262 out of 939flct: progress  i = 263 out of 939flct: progress  i = 264 out of 939flct: progress  i = 265 out of 939flct: progress  i = 266 out of 939flct: progress  i = 267 out of 939flct: progress  i = 268 out of 939flct: progress  i = 269 out of 939flct: progress  i = 270 out of 939flct: progress  i = 271 out of 939flct: progress  i = 272 out of 939flct: progress  i = 273 out of 939flct: progress  i = 274 out of 939flct: progress  i = 275 out of 939flct: progress  i = 276 out of 939flct: progress  i = 277 out of 939flct: progress  i = 278 out of 939flct: progress  i = 279 out of 939flct: progress  i = 280 out of 939flct: progress  i = 281 out of 939flct: progress  i = 282 out of 939flct: progress  i = 283 out of 939flct: progress  i = 284 out of 939flct: progress  i = 285 out of 939flct: progress  i = 286 out of 939flct: progress  i = 287 out of 939flct: progress  i = 288 out of 939flct: progress  i = 289 out of 939flct: progress  i = 290 out of 939flct: progress  i = 291 out of 939flct: progress  i = 292 out of 939flct: progress  i = 293 out of 939flct: progress  i = 294 out of 939flct: progress  i = 295 out of 939flct: progress  i = 296 out of 939flct: progress  i = 297 out of 939flct: progress  i = 298 out of 939flct: progress  i = 299 out of 939flct: progress  i = 300 out of 939flct: progress  i = 301 out of 939flct: progress  i = 302 out of 939flct: progress  i = 303 out of 939flct: progress  i = 304 out of 939flct: progress  i = 305 out of 939flct: progress  i = 306 out of 939flct: progress  i = 307 out of 939flct: progress  i = 308 out of 939flct: progress  i = 309 out of 939flct: progress  i = 310 out of 939flct: progress  i = 311 out of 939flct: progress  i = 312 out of 939flct: progress  i = 313 out of 939flct: progress  i = 314 out of 939flct: progress  i = 315 out of 939flct: progress  i = 316 out of 939flct: progress  i = 317 out of 939flct: progress  i = 318 out of 939flct: progress  i = 319 out of 939flct: progress  i = 320 out of 939flct: progress  i = 321 out of 939flct: progress  i = 322 out of 939flct: progress  i = 323 out of 939flct: progress  i = 324 out of 939flct: progress  i = 325 out of 939flct: progress  i = 326 out of 939flct: progress  i = 327 out of 939flct: progress  i = 328 out of 939flct: progress  i = 329 out of 939flct: progress  i = 330 out of 939flct: progress  i = 331 out of 939flct: progress  i = 332 out of 939flct: progress  i = 333 out of 939flct: progress  i = 334 out of 939flct: progress  i = 335 out of 939flct: progress  i = 336 out of 939flct: progress  i = 337 out of 939flct: progress  i = 338 out of 939flct: progress  i = 339 out of 939flct: progress  i = 340 out of 939flct: progress  i = 341 out of 939flct: progress  i = 342 out of 939flct: progress  i = 343 out of 939flct: progress  i = 344 out of 939flct: progress  i = 345 out of 939flct: progress  i = 346 out of 939flct: progress  i = 347 out of 939flct: progress  i = 348 out of 939flct: progress  i = 349 out of 939flct: progress  i = 350 out of 939flct: progress  i = 351 out of 939flct: progress  i = 352 out of 939flct: progress  i = 353 out of 939flct: progress  i = 354 out of 939flct: progress  i = 355 out of 939flct: progress  i = 356 out of 939flct: progress  i = 357 out of 939flct: progress  i = 358 out of 939flct: progress  i = 359 out of 939flct: progress  i = 360 out of 939flct: progress  i = 361 out of 939flct: progress  i = 362 out of 939flct: progress  i = 363 out of 939flct: progress  i = 364 out of 939flct: progress  i = 365 out of 939flct: progress  i = 366 out of 939flct: progress  i = 367 out of 939flct: progress  i = 368 out of 939flct: progress  i = 369 out of 939flct: progress  i = 370 out of 939flct: progress  i = 371 out of 939flct: progress  i = 372 out of 939flct: progress  i = 373 out of 939flct: progress  i = 374 out of 939flct: progress  i = 375 out of 939flct: progress  i = 376 out of 939flct: progress  i = 377 out of 939flct: progress  i = 378 out of 939flct: progress  i = 379 out of 939flct: progress  i = 380 out of 939flct: progress  i = 381 out of 939flct: progress  i = 382 out of 939flct: progress  i = 383 out of 939flct: progress  i = 384 out of 939flct: progress  i = 385 out of 939flct: progress  i = 386 out of 939flct: progress  i = 387 out of 939flct: progress  i = 388 out of 939flct: progress  i = 389 out of 939flct: progress  i = 390 out of 939flct: progress  i = 391 out of 939flct: progress  i = 392 out of 939flct: progress  i = 393 out of 939flct: progress  i = 394 out of 939flct: progress  i = 395 out of 939flct: progress  i = 396 out of 939flct: progress  i = 397 out of 939flct: progress  i = 398 out of 939flct: progress  i = 399 out of 939flct: progress  i = 400 out of 939flct: progress  i = 401 out of 939flct: progress  i = 402 out of 939flct: progress  i = 403 out of 939flct: progress  i = 404 out of 939flct: progress  i = 405 out of 939flct: progress  i = 406 out of 939flct: progress  i = 407 out of 939flct: progress  i = 408 out of 939flct: progress  i = 409 out of 939flct: progress  i = 410 out of 939flct: progress  i = 411 out of 939flct: progress  i = 412 out of 939flct: progress  i = 413 out of 939flct: progress  i = 414 out of 939flct: progress  i = 415 out of 939flct: progress  i = 416 out of 939flct: progress  i = 417 out of 939flct: progress  i = 418 out of 939flct: progress  i = 419 out of 939flct: progress  i = 420 out of 939flct: progress  i = 421 out of 939flct: progress  i = 422 out of 939flct: progress  i = 423 out of 939flct: progress  i = 424 out of 939flct: progress  i = 425 out of 939flct: progress  i = 426 out of 939flct: progress  i = 427 out of 939flct: progress  i = 428 out of 939flct: progress  i = 429 out of 939flct: progress  i = 430 out of 939flct: progress  i = 431 out of 939flct: progress  i = 432 out of 939flct: progress  i = 433 out of 939flct: progress  i = 434 out of 939flct: progress  i = 435 out of 939flct: progress  i = 436 out of 939flct: progress  i = 437 out of 939flct: progress  i = 438 out of 939flct: progress  i = 439 out of 939flct: progress  i = 440 out of 939flct: progress  i = 441 out of 939flct: progress  i = 442 out of 939flct: progress  i = 443 out of 939flct: progress  i = 444 out of 939flct: progress  i = 445 out of 939flct: progress  i = 446 out of 939flct: progress  i = 447 out of 939flct: progress  i = 448 out of 939flct: progress  i = 449 out of 939flct: progress  i = 450 out of 939flct: progress  i = 451 out of 939flct: progress  i = 452 out of 939flct: progress  i = 453 out of 939flct: progress  i = 454 out of 939flct: progress  i = 455 out of 939flct: progress  i = 456 out of 939flct: progress  i = 457 out of 939flct: progress  i = 458 out of 939flct: progress  i = 459 out of 939flct: progress  i = 460 out of 939flct: progress  i = 461 out of 939flct: progress  i = 462 out of 939flct: progress  i = 463 out of 939flct: progress  i = 464 out of 939flct: progress  i = 465 out of 939flct: progress  i = 466 out of 939flct: progress  i = 467 out of 939flct: progress  i = 468 out of 939flct: progress  i = 469 out of 939flct: progress  i = 470 out of 939flct: progress  i = 471 out of 939flct: progress  i = 472 out of 939flct: progress  i = 473 out of 939flct: progress  i = 474 out of 939flct: progress  i = 475 out of 939flct: progress  i = 476 out of 939flct: progress  i = 477 out of 939flct: progress  i = 478 out of 939flct: progress  i = 479 out of 939flct: progress  i = 480 out of 939flct: progress  i = 481 out of 939flct: progress  i = 482 out of 939flct: progress  i = 483 out of 939flct: progress  i = 484 out of 939flct: progress  i = 485 out of 939flct: progress  i = 486 out of 939flct: progress  i = 487 out of 939flct: progress  i = 488 out of 939flct: progress  i = 489 out of 939flct: progress  i = 490 out of 939flct: progress  i = 491 out of 939flct: progress  i = 492 out of 939flct: progress  i = 493 out of 939flct: progress  i = 494 out of 939flct: progress  i = 495 out of 939flct: progress  i = 496 out of 939flct: progress  i = 497 out of 939flct: progress  i = 498 out of 939flct: progress  i = 499 out of 939flct: progress  i = 500 out of 939flct: progress  i = 501 out of 939flct: progress  i = 502 out of 939flct: progress  i = 503 out of 939flct: progress  i = 504 out of 939flct: progress  i = 505 out of 939flct: progress  i = 506 out of 939flct: progress  i = 507 out of 939flct: progress  i = 508 out of 939flct: progress  i = 509 out of 939flct: progress  i = 510 out of 939flct: progress  i = 511 out of 939flct: progress  i = 512 out of 939flct: progress  i = 513 out of 939flct: progress  i = 514 out of 939flct: progress  i = 515 out of 939flct: progress  i = 516 out of 939flct: progress  i = 517 out of 939flct: progress  i = 518 out of 939flct: progress  i = 519 out of 939flct: progress  i = 520 out of 939flct: progress  i = 521 out of 939flct: progress  i = 522 out of 939flct: progress  i = 523 out of 939flct: progress  i = 524 out of 939flct: progress  i = 525 out of 939flct: progress  i = 526 out of 939flct: progress  i = 527 out of 939flct: progress  i = 528 out of 939flct: progress  i = 529 out of 939flct: progress  i = 530 out of 939flct: progress  i = 531 out of 939flct: progress  i = 532 out of 939flct: progress  i = 533 out of 939flct: progress  i = 534 out of 939flct: progress  i = 535 out of 939flct: progress  i = 536 out of 939flct: progress  i = 537 out of 939flct: progress  i = 538 out of 939flct: progress  i = 539 out of 939flct: progress  i = 540 out of 939flct: progress  i = 541 out of 939flct: progress  i = 542 out of 939flct: progress  i = 543 out of 939flct: progress  i = 544 out of 939flct: progress  i = 545 out of 939flct: progress  i = 546 out of 939flct: progress  i = 547 out of 939flct: progress  i = 548 out of 939flct: progress  i = 549 out of 939flct: progress  i = 550 out of 939flct: progress  i = 551 out of 939flct: progress  i = 552 out of 939flct: progress  i = 553 out of 939flct: progress  i = 554 out of 939flct: progress  i = 555 out of 939flct: progress  i = 556 out of 939flct: progress  i = 557 out of 939flct: progress  i = 558 out of 939flct: progress  i = 559 out of 939flct: progress  i = 560 out of 939flct: progress  i = 561 out of 939flct: progress  i = 562 out of 939flct: progress  i = 563 out of 939flct: progress  i = 564 out of 939flct: progress  i = 565 out of 939flct: progress  i = 566 out of 939flct: progress  i = 567 out of 939flct: progress  i = 568 out of 939flct: progress  i = 569 out of 939flct: progress  i = 570 out of 939flct: progress  i = 571 out of 939flct: progress  i = 572 out of 939flct: progress  i = 573 out of 939flct: progress  i = 574 out of 939flct: progress  i = 575 out of 939flct: progress  i = 576 out of 939flct: progress  i = 577 out of 939flct: progress  i = 578 out of 939flct: progress  i = 579 out of 939flct: progress  i = 580 out of 939flct: progress  i = 581 out of 939flct: progress  i = 582 out of 939flct: progress  i = 583 out of 939flct: progress  i = 584 out of 939flct: progress  i = 585 out of 939flct: progress  i = 586 out of 939flct: progress  i = 587 out of 939flct: progress  i = 588 out of 939flct: progress  i = 589 out of 939flct: progress  i = 590 out of 939flct: progress  i = 591 out of 939flct: progress  i = 592 out of 939flct: progress  i = 593 out of 939flct: progress  i = 594 out of 939flct: progress  i = 595 out of 939flct: progress  i = 596 out of 939flct: progress  i = 597 out of 939flct: progress  i = 598 out of 939flct: progress  i = 599 out of 939flct: progress  i = 600 out of 939flct: progress  i = 601 out of 939flct: progress  i = 602 out of 939flct: progress  i = 603 out of 939flct: progress  i = 604 out of 939flct: progress  i = 605 out of 939flct: progress  i = 606 out of 939flct: progress  i = 607 out of 939flct: progress  i = 608 out of 939flct: progress  i = 609 out of 939flct: progress  i = 610 out of 939flct: progress  i = 611 out of 939flct: progress  i = 612 out of 939flct: progress  i = 613 out of 939flct: progress  i = 614 out of 939flct: progress  i = 615 out of 939flct: progress  i = 616 out of 939flct: progress  i = 617 out of 939flct: progress  i = 618 out of 939flct: progress  i = 619 out of 939flct: progress  i = 620 out of 939flct: progress  i = 621 out of 939flct: progress  i = 622 out of 939flct: progress  i = 623 out of 939flct: progress  i = 624 out of 939flct: progress  i = 625 out of 939flct: progress  i = 626 out of 939flct: progress  i = 627 out of 939flct: progress  i = 628 out of 939flct: progress  i = 629 out of 939flct: progress  i = 630 out of 939flct: progress  i = 631 out of 939flct: progress  i = 632 out of 939flct: progress  i = 633 out of 939flct: progress  i = 634 out of 939flct: progress  i = 635 out of 939flct: progress  i = 636 out of 939flct: progress  i = 637 out of 939flct: progress  i = 638 out of 939flct: progress  i = 639 out of 939flct: progress  i = 640 out of 939flct: progress  i = 641 out of 939flct: progress  i = 642 out of 939flct: progress  i = 643 out of 939flct: progress  i = 644 out of 939flct: progress  i = 645 out of 939flct: progress  i = 646 out of 939flct: progress  i = 647 out of 939flct: progress  i = 648 out of 939flct: progress  i = 649 out of 939flct: progress  i = 650 out of 939flct: progress  i = 651 out of 939flct: progress  i = 652 out of 939flct: progress  i = 653 out of 939flct: progress  i = 654 out of 939flct: progress  i = 655 out of 939flct: progress  i = 656 out of 939flct: progress  i = 657 out of 939flct: progress  i = 658 out of 939flct: progress  i = 659 out of 939flct: progress  i = 660 out of 939flct: progress  i = 661 out of 939flct: progress  i = 662 out of 939flct: progress  i = 663 out of 939flct: progress  i = 664 out of 939flct: progress  i = 665 out of 939flct: progress  i = 666 out of 939flct: progress  i = 667 out of 939flct: progress  i = 668 out of 939flct: progress  i = 669 out of 939flct: progress  i = 670 out of 939flct: progress  i = 671 out of 939flct: progress  i = 672 out of 939flct: progress  i = 673 out of 939flct: progress  i = 674 out of 939flct: progress  i = 675 out of 939flct: progress  i = 676 out of 939flct: progress  i = 677 out of 939flct: progress  i = 678 out of 939flct: progress  i = 679 out of 939flct: progress  i = 680 out of 939flct: progress  i = 681 out of 939flct: progress  i = 682 out of 939flct: progress  i = 683 out of 939flct: progress  i = 684 out of 939flct: progress  i = 685 out of 939flct: progress  i = 686 out of 939flct: progress  i = 687 out of 939flct: progress  i = 688 out of 939flct: progress  i = 689 out of 939flct: progress  i = 690 out of 939flct: progress  i = 691 out of 939flct: progress  i = 692 out of 939flct: progress  i = 693 out of 939flct: progress  i = 694 out of 939flct: progress  i = 695 out of 939flct: progress  i = 696 out of 939flct: progress  i = 697 out of 939flct: progress  i = 698 out of 939flct: progress  i = 699 out of 939flct: progress  i = 700 out of 939flct: progress  i = 701 out of 939flct: progress  i = 702 out of 939flct: progress  i = 703 out of 939flct: progress  i = 704 out of 939flct: progress  i = 705 out of 939flct: progress  i = 706 out of 939flct: progress  i = 707 out of 939flct: progress  i = 708 out of 939flct: progress  i = 709 out of 939flct: progress  i = 710 out of 939flct: progress  i = 711 out of 939flct: progress  i = 712 out of 939flct: progress  i = 713 out of 939flct: progress  i = 714 out of 939flct: progress  i = 715 out of 939flct: progress  i = 716 out of 939flct: progress  i = 717 out of 939flct: progress  i = 718 out of 939flct: progress  i = 719 out of 939flct: progress  i = 720 out of 939flct: progress  i = 721 out of 939flct: progress  i = 722 out of 939flct: progress  i = 723 out of 939flct: progress  i = 724 out of 939flct: progress  i = 725 out of 939flct: progress  i = 726 out of 939flct: progress  i = 727 out of 939flct: progress  i = 728 out of 939flct: progress  i = 729 out of 939flct: progress  i = 730 out of 939flct: progress  i = 731 out of 939flct: progress  i = 732 out of 939flct: progress  i = 733 out of 939flct: progress  i = 734 out of 939flct: progress  i = 735 out of 939flct: progress  i = 736 out of 939flct: progress  i = 737 out of 939flct: progress  i = 738 out of 939flct: progress  i = 739 out of 939flct: progress  i = 740 out of 939flct: progress  i = 741 out of 939flct: progress  i = 742 out of 939flct: progress  i = 743 out of 939flct: progress  i = 744 out of 939flct: progress  i = 745 out of 939flct: progress  i = 746 out of 939flct: progress  i = 747 out of 939flct: progress  i = 748 out of 939flct: progress  i = 749 out of 939flct: progress  i = 750 out of 939flct: progress  i = 751 out of 939flct: progress  i = 752 out of 939flct: progress  i = 753 out of 939flct: progress  i = 754 out of 939flct: progress  i = 755 out of 939flct: progress  i = 756 out of 939flct: progress  i = 757 out of 939flct: progress  i = 758 out of 939flct: progress  i = 759 out of 939flct: progress  i = 760 out of 939flct: progress  i = 761 out of 939flct: progress  i = 762 out of 939flct: progress  i = 763 out of 939flct: progress  i = 764 out of 939flct: progress  i = 765 out of 939flct: progress  i = 766 out of 939flct: progress  i = 767 out of 939flct: progress  i = 768 out of 939flct: progress  i = 769 out of 939flct: progress  i = 770 out of 939flct: progress  i = 771 out of 939flct: progress  i = 772 out of 939flct: progress  i = 773 out of 939flct: progress  i = 774 out of 939flct: progress  i = 775 out of 939flct: progress  i = 776 out of 939flct: progress  i = 777 out of 939flct: progress  i = 778 out of 939flct: progress  i = 779 out of 939flct: progress  i = 780 out of 939flct: progress  i = 781 out of 939flct: progress  i = 782 out of 939flct: progress  i = 783 out of 939flct: progress  i = 784 out of 939flct: progress  i = 785 out of 939flct: progress  i = 786 out of 939flct: progress  i = 787 out of 939flct: progress  i = 788 out of 939flct: progress  i = 789 out of 939flct: progress  i = 790 out of 939flct: progress  i = 791 out of 939flct: progress  i = 792 out of 939flct: progress  i = 793 out of 939flct: progress  i = 794 out of 939flct: progress  i = 795 out of 939flct: progress  i = 796 out of 939flct: progress  i = 797 out of 939flct: progress  i = 798 out of 939flct: progress  i = 799 out of 939flct: progress  i = 800 out of 939flct: progress  i = 801 out of 939flct: progress  i = 802 out of 939flct: progress  i = 803 out of 939flct: progress  i = 804 out of 939flct: progress  i = 805 out of 939flct: progress  i = 806 out of 939flct: progress  i = 807 out of 939flct: progress  i = 808 out of 939flct: progress  i = 809 out of 939flct: progress  i = 810 out of 939flct: progress  i = 811 out of 939flct: progress  i = 812 out of 939flct: progress  i = 813 out of 939flct: progress  i = 814 out of 939flct: progress  i = 815 out of 939flct: progress  i = 816 out of 939flct: progress  i = 817 out of 939flct: progress  i = 818 out of 939flct: progress  i = 819 out of 939flct: progress  i = 820 out of 939flct: progress  i = 821 out of 939flct: progress  i = 822 out of 939flct: progress  i = 823 out of 939flct: progress  i = 824 out of 939flct: progress  i = 825 out of 939flct: progress  i = 826 out of 939flct: progress  i = 827 out of 939flct: progress  i = 828 out of 939flct: progress  i = 829 out of 939flct: progress  i = 830 out of 939flct: progress  i = 831 out of 939flct: progress  i = 832 out of 939flct: progress  i = 833 out of 939flct: progress  i = 834 out of 939flct: progress  i = 835 out of 939flct: progress  i = 836 out of 939flct: progress  i = 837 out of 939flct: progress  i = 838 out of 939flct: progress  i = 839 out of 939flct: progress  i = 840 out of 939flct: progress  i = 841 out of 939flct: progress  i = 842 out of 939flct: progress  i = 843 out of 939flct: progress  i = 844 out of 939flct: progress  i = 845 out of 939flct: progress  i = 846 out of 939flct: progress  i = 847 out of 939flct: progress  i = 848 out of 939flct: progress  i = 849 out of 939flct: progress  i = 850 out of 939flct: progress  i = 851 out of 939flct: progress  i = 852 out of 939flct: progress  i = 853 out of 939flct: progress  i = 854 out of 939flct: progress  i = 855 out of 939flct: progress  i = 856 out of 939flct: progress  i = 857 out of 939flct: progress  i = 858 out of 939flct: progress  i = 859 out of 939flct: progress  i = 860 out of 939flct: progress  i = 861 out of 939flct: progress  i = 862 out of 939flct: progress  i = 863 out of 939flct: progress  i = 864 out of 939flct: progress  i = 865 out of 939flct: progress  i = 866 out of 939flct: progress  i = 867 out of 939flct: progress  i = 868 out of 939flct: progress  i = 869 out of 939flct: progress  i = 870 out of 939flct: progress  i = 871 out of 939flct: progress  i = 872 out of 939flct: progress  i = 873 out of 939flct: progress  i = 874 out of 939flct: progress  i = 875 out of 939flct: progress  i = 876 out of 939flct: progress  i = 877 out of 939flct: progress  i = 878 out of 939flct: progress  i = 879 out of 939flct: progress  i = 880 out of 939flct: progress  i = 881 out of 939flct: progress  i = 882 out of 939flct: progress  i = 883 out of 939flct: progress  i = 884 out of 939flct: progress  i = 885 out of 939flct: progress  i = 886 out of 939flct: progress  i = 887 out of 939flct: progress  i = 888 out of 939flct: progress  i = 889 out of 939flct: progress  i = 890 out of 939flct: progress  i = 891 out of 939flct: progress  i = 892 out of 939flct: progress  i = 893 out of 939flct: progress  i = 894 out of 939flct: progress  i = 895 out of 939flct: progress  i = 896 out of 939flct: progress  i = 897 out of 939flct: progress  i = 898 out of 939flct: progress  i = 899 out of 939flct: progress  i = 900 out of 939flct: progress  i = 901 out of 939flct: progress  i = 902 out of 939flct: progress  i = 903 out of 939flct: progress  i = 904 out of 939flct: progress  i = 905 out of 939flct: progress  i = 906 out of 939flct: progress  i = 907 out of 939flct: progress  i = 908 out of 939flct: progress  i = 909 out of 939flct: progress  i = 910 out of 939flct: progress  i = 911 out of 939flct: progress  i = 912 out of 939flct: progress  i = 913 out of 939flct: progress  i = 914 out of 939flct: progress  i = 915 out of 939flct: progress  i = 916 out of 939flct: progress  i = 917 out of 939flct: progress  i = 918 out of 939flct: progress  i = 919 out of 939flct: progress  i = 920 out of 939flct: progress  i = 921 out of 939flct: progress  i = 922 out of 939flct: progress  i = 923 out of 939flct: progress  i = 924 out of 939flct: progress  i = 925 out of 939flct: progress  i = 926 out of 939flct: progress  i = 927 out of 939flct: progress  i = 928 out of 939flct: progress  i = 929 out of 939flct: progress  i = 930 out of 939flct: progress  i = 931 out of 939flct: progress  i = 932 out of 939flct: progress  i = 933 out of 939flct: progress  i = 934 out of 939flct: progress  i = 935 out of 939flct: progress  i = 936 out of 939flct: progress  i = 937 out of 939flct: progress  i = 938 out of 939flct: progress  i = 939 out of 939flct: mean value of gamma^2/sigma^2 = 0.26128

flct: finished
#+end_example

#+begin_src python :results output
  import sys
  sys.path.append("../../Source/pyflct")
  import os
  from pathlib import Path
  import numpy as np
  import pyflct
  from astropy.io import fits
  from astropy.wcs import WCS

  os.environ["PATH"] = ":".join((os.environ["PATH"], "/Users/will/.local/bin"))
  datadir = Path("proper-motions/data")

  h1, = fits.open(datadir / "hh529_wfpc2_f656n_1996.fits")
  h2, = fits.open(datadir / "hh529_wfc3_f656n_2015.fits")

  data_scale = h2.data.max()
  sigma = 5.0
  vx, vy, vm = pyflct.flct(h1.data.T, h2.data.T,
                           deltat=1.0, deltas=1.0, sigma=sigma,
                           thresh=0.1/data_scale,
  )
  vx[vm==0] = np.nan
  vy[vm==0] = np.nan

  fits.PrimaryHDU(
      header=h1.header,
      data=vx.T,
  ).writeto(datadir / f"hh529_f656n_1996_2015_vx_sig{int(sigma):02d}.fits", overwrite=True)

  fits.PrimaryHDU(
      header=h1.header,
      data=vy.T,
  ).writeto(datadir / f"hh529_f656n_1996_2015_vy_sig{int(sigma):02d}.fits", overwrite=True)
#+end_src

#+RESULTS:
#+begin_example
flct: Version 1.07     Copyright: 2007-2018 University of California
flct: small endian machine; i/o will be byteswapped
flct: infile = testin.dat
flct: outfile = testout.dat
flct: column major order assumed for data arrays
flct: deltat = 1
flct: deltas = 1
flct: sigma = 5
flct: threshold image value for LCT is 0
flct: bias correction not enabled
flct: complex.h is not included
flct: from input file, nx = 1550, ny = 940
flct: nominal sliding box size = 20
flct: progress  i = 0 out of 939flct: progress  i = 1 out of 939flct: progress  i = 2 out of 939flct: progress  i = 3 out of 939flct: progress  i = 4 out of 939flct: progress  i = 5 out of 939flct: progress  i = 6 out of 939flct: progress  i = 7 out of 939flct: progress  i = 8 out of 939flct: progress  i = 9 out of 939flct: progress  i = 10 out of 939flct: progress  i = 11 out of 939flct: progress  i = 12 out of 939flct: progress  i = 13 out of 939flct: progress  i = 14 out of 939flct: progress  i = 15 out of 939flct: progress  i = 16 out of 939flct: progress  i = 17 out of 939flct: progress  i = 18 out of 939flct: progress  i = 19 out of 939flct: progress  i = 20 out of 939flct: progress  i = 21 out of 939flct: progress  i = 22 out of 939flct: progress  i = 23 out of 939flct: progress  i = 24 out of 939flct: progress  i = 25 out of 939flct: progress  i = 26 out of 939flct: progress  i = 27 out of 939flct: progress  i = 28 out of 939flct: progress  i = 29 out of 939flct: progress  i = 30 out of 939flct: progress  i = 31 out of 939flct: progress  i = 32 out of 939flct: progress  i = 33 out of 939flct: progress  i = 34 out of 939flct: progress  i = 35 out of 939flct: progress  i = 36 out of 939flct: progress  i = 37 out of 939flct: progress  i = 38 out of 939flct: progress  i = 39 out of 939flct: progress  i = 40 out of 939flct: progress  i = 41 out of 939flct: progress  i = 42 out of 939flct: progress  i = 43 out of 939flct: progress  i = 44 out of 939flct: progress  i = 45 out of 939flct: progress  i = 46 out of 939flct: progress  i = 47 out of 939flct: progress  i = 48 out of 939flct: progress  i = 49 out of 939flct: progress  i = 50 out of 939flct: progress  i = 51 out of 939flct: progress  i = 52 out of 939flct: progress  i = 53 out of 939flct: progress  i = 54 out of 939flct: progress  i = 55 out of 939flct: progress  i = 56 out of 939flct: progress  i = 57 out of 939flct: progress  i = 58 out of 939flct: progress  i = 59 out of 939flct: progress  i = 60 out of 939flct: progress  i = 61 out of 939flct: progress  i = 62 out of 939flct: progress  i = 63 out of 939flct: progress  i = 64 out of 939flct: progress  i = 65 out of 939flct: progress  i = 66 out of 939flct: progress  i = 67 out of 939flct: progress  i = 68 out of 939flct: progress  i = 69 out of 939flct: progress  i = 70 out of 939flct: progress  i = 71 out of 939flct: progress  i = 72 out of 939flct: progress  i = 73 out of 939flct: progress  i = 74 out of 939flct: progress  i = 75 out of 939flct: progress  i = 76 out of 939flct: progress  i = 77 out of 939flct: progress  i = 78 out of 939flct: progress  i = 79 out of 939flct: progress  i = 80 out of 939flct: progress  i = 81 out of 939flct: progress  i = 82 out of 939flct: progress  i = 83 out of 939flct: progress  i = 84 out of 939flct: progress  i = 85 out of 939flct: progress  i = 86 out of 939flct: progress  i = 87 out of 939flct: progress  i = 88 out of 939flct: progress  i = 89 out of 939flct: progress  i = 90 out of 939flct: progress  i = 91 out of 939flct: progress  i = 92 out of 939flct: progress  i = 93 out of 939flct: progress  i = 94 out of 939flct: progress  i = 95 out of 939flct: progress  i = 96 out of 939flct: progress  i = 97 out of 939flct: progress  i = 98 out of 939flct: progress  i = 99 out of 939flct: progress  i = 100 out of 939flct: progress  i = 101 out of 939flct: progress  i = 102 out of 939flct: progress  i = 103 out of 939flct: progress  i = 104 out of 939flct: progress  i = 105 out of 939flct: progress  i = 106 out of 939flct: progress  i = 107 out of 939flct: progress  i = 108 out of 939flct: progress  i = 109 out of 939flct: progress  i = 110 out of 939flct: progress  i = 111 out of 939flct: progress  i = 112 out of 939flct: progress  i = 113 out of 939flct: progress  i = 114 out of 939flct: progress  i = 115 out of 939flct: progress  i = 116 out of 939flct: progress  i = 117 out of 939flct: progress  i = 118 out of 939flct: progress  i = 119 out of 939flct: progress  i = 120 out of 939flct: progress  i = 121 out of 939flct: progress  i = 122 out of 939flct: progress  i = 123 out of 939flct: progress  i = 124 out of 939flct: progress  i = 125 out of 939flct: progress  i = 126 out of 939flct: progress  i = 127 out of 939flct: progress  i = 128 out of 939flct: progress  i = 129 out of 939flct: progress  i = 130 out of 939flct: progress  i = 131 out of 939flct: progress  i = 132 out of 939flct: progress  i = 133 out of 939flct: progress  i = 134 out of 939flct: progress  i = 135 out of 939flct: progress  i = 136 out of 939flct: progress  i = 137 out of 939flct: progress  i = 138 out of 939flct: progress  i = 139 out of 939flct: progress  i = 140 out of 939flct: progress  i = 141 out of 939flct: progress  i = 142 out of 939flct: progress  i = 143 out of 939flct: progress  i = 144 out of 939flct: progress  i = 145 out of 939flct: progress  i = 146 out of 939flct: progress  i = 147 out of 939flct: progress  i = 148 out of 939flct: progress  i = 149 out of 939flct: progress  i = 150 out of 939flct: progress  i = 151 out of 939flct: progress  i = 152 out of 939flct: progress  i = 153 out of 939flct: progress  i = 154 out of 939flct: progress  i = 155 out of 939flct: progress  i = 156 out of 939flct: progress  i = 157 out of 939flct: progress  i = 158 out of 939flct: progress  i = 159 out of 939flct: progress  i = 160 out of 939flct: progress  i = 161 out of 939flct: progress  i = 162 out of 939flct: progress  i = 163 out of 939flct: progress  i = 164 out of 939flct: progress  i = 165 out of 939flct: progress  i = 166 out of 939flct: progress  i = 167 out of 939flct: progress  i = 168 out of 939flct: progress  i = 169 out of 939flct: progress  i = 170 out of 939flct: progress  i = 171 out of 939flct: progress  i = 172 out of 939flct: progress  i = 173 out of 939flct: progress  i = 174 out of 939flct: progress  i = 175 out of 939flct: progress  i = 176 out of 939flct: progress  i = 177 out of 939flct: progress  i = 178 out of 939flct: progress  i = 179 out of 939flct: progress  i = 180 out of 939flct: progress  i = 181 out of 939flct: progress  i = 182 out of 939flct: progress  i = 183 out of 939flct: progress  i = 184 out of 939flct: progress  i = 185 out of 939flct: progress  i = 186 out of 939flct: progress  i = 187 out of 939flct: progress  i = 188 out of 939flct: progress  i = 189 out of 939flct: progress  i = 190 out of 939flct: progress  i = 191 out of 939flct: progress  i = 192 out of 939flct: progress  i = 193 out of 939flct: progress  i = 194 out of 939flct: progress  i = 195 out of 939flct: progress  i = 196 out of 939flct: progress  i = 197 out of 939flct: progress  i = 198 out of 939flct: progress  i = 199 out of 939flct: progress  i = 200 out of 939flct: progress  i = 201 out of 939flct: progress  i = 202 out of 939flct: progress  i = 203 out of 939flct: progress  i = 204 out of 939flct: progress  i = 205 out of 939flct: progress  i = 206 out of 939flct: progress  i = 207 out of 939flct: progress  i = 208 out of 939flct: progress  i = 209 out of 939flct: progress  i = 210 out of 939flct: progress  i = 211 out of 939flct: progress  i = 212 out of 939flct: progress  i = 213 out of 939flct: progress  i = 214 out of 939flct: progress  i = 215 out of 939flct: progress  i = 216 out of 939flct: progress  i = 217 out of 939flct: progress  i = 218 out of 939flct: progress  i = 219 out of 939flct: progress  i = 220 out of 939flct: progress  i = 221 out of 939flct: progress  i = 222 out of 939flct: progress  i = 223 out of 939flct: progress  i = 224 out of 939flct: progress  i = 225 out of 939flct: progress  i = 226 out of 939flct: progress  i = 227 out of 939flct: progress  i = 228 out of 939flct: progress  i = 229 out of 939flct: progress  i = 230 out of 939flct: progress  i = 231 out of 939flct: progress  i = 232 out of 939flct: progress  i = 233 out of 939flct: progress  i = 234 out of 939flct: progress  i = 235 out of 939flct: progress  i = 236 out of 939flct: progress  i = 237 out of 939flct: progress  i = 238 out of 939flct: progress  i = 239 out of 939flct: progress  i = 240 out of 939flct: progress  i = 241 out of 939flct: progress  i = 242 out of 939flct: progress  i = 243 out of 939flct: progress  i = 244 out of 939flct: progress  i = 245 out of 939flct: progress  i = 246 out of 939flct: progress  i = 247 out of 939flct: progress  i = 248 out of 939flct: progress  i = 249 out of 939flct: progress  i = 250 out of 939flct: progress  i = 251 out of 939flct: progress  i = 252 out of 939flct: progress  i = 253 out of 939flct: progress  i = 254 out of 939flct: progress  i = 255 out of 939flct: progress  i = 256 out of 939flct: progress  i = 257 out of 939flct: progress  i = 258 out of 939flct: progress  i = 259 out of 939flct: progress  i = 260 out of 939flct: progress  i = 261 out of 939flct: progress  i = 262 out of 939flct: progress  i = 263 out of 939flct: progress  i = 264 out of 939flct: progress  i = 265 out of 939flct: progress  i = 266 out of 939flct: progress  i = 267 out of 939flct: progress  i = 268 out of 939flct: progress  i = 269 out of 939flct: progress  i = 270 out of 939flct: progress  i = 271 out of 939flct: progress  i = 272 out of 939flct: progress  i = 273 out of 939flct: progress  i = 274 out of 939flct: progress  i = 275 out of 939flct: progress  i = 276 out of 939flct: progress  i = 277 out of 939flct: progress  i = 278 out of 939flct: progress  i = 279 out of 939flct: progress  i = 280 out of 939flct: progress  i = 281 out of 939flct: progress  i = 282 out of 939flct: progress  i = 283 out of 939flct: progress  i = 284 out of 939flct: progress  i = 285 out of 939flct: progress  i = 286 out of 939flct: progress  i = 287 out of 939flct: progress  i = 288 out of 939flct: progress  i = 289 out of 939flct: progress  i = 290 out of 939flct: progress  i = 291 out of 939flct: progress  i = 292 out of 939flct: progress  i = 293 out of 939flct: progress  i = 294 out of 939flct: progress  i = 295 out of 939flct: progress  i = 296 out of 939flct: progress  i = 297 out of 939flct: progress  i = 298 out of 939flct: progress  i = 299 out of 939flct: progress  i = 300 out of 939flct: progress  i = 301 out of 939flct: progress  i = 302 out of 939flct: progress  i = 303 out of 939flct: progress  i = 304 out of 939flct: progress  i = 305 out of 939flct: progress  i = 306 out of 939flct: progress  i = 307 out of 939flct: progress  i = 308 out of 939flct: progress  i = 309 out of 939flct: progress  i = 310 out of 939flct: progress  i = 311 out of 939flct: progress  i = 312 out of 939flct: progress  i = 313 out of 939flct: progress  i = 314 out of 939flct: progress  i = 315 out of 939flct: progress  i = 316 out of 939flct: progress  i = 317 out of 939flct: progress  i = 318 out of 939flct: progress  i = 319 out of 939flct: progress  i = 320 out of 939flct: progress  i = 321 out of 939flct: progress  i = 322 out of 939flct: progress  i = 323 out of 939flct: progress  i = 324 out of 939flct: progress  i = 325 out of 939flct: progress  i = 326 out of 939flct: progress  i = 327 out of 939flct: progress  i = 328 out of 939flct: progress  i = 329 out of 939flct: progress  i = 330 out of 939flct: progress  i = 331 out of 939flct: progress  i = 332 out of 939flct: progress  i = 333 out of 939flct: progress  i = 334 out of 939flct: progress  i = 335 out of 939flct: progress  i = 336 out of 939flct: progress  i = 337 out of 939flct: progress  i = 338 out of 939flct: progress  i = 339 out of 939flct: progress  i = 340 out of 939flct: progress  i = 341 out of 939flct: progress  i = 342 out of 939flct: progress  i = 343 out of 939flct: progress  i = 344 out of 939flct: progress  i = 345 out of 939flct: progress  i = 346 out of 939flct: progress  i = 347 out of 939flct: progress  i = 348 out of 939flct: progress  i = 349 out of 939flct: progress  i = 350 out of 939flct: progress  i = 351 out of 939flct: progress  i = 352 out of 939flct: progress  i = 353 out of 939flct: progress  i = 354 out of 939flct: progress  i = 355 out of 939flct: progress  i = 356 out of 939flct: progress  i = 357 out of 939flct: progress  i = 358 out of 939flct: progress  i = 359 out of 939flct: progress  i = 360 out of 939flct: progress  i = 361 out of 939flct: progress  i = 362 out of 939flct: progress  i = 363 out of 939flct: progress  i = 364 out of 939flct: progress  i = 365 out of 939flct: progress  i = 366 out of 939flct: progress  i = 367 out of 939flct: progress  i = 368 out of 939flct: progress  i = 369 out of 939flct: progress  i = 370 out of 939flct: progress  i = 371 out of 939flct: progress  i = 372 out of 939flct: progress  i = 373 out of 939flct: progress  i = 374 out of 939flct: progress  i = 375 out of 939flct: progress  i = 376 out of 939flct: progress  i = 377 out of 939flct: progress  i = 378 out of 939flct: progress  i = 379 out of 939flct: progress  i = 380 out of 939flct: progress  i = 381 out of 939flct: progress  i = 382 out of 939flct: progress  i = 383 out of 939flct: progress  i = 384 out of 939flct: progress  i = 385 out of 939flct: progress  i = 386 out of 939flct: progress  i = 387 out of 939flct: progress  i = 388 out of 939flct: progress  i = 389 out of 939flct: progress  i = 390 out of 939flct: progress  i = 391 out of 939flct: progress  i = 392 out of 939flct: progress  i = 393 out of 939flct: progress  i = 394 out of 939flct: progress  i = 395 out of 939flct: progress  i = 396 out of 939flct: progress  i = 397 out of 939flct: progress  i = 398 out of 939flct: progress  i = 399 out of 939flct: progress  i = 400 out of 939flct: progress  i = 401 out of 939flct: progress  i = 402 out of 939flct: progress  i = 403 out of 939flct: progress  i = 404 out of 939flct: progress  i = 405 out of 939flct: progress  i = 406 out of 939flct: progress  i = 407 out of 939flct: progress  i = 408 out of 939flct: progress  i = 409 out of 939flct: progress  i = 410 out of 939flct: progress  i = 411 out of 939flct: progress  i = 412 out of 939flct: progress  i = 413 out of 939flct: progress  i = 414 out of 939flct: progress  i = 415 out of 939flct: progress  i = 416 out of 939flct: progress  i = 417 out of 939flct: progress  i = 418 out of 939flct: progress  i = 419 out of 939flct: progress  i = 420 out of 939flct: progress  i = 421 out of 939flct: progress  i = 422 out of 939flct: progress  i = 423 out of 939flct: progress  i = 424 out of 939flct: progress  i = 425 out of 939flct: progress  i = 426 out of 939flct: progress  i = 427 out of 939flct: progress  i = 428 out of 939flct: progress  i = 429 out of 939flct: progress  i = 430 out of 939flct: progress  i = 431 out of 939flct: progress  i = 432 out of 939flct: progress  i = 433 out of 939flct: progress  i = 434 out of 939flct: progress  i = 435 out of 939flct: progress  i = 436 out of 939flct: progress  i = 437 out of 939flct: progress  i = 438 out of 939flct: progress  i = 439 out of 939flct: progress  i = 440 out of 939flct: progress  i = 441 out of 939flct: progress  i = 442 out of 939flct: progress  i = 443 out of 939flct: progress  i = 444 out of 939flct: progress  i = 445 out of 939flct: progress  i = 446 out of 939flct: progress  i = 447 out of 939flct: progress  i = 448 out of 939flct: progress  i = 449 out of 939flct: progress  i = 450 out of 939flct: progress  i = 451 out of 939flct: progress  i = 452 out of 939flct: progress  i = 453 out of 939flct: progress  i = 454 out of 939flct: progress  i = 455 out of 939flct: progress  i = 456 out of 939flct: progress  i = 457 out of 939flct: progress  i = 458 out of 939flct: progress  i = 459 out of 939flct: progress  i = 460 out of 939flct: progress  i = 461 out of 939flct: progress  i = 462 out of 939flct: progress  i = 463 out of 939flct: progress  i = 464 out of 939flct: progress  i = 465 out of 939flct: progress  i = 466 out of 939flct: progress  i = 467 out of 939flct: progress  i = 468 out of 939flct: progress  i = 469 out of 939flct: progress  i = 470 out of 939flct: progress  i = 471 out of 939flct: progress  i = 472 out of 939flct: progress  i = 473 out of 939flct: progress  i = 474 out of 939flct: progress  i = 475 out of 939flct: progress  i = 476 out of 939flct: progress  i = 477 out of 939flct: progress  i = 478 out of 939flct: progress  i = 479 out of 939flct: progress  i = 480 out of 939flct: progress  i = 481 out of 939flct: progress  i = 482 out of 939flct: progress  i = 483 out of 939flct: progress  i = 484 out of 939flct: progress  i = 485 out of 939flct: progress  i = 486 out of 939flct: progress  i = 487 out of 939flct: progress  i = 488 out of 939flct: progress  i = 489 out of 939flct: progress  i = 490 out of 939flct: progress  i = 491 out of 939flct: progress  i = 492 out of 939flct: progress  i = 493 out of 939flct: progress  i = 494 out of 939flct: progress  i = 495 out of 939flct: progress  i = 496 out of 939flct: progress  i = 497 out of 939flct: progress  i = 498 out of 939flct: progress  i = 499 out of 939flct: progress  i = 500 out of 939flct: progress  i = 501 out of 939flct: progress  i = 502 out of 939flct: progress  i = 503 out of 939flct: progress  i = 504 out of 939flct: progress  i = 505 out of 939flct: progress  i = 506 out of 939flct: progress  i = 507 out of 939flct: progress  i = 508 out of 939flct: progress  i = 509 out of 939flct: progress  i = 510 out of 939flct: progress  i = 511 out of 939flct: progress  i = 512 out of 939flct: progress  i = 513 out of 939flct: progress  i = 514 out of 939flct: progress  i = 515 out of 939flct: progress  i = 516 out of 939flct: progress  i = 517 out of 939flct: progress  i = 518 out of 939flct: progress  i = 519 out of 939flct: progress  i = 520 out of 939flct: progress  i = 521 out of 939flct: progress  i = 522 out of 939flct: progress  i = 523 out of 939flct: progress  i = 524 out of 939flct: progress  i = 525 out of 939flct: progress  i = 526 out of 939flct: progress  i = 527 out of 939flct: progress  i = 528 out of 939flct: progress  i = 529 out of 939flct: progress  i = 530 out of 939flct: progress  i = 531 out of 939flct: progress  i = 532 out of 939flct: progress  i = 533 out of 939flct: progress  i = 534 out of 939flct: progress  i = 535 out of 939flct: progress  i = 536 out of 939flct: progress  i = 537 out of 939flct: progress  i = 538 out of 939flct: progress  i = 539 out of 939flct: progress  i = 540 out of 939flct: progress  i = 541 out of 939flct: progress  i = 542 out of 939flct: progress  i = 543 out of 939flct: progress  i = 544 out of 939flct: progress  i = 545 out of 939flct: progress  i = 546 out of 939flct: progress  i = 547 out of 939flct: progress  i = 548 out of 939flct: progress  i = 549 out of 939flct: progress  i = 550 out of 939flct: progress  i = 551 out of 939flct: progress  i = 552 out of 939flct: progress  i = 553 out of 939flct: progress  i = 554 out of 939flct: progress  i = 555 out of 939flct: progress  i = 556 out of 939flct: progress  i = 557 out of 939flct: progress  i = 558 out of 939flct: progress  i = 559 out of 939flct: progress  i = 560 out of 939flct: progress  i = 561 out of 939flct: progress  i = 562 out of 939flct: progress  i = 563 out of 939flct: progress  i = 564 out of 939flct: progress  i = 565 out of 939flct: progress  i = 566 out of 939flct: progress  i = 567 out of 939flct: progress  i = 568 out of 939flct: progress  i = 569 out of 939flct: progress  i = 570 out of 939flct: progress  i = 571 out of 939flct: progress  i = 572 out of 939flct: progress  i = 573 out of 939flct: progress  i = 574 out of 939flct: progress  i = 575 out of 939flct: progress  i = 576 out of 939flct: progress  i = 577 out of 939flct: progress  i = 578 out of 939flct: progress  i = 579 out of 939flct: progress  i = 580 out of 939flct: progress  i = 581 out of 939flct: progress  i = 582 out of 939flct: progress  i = 583 out of 939flct: progress  i = 584 out of 939flct: progress  i = 585 out of 939flct: progress  i = 586 out of 939flct: progress  i = 587 out of 939flct: progress  i = 588 out of 939flct: progress  i = 589 out of 939flct: progress  i = 590 out of 939flct: progress  i = 591 out of 939flct: progress  i = 592 out of 939flct: progress  i = 593 out of 939flct: progress  i = 594 out of 939flct: progress  i = 595 out of 939flct: progress  i = 596 out of 939flct: progress  i = 597 out of 939flct: progress  i = 598 out of 939flct: progress  i = 599 out of 939flct: progress  i = 600 out of 939flct: progress  i = 601 out of 939flct: progress  i = 602 out of 939flct: progress  i = 603 out of 939flct: progress  i = 604 out of 939flct: progress  i = 605 out of 939flct: progress  i = 606 out of 939flct: progress  i = 607 out of 939flct: progress  i = 608 out of 939flct: progress  i = 609 out of 939flct: progress  i = 610 out of 939flct: progress  i = 611 out of 939flct: progress  i = 612 out of 939flct: progress  i = 613 out of 939flct: progress  i = 614 out of 939flct: progress  i = 615 out of 939flct: progress  i = 616 out of 939flct: progress  i = 617 out of 939flct: progress  i = 618 out of 939flct: progress  i = 619 out of 939flct: progress  i = 620 out of 939flct: progress  i = 621 out of 939flct: progress  i = 622 out of 939flct: progress  i = 623 out of 939flct: progress  i = 624 out of 939flct: progress  i = 625 out of 939flct: progress  i = 626 out of 939flct: progress  i = 627 out of 939flct: progress  i = 628 out of 939flct: progress  i = 629 out of 939flct: progress  i = 630 out of 939flct: progress  i = 631 out of 939flct: progress  i = 632 out of 939flct: progress  i = 633 out of 939flct: progress  i = 634 out of 939flct: progress  i = 635 out of 939flct: progress  i = 636 out of 939flct: progress  i = 637 out of 939flct: progress  i = 638 out of 939flct: progress  i = 639 out of 939flct: progress  i = 640 out of 939flct: progress  i = 641 out of 939flct: progress  i = 642 out of 939flct: progress  i = 643 out of 939flct: progress  i = 644 out of 939flct: progress  i = 645 out of 939flct: progress  i = 646 out of 939flct: progress  i = 647 out of 939flct: progress  i = 648 out of 939flct: progress  i = 649 out of 939flct: progress  i = 650 out of 939flct: progress  i = 651 out of 939flct: progress  i = 652 out of 939flct: progress  i = 653 out of 939flct: progress  i = 654 out of 939flct: progress  i = 655 out of 939flct: progress  i = 656 out of 939flct: progress  i = 657 out of 939flct: progress  i = 658 out of 939flct: progress  i = 659 out of 939flct: progress  i = 660 out of 939flct: progress  i = 661 out of 939flct: progress  i = 662 out of 939flct: progress  i = 663 out of 939flct: progress  i = 664 out of 939flct: progress  i = 665 out of 939flct: progress  i = 666 out of 939flct: progress  i = 667 out of 939flct: progress  i = 668 out of 939flct: progress  i = 669 out of 939flct: progress  i = 670 out of 939flct: progress  i = 671 out of 939flct: progress  i = 672 out of 939flct: progress  i = 673 out of 939flct: progress  i = 674 out of 939flct: progress  i = 675 out of 939flct: progress  i = 676 out of 939flct: progress  i = 677 out of 939flct: progress  i = 678 out of 939flct: progress  i = 679 out of 939flct: progress  i = 680 out of 939flct: progress  i = 681 out of 939flct: progress  i = 682 out of 939flct: progress  i = 683 out of 939flct: progress  i = 684 out of 939flct: progress  i = 685 out of 939flct: progress  i = 686 out of 939flct: progress  i = 687 out of 939flct: progress  i = 688 out of 939flct: progress  i = 689 out of 939flct: progress  i = 690 out of 939flct: progress  i = 691 out of 939flct: progress  i = 692 out of 939flct: progress  i = 693 out of 939flct: progress  i = 694 out of 939flct: progress  i = 695 out of 939flct: progress  i = 696 out of 939flct: progress  i = 697 out of 939flct: progress  i = 698 out of 939flct: progress  i = 699 out of 939flct: progress  i = 700 out of 939flct: progress  i = 701 out of 939flct: progress  i = 702 out of 939flct: progress  i = 703 out of 939flct: progress  i = 704 out of 939flct: progress  i = 705 out of 939flct: progress  i = 706 out of 939flct: progress  i = 707 out of 939flct: progress  i = 708 out of 939flct: progress  i = 709 out of 939flct: progress  i = 710 out of 939flct: progress  i = 711 out of 939flct: progress  i = 712 out of 939flct: progress  i = 713 out of 939flct: progress  i = 714 out of 939flct: progress  i = 715 out of 939flct: progress  i = 716 out of 939flct: progress  i = 717 out of 939flct: progress  i = 718 out of 939flct: progress  i = 719 out of 939flct: progress  i = 720 out of 939flct: progress  i = 721 out of 939flct: progress  i = 722 out of 939flct: progress  i = 723 out of 939flct: progress  i = 724 out of 939flct: progress  i = 725 out of 939flct: progress  i = 726 out of 939flct: progress  i = 727 out of 939flct: progress  i = 728 out of 939flct: progress  i = 729 out of 939flct: progress  i = 730 out of 939flct: progress  i = 731 out of 939flct: progress  i = 732 out of 939flct: progress  i = 733 out of 939flct: progress  i = 734 out of 939flct: progress  i = 735 out of 939flct: progress  i = 736 out of 939flct: progress  i = 737 out of 939flct: progress  i = 738 out of 939flct: progress  i = 739 out of 939flct: progress  i = 740 out of 939flct: progress  i = 741 out of 939flct: progress  i = 742 out of 939flct: progress  i = 743 out of 939flct: progress  i = 744 out of 939flct: progress  i = 745 out of 939flct: progress  i = 746 out of 939flct: progress  i = 747 out of 939flct: progress  i = 748 out of 939flct: progress  i = 749 out of 939flct: progress  i = 750 out of 939flct: progress  i = 751 out of 939flct: progress  i = 752 out of 939flct: progress  i = 753 out of 939flct: progress  i = 754 out of 939flct: progress  i = 755 out of 939flct: progress  i = 756 out of 939flct: progress  i = 757 out of 939flct: progress  i = 758 out of 939flct: progress  i = 759 out of 939flct: progress  i = 760 out of 939flct: progress  i = 761 out of 939flct: progress  i = 762 out of 939flct: progress  i = 763 out of 939flct: progress  i = 764 out of 939flct: progress  i = 765 out of 939flct: progress  i = 766 out of 939flct: progress  i = 767 out of 939flct: progress  i = 768 out of 939flct: progress  i = 769 out of 939flct: progress  i = 770 out of 939flct: progress  i = 771 out of 939flct: progress  i = 772 out of 939flct: progress  i = 773 out of 939flct: progress  i = 774 out of 939flct: progress  i = 775 out of 939flct: progress  i = 776 out of 939flct: progress  i = 777 out of 939flct: progress  i = 778 out of 939flct: progress  i = 779 out of 939flct: progress  i = 780 out of 939flct: progress  i = 781 out of 939flct: progress  i = 782 out of 939flct: progress  i = 783 out of 939flct: progress  i = 784 out of 939flct: progress  i = 785 out of 939flct: progress  i = 786 out of 939flct: progress  i = 787 out of 939flct: progress  i = 788 out of 939flct: progress  i = 789 out of 939flct: progress  i = 790 out of 939flct: progress  i = 791 out of 939flct: progress  i = 792 out of 939flct: progress  i = 793 out of 939flct: progress  i = 794 out of 939flct: progress  i = 795 out of 939flct: progress  i = 796 out of 939flct: progress  i = 797 out of 939flct: progress  i = 798 out of 939flct: progress  i = 799 out of 939flct: progress  i = 800 out of 939flct: progress  i = 801 out of 939flct: progress  i = 802 out of 939flct: progress  i = 803 out of 939flct: progress  i = 804 out of 939flct: progress  i = 805 out of 939flct: progress  i = 806 out of 939flct: progress  i = 807 out of 939flct: progress  i = 808 out of 939flct: progress  i = 809 out of 939flct: progress  i = 810 out of 939flct: progress  i = 811 out of 939flct: progress  i = 812 out of 939flct: progress  i = 813 out of 939flct: progress  i = 814 out of 939flct: progress  i = 815 out of 939flct: progress  i = 816 out of 939flct: progress  i = 817 out of 939flct: progress  i = 818 out of 939flct: progress  i = 819 out of 939flct: progress  i = 820 out of 939flct: progress  i = 821 out of 939flct: progress  i = 822 out of 939flct: progress  i = 823 out of 939flct: progress  i = 824 out of 939flct: progress  i = 825 out of 939flct: progress  i = 826 out of 939flct: progress  i = 827 out of 939flct: progress  i = 828 out of 939flct: progress  i = 829 out of 939flct: progress  i = 830 out of 939flct: progress  i = 831 out of 939flct: progress  i = 832 out of 939flct: progress  i = 833 out of 939flct: progress  i = 834 out of 939flct: progress  i = 835 out of 939flct: progress  i = 836 out of 939flct: progress  i = 837 out of 939flct: progress  i = 838 out of 939flct: progress  i = 839 out of 939flct: progress  i = 840 out of 939flct: progress  i = 841 out of 939flct: progress  i = 842 out of 939flct: progress  i = 843 out of 939flct: progress  i = 844 out of 939flct: progress  i = 845 out of 939flct: progress  i = 846 out of 939flct: progress  i = 847 out of 939flct: progress  i = 848 out of 939flct: progress  i = 849 out of 939flct: progress  i = 850 out of 939flct: progress  i = 851 out of 939flct: progress  i = 852 out of 939flct: progress  i = 853 out of 939flct: progress  i = 854 out of 939flct: progress  i = 855 out of 939flct: progress  i = 856 out of 939flct: progress  i = 857 out of 939flct: progress  i = 858 out of 939flct: progress  i = 859 out of 939flct: progress  i = 860 out of 939flct: progress  i = 861 out of 939flct: progress  i = 862 out of 939flct: progress  i = 863 out of 939flct: progress  i = 864 out of 939flct: progress  i = 865 out of 939flct: progress  i = 866 out of 939flct: progress  i = 867 out of 939flct: progress  i = 868 out of 939flct: progress  i = 869 out of 939flct: progress  i = 870 out of 939flct: progress  i = 871 out of 939flct: progress  i = 872 out of 939flct: progress  i = 873 out of 939flct: progress  i = 874 out of 939flct: progress  i = 875 out of 939flct: progress  i = 876 out of 939flct: progress  i = 877 out of 939flct: progress  i = 878 out of 939flct: progress  i = 879 out of 939flct: progress  i = 880 out of 939flct: progress  i = 881 out of 939flct: progress  i = 882 out of 939flct: progress  i = 883 out of 939flct: progress  i = 884 out of 939flct: progress  i = 885 out of 939flct: progress  i = 886 out of 939flct: progress  i = 887 out of 939flct: progress  i = 888 out of 939flct: progress  i = 889 out of 939flct: progress  i = 890 out of 939flct: progress  i = 891 out of 939flct: progress  i = 892 out of 939flct: progress  i = 893 out of 939flct: progress  i = 894 out of 939flct: progress  i = 895 out of 939flct: progress  i = 896 out of 939flct: progress  i = 897 out of 939flct: progress  i = 898 out of 939flct: progress  i = 899 out of 939flct: progress  i = 900 out of 939flct: progress  i = 901 out of 939flct: progress  i = 902 out of 939flct: progress  i = 903 out of 939flct: progress  i = 904 out of 939flct: progress  i = 905 out of 939flct: progress  i = 906 out of 939flct: progress  i = 907 out of 939flct: progress  i = 908 out of 939flct: progress  i = 909 out of 939flct: progress  i = 910 out of 939flct: progress  i = 911 out of 939flct: progress  i = 912 out of 939flct: progress  i = 913 out of 939flct: progress  i = 914 out of 939flct: progress  i = 915 out of 939flct: progress  i = 916 out of 939flct: progress  i = 917 out of 939flct: progress  i = 918 out of 939flct: progress  i = 919 out of 939flct: progress  i = 920 out of 939flct: progress  i = 921 out of 939flct: progress  i = 922 out of 939flct: progress  i = 923 out of 939flct: progress  i = 924 out of 939flct: progress  i = 925 out of 939flct: progress  i = 926 out of 939flct: progress  i = 927 out of 939flct: progress  i = 928 out of 939flct: progress  i = 929 out of 939flct: progress  i = 930 out of 939flct: progress  i = 931 out of 939flct: progress  i = 932 out of 939flct: progress  i = 933 out of 939flct: progress  i = 934 out of 939flct: progress  i = 935 out of 939flct: progress  i = 936 out of 939flct: progress  i = 937 out of 939flct: progress  i = 938 out of 939flct: progress  i = 939 out of 939flct: mean value of gamma^2/sigma^2 = 0.408993

flct: finished
#+end_example

*** High-pass filtered version of the 2015 epoch WFC3 H\alpha filter

#+begin_src sh :results verbatim :dir proper-motions/data
python /Users/will/Dropbox/Teresa-Turtle/scripts/smooth-image.py hh529_wfc3_f656n_2015.fits -w 16 
#+end_src

#+RESULTS:

#+begin_src sh :results verbatim :dir proper-motions/data
python /Users/will/Dropbox/Teresa-Turtle/scripts/smooth-image.py hh529_acs_f658n_2005.fits -w 16 
#+end_src

#+RESULTS:

*** Make vector graphs of the proper motions.  

- First using the entire 20 year interval
  - The problem with this is that things move to far so we need to use a wide kernel (15 pix) and even then it doesn't pick up all the motions properly

#+begin_src python :return figfile :results file
  from pathlib import Path
  import numpy as np
  from matplotlib import pyplot as plt
  import matplotlib.patheffects as path_effects
  import seaborn as sns
  from astropy.io import fits
  from astropy.wcs import WCS

  figdir = Path("proper-motions")
  datadir = figdir / "data"

  s0 = "f656n_1996_2015"
  figfile = figdir / f"hh529_{s0}_proper_motions.jpg"

  hdu, = fits.open(datadir / "hh529_wfc3_f656n_2015_sharp_16.fits")
  w = WCS(hdu)
  im = hdu.data
  #s1, s2 = "_sharp_16", "_sig20"
  s1, s2 = "", "_sig15"
  vx = fits.open(datadir / f"hh529_{s0}{s1}_vx{s2}.fits")[0].data
  vy = fits.open(datadir / f"hh529_{s0}{s1}_vy{s2}.fits")[0].data
  vv = np.hypot(vx, vy)
  pa = np.rad2deg(np.arctan2(-vx, vy)) % 360
  fits.PrimaryHDU(
      header=hdu.header,
      data=vv,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_vv{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=pa,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_pa{s2}.fits",
      overwrite=True,
  )
  vx[abs(vv) > 12.0] = np.nan
  vx[vv < 0.2] = np.nan
  vx[(im < 1.0)] = np.nan 

  ny, nx = im.shape
  X, Y = np.meshgrid(np.arange(nx), np.arange(ny))

  fig, ax = plt.subplots(figsize=(10, 4), subplot_kw=dict(projection=w))
  ax.imshow(im, vmin=0.8, vmax=1.5, origin="lower", cmap="gray_r")
  step = slice(None, None, 4), slice(None, None, 4)
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.5, width=1.5, minshaft=2.0, color="r", alpha=1.0)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  QK = ax.quiverkey(Q, 0.05, 0.2, 8.0,
               "40 km/s", labelcolor="red",
               fontproperties=dict(size=8))
  QK.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  #ax.text(0.05, 0.95, "[O III] proper motions", color="w", transform=ax.transAxes)
  ax.set(
      xlabel="RA",
      ylabel="Dec",
      # xlim=[150, 1000],
      # ylim=[200, 550],
  )
  fig.tight_layout(rect=(0.1, 0.1, 1.0, 1.0))
  fig.savefig(figfile, dpi=1200)
#+end_src

#+RESULTS:
[[file:proper-motions/hh529_f656n_1996_2015_proper_motions.jpg]]


- Next using 10 year intervals
  - The problem this time is that the 2005 epoch is ACS, which lets in some [N II] emission
    - This does not effect the high-ionization shocks much
    - But it does produce some spurious apparent motions in the ionization fronts
  - This can be spotted as opposite motions between 1996-2005 and 2005-2015

#+begin_src python :return figfile :results file
  from pathlib import Path
  import numpy as np
  from matplotlib import pyplot as plt
  import matplotlib.patheffects as path_effects
  import seaborn as sns
  from astropy.io import fits
  from astropy.wcs import WCS

  figdir = Path("proper-motions")
  datadir = figdir / "data"

  s0 = "f656n_2005_2015"
  figfile = figdir / f"hh529_{s0}_proper_motions.jpg"

  hdu, = fits.open(datadir / "hh529_wfc3_f656n_2015_sharp_16.fits")
  w = WCS(hdu)
  im = hdu.data
  #s1, s2 = "_sharp_16", "_sig20"
  s1, s2 = "", "_sig10"
  vx = fits.open(datadir / f"hh529_{s0}{s1}_vx{s2}.fits")[0].data
  vy = fits.open(datadir / f"hh529_{s0}{s1}_vy{s2}.fits")[0].data
  vv = np.hypot(vx, vy)
  pa = np.rad2deg(np.arctan2(-vx, vy)) % 360
  fits.PrimaryHDU(
      header=hdu.header,
      data=vv,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_vv{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=pa,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_pa{s2}.fits",
      overwrite=True,
  )
  vx[abs(vv) > 6.0] = np.nan
  vx[vv < 0.1] = np.nan
  vx[(im < 1.0)] = np.nan 

  ny, nx = im.shape
  X, Y = np.meshgrid(np.arange(nx), np.arange(ny))

  fig, ax = plt.subplots(figsize=(10, 4), subplot_kw=dict(projection=w))
  ax.imshow(im, vmin=0.8, vmax=1.5, origin="lower", cmap="gray_r")
  step = slice(None, None, 4), slice(None, None, 4)
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.25, width=1.5, minshaft=2.0, color="r", alpha=1.0)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  QK = ax.quiverkey(Q, 0.05, 0.2, 8.0,
               "40 km/s", labelcolor="red",
               fontproperties=dict(size=8))
  QK.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  #ax.text(0.05, 0.95, "[O III] proper motions", color="w", transform=ax.transAxes)
  ax.set(
      xlabel="RA",
      ylabel="Dec",
      # xlim=[150, 1000],
      # ylim=[200, 550],
  )
  fig.tight_layout(rect=(0.1, 0.1, 1.0, 1.0))
  fig.savefig(figfile, dpi=1200)
#+end_src

#+RESULTS:
[[file:proper-motions/hh529_f656n_2005_2015_proper_motions.jpg]]

#+begin_src python :return figfile :results file
  from pathlib import Path
  import numpy as np
  from matplotlib import pyplot as plt
  import matplotlib.patheffects as path_effects
  import seaborn as sns
  from astropy.io import fits
  from astropy.wcs import WCS

  figdir = Path("proper-motions")
  datadir = figdir / "data"

  s0 = "f656n_1996_2005"
  figfile = figdir / f"hh529_{s0}_proper_motions.jpg"

  hdu, = fits.open(datadir / "hh529_acs_f658n_2005_sharp_16.fits")
  w = WCS(hdu)
  im = hdu.data
  #s1, s2 = "_sharp_16", "_sig20"
  s1, s2 = "", "_sig10"
  vx = fits.open(datadir / f"hh529_{s0}{s1}_vx{s2}.fits")[0].data
  vy = fits.open(datadir / f"hh529_{s0}{s1}_vy{s2}.fits")[0].data
  vv = np.hypot(vx, vy)
  pa = np.rad2deg(np.arctan2(-vx, vy)) % 360
  fits.PrimaryHDU(
      header=hdu.header,
      data=vv,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_vv{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=pa,
  ).writeto(
      datadir / f"hh529_{s0}{s1}_pa{s2}.fits",
      overwrite=True,
  )
  vx[abs(vv) > 6.0] = np.nan
  vx[vv < 0.1] = np.nan
  vx[(im < 1.0)] = np.nan 

  ny, nx = im.shape
  X, Y = np.meshgrid(np.arange(nx), np.arange(ny))

  fig, ax = plt.subplots(figsize=(10, 4), subplot_kw=dict(projection=w))
  ax.imshow(im, vmin=0.8, vmax=1.5, origin="lower", cmap="gray_r")
  step = slice(None, None, 4), slice(None, None, 4)
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.25, width=1.5, minshaft=2.0, color="r", alpha=1.0)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  QK = ax.quiverkey(Q, 0.05, 0.2, 8.0,
               "40 km/s", labelcolor="red",
               fontproperties=dict(size=8))
  QK.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  #ax.text(0.05, 0.95, "[O III] proper motions", color="w", transform=ax.transAxes)
  ax.set(
      xlabel="RA",
      ylabel="Dec",
      # xlim=[150, 1000],
      # ylim=[200, 550],
  )
  fig.tight_layout(rect=(0.1, 0.1, 1.0, 1.0))
  fig.savefig(figfile, dpi=1200)
#+end_src

#+RESULTS:
[[file:proper-motions/hh529_f656n_1996_2005_proper_motions.jpg]]

+ [X] Next thing to do: take an average of the two 10-year intervals

*** Average and dispersion the two 10-year intervals

#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS

  datadir = Path("proper-motions/data")

  hdu, = fits.open(datadir / "hh529_wfc3_f656n_2015_sharp_16.fits")

  s1, s2 = "", "_sig10"

  s_interval = "f656n_1996_2005"
  vx1 = fits.open(datadir / f"hh529_{s_interval}{s1}_vx{s2}.fits")[0].data
  vy1 = fits.open(datadir / f"hh529_{s_interval}{s1}_vy{s2}.fits")[0].data
  m = vx1 == -20.0
  vx1[m] = np.nan
  vy1[m] = np.nan

  s_interval = "f656n_2005_2015"
  vx2 = fits.open(datadir / f"hh529_{s_interval}{s1}_vx{s2}.fits")[0].data
  vy2 = fits.open(datadir / f"hh529_{s_interval}{s1}_vy{s2}.fits")[0].data

  vxstack = np.stack([vx1, vx2])
  vystack = np.stack([vy1, vy2])

  vxm = np.nanmean(vxstack, axis=0)
  vym = np.nanmean(vystack, axis=0)
  vxs = np.nanstd(vxstack, axis=0)
  vys = np.nanstd(vystack, axis=0)


  vv = np.hypot(vxm, vym)
  pa = np.rad2deg(np.arctan2(-vxm, vym)) % 360
  sigma = np.hypot(vxs, vys) / vv

  s_interval = "f656n_1996_2015_2stage"

  fits.PrimaryHDU(
      header=hdu.header,
      data=vxm,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vx_mean{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=vym,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vy_mean{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=vxs,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vx_sigma{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=vys,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vy_sigma{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=sigma,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vv_sigrel{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=vv,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_vv{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=pa,
  ).writeto(
      datadir / f"hh529_{s_interval}{s1}_pa{s2}.fits",
      overwrite=True,
  )

#+end_src

#+RESULTS:
: None

+ Now do a better figure with the arrows.
  + We can take into account the relative sigma

#+begin_src python :return figfile :results file
  from pathlib import Path
  import numpy as np
  from matplotlib import pyplot as plt
  import matplotlib.patheffects as path_effects
  import seaborn as sns
  from astropy.io import fits
  from astropy.wcs import WCS

  figdir = Path("proper-motions")
  datadir = figdir / "data"

  s0 = "f656n_1996_2015_2stage"
  figfile = figdir / f"hh529_{s0}_proper_motions.jpg"

  hdu, = fits.open(datadir / "hh529_wfc3_f656n_2015_sharp_16.fits")
  w = WCS(hdu)
  im = hdu.data
  #s1, s2 = "_sharp_16", "_sig20"
  s1, s2 = "", "_sig10"
  vx = fits.open(datadir / f"hh529_{s0}{s1}_vx_mean{s2}.fits")[0].data
  vy = fits.open(datadir / f"hh529_{s0}{s1}_vy_mean{s2}.fits")[0].data
  sig = fits.open(datadir / f"hh529_{s0}{s1}_vv_sigrel{s2}.fits")[0].data
  vv = np.hypot(vx, vy)
  pa = np.rad2deg(np.arctan2(-vx, vy)) % 360


  vx[abs(vv) > 6.0] = np.nan
  vx[vv < 0.1] = np.nan
  vx[(im < 1.0)] = np.nan 
  vx[(sig > 0.75)] = np.nan 


  ny, nx = im.shape
  X, Y = np.meshgrid(np.arange(nx), np.arange(ny))


  fig, ax = plt.subplots(figsize=(10, 4), subplot_kw=dict(projection=w))
  ax.imshow(im, vmin=0.8, vmax=1.5, origin="lower", cmap="gray_r")
  step = slice(2, None, 5), slice(3, None, 5)
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.125, width=1.5, minshaft=2.0, color="orange", alpha=0.7)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='orange', capstyle="projecting", alpha=0.7
          ),
      ]
  )
  vx[(sig == 0.0)] = np.nan
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.125, width=1.5, minshaft=2.0, color="r", alpha=1.0)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  QK = ax.quiverkey(Q, 0.05, 0.2, 4.0,
               "40 km/s", labelcolor="red",
               fontproperties=dict(size=8))
  QK.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  #ax.text(0.05, 0.95, "[O III] proper motions", color="w", transform=ax.transAxes)
  ax.set(
      xlabel="RA",
      ylabel="Dec",
       xlim=[200, 1500],
       ylim=[100, 900],
  )
  fig.tight_layout(rect=(0.1, 0.1, 1.0, 1.0))
  fig.savefig(figfile, dpi=1200)
#+end_src

#+RESULTS:
[[file:proper-motions/hh529_f656n_1996_2015_2stage_proper_motions.jpg]]


*** Make some ratio images
This is a lot easier than what we have been doing, and it might be useful

#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS

  datadir = Path("proper-motions/data")


  hdu1, = fits.open(datadir / "hh529_wfpc2_f656n_1996.fits")
  hdu2, = fits.open(datadir / "hh529_acs_f658n_2005.fits")
  hdu3, = fits.open(datadir / "hh529_wfc3_f656n_2015.fits")


  fits.PrimaryHDU(
      header=hdu3.header,
      data=hdu3.data/hdu2.data,
  ).writeto(
      datadir / f"hh529_f656n_ratio_2015_2005.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu2.header,
      data=hdu2.data/hdu1.data,
  ).writeto(
      datadir / f"hh529_f656n_ratio_2005_1996.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu3.header,
      data=hdu3.data/hdu1.data,
  ).writeto(
      datadir / f"hh529_f656n_ratio_2015_1996.fits",
      overwrite=True,
  )
#+end_src

#+RESULTS:
: None



*** Measure the per-feature motions in HH 529-III and II
+ Define regions in DS9
  + [[file:proper-motions/HH529-samples.reg]]
  + Ellipses are regions we measure PM
  + Dashed boxes are for background brightness measurements
+ [ ] Eventually I should repeat for HH 529-I, HH 529-East, and HH 1149, etc
+ Plan is to calculate weighted average of V and PA for each region
+ Weighting by BG-subtracted brightness
+ We can do it separately for the 1996-2005 and 2005-2015 intervals, where available
+ This only works because the WCS is the same for all the images
#+begin_src python :return display
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS
  from astropy.table import Table
  import regions as rg

  regiondir = Path("proper-motions")
  datadir = regiondir / "data"
  regions = rg.read_ds9(regiondir / "HH529-samples.reg")

  # Split into BG and source regions
  source_regions = []
  bg_regions = {}
  for region in regions:
      label = region.meta["label"]
      if "BG" in label:
          # BG samples are grouped into II, III, etc
          bg_group = label.split()[0]
          if bg_group not in bg_regions:
              bg_regions[bg_group] = []
          bg_regions[bg_group].append(region)
      else:
          source_regions.append(region)

  hdu2015, = fits.open(datadir / "hh529_wfc3_f656n_2015.fits")
  w = WCS(hdu2015.header)
  badmask = ~np.isfinite(hdu2015.data)
  hdu2015.data[badmask] = 0.0

  data_images = {
      # "VV 96->05": fits.open(datadir / "hh529_f656n_1996_2005_vv_sig10.fits")[0].data, 
      # "PA 96->05": fits.open(datadir / "hh529_f656n_1996_2005_pa_sig10.fits")[0].data, 
      # "VV 05->15": fits.open(datadir / "hh529_f656n_2005_2015_vv_sig10.fits")[0].data, 
      # "PA 05->15": fits.open(datadir / "hh529_f656n_2005_2015_pa_sig10.fits")[0].data, 
      "VV": fits.open(datadir / "hh529_f656n_1996_2015_2stage_vv_sig10.fits")[0].data,
      "PA": fits.open(datadir / "hh529_f656n_1996_2015_2stage_pa_sig10.fits")[0].data,
  }

  # Find mean brightness BG for each group
  bg_brightness = {}
  for bg_group, bgrs in bg_regions.items():
      weights = np.zeros_like(hdu2015.data)
      for r in bgrs:
          weights += r.to_pixel(w).to_mask().to_image(hdu2015.data.shape)
      bg_brightness[bg_group] = np.average(hdu2015.data, weights=weights)

  # Now do measurements on each source region
  all_results = []
  for region in source_regions:
      label = region.meta["label"]
      group = label.split()[0]
      bg = bg_brightness[group]
      results = {"region": label}
      mask = region.to_pixel(w).to_mask()
      mw = mask.to_image(hdu2015.data.shape).astype(bool)
      weights = hdu2015.data[mw] - bg
      results["Bright"] = np.round(np.mean(weights), 2)
      results["Bright sig"] = np.round(np.std(weights), 2)
      results["Bright BG"] = np.round(bg, 2)
      for data_label, data in data_images.items():
          m = mask.to_image(data.shape).astype(bool)
          mean = np.average(data[m], weights=weights)
          sigma = np.sqrt(np.average((data[m] - mean)**2, weights=weights))
          results[data_label] = np.round(mean, 2)
          results[f"{data_label} sig"] = np.round(sigma, 2)
      all_results.append(results)

  #
  # List of dicts to astropy.table.Table
  #
  # It would be cleaner to just write Table(rows=all_results) but for
  # some reason that does alphabetical sorting on column names, which we
  # don't want.  This way preserves the column order.
  table = Table(
      names=all_results[0].keys(),
      rows=[_.values() for _ in all_results],
  )

  #
  # astropy.table.Table to a list of lists, which babel will format as
  # an org table
  #
  display = [list(table.colnames), None] + [list(row) for row in table]
#+end_src

#+RESULTS:
| region           | Bright | Bright sig | Bright BG |   VV | VV sig |     PA | PA sig |
|------------------+--------+------------+-----------+------+--------+--------+--------|
| III knot         |  13.47 |       1.21 |     11.85 | 2.67 |   0.03 | 129.84 |    0.9 |
| III knot N       |   11.2 |       1.06 |     11.85 | 2.98 |   0.17 | 104.75 |    3.3 |
| III knot S       |   7.57 |       0.82 |     11.85 | 3.03 |   0.23 |  124.9 |   4.24 |
| III apex         |    9.7 |        1.3 |     11.85 | 3.56 |    0.1 | 106.79 |   6.79 |
| III apex N       |   5.49 |       1.69 |     11.85 | 3.33 |   0.34 |  90.18 |   3.18 |
| III apex S       |   6.18 |       1.61 |     11.85 | 3.16 |   0.14 | 117.18 |   3.12 |
| III lower wing   |    4.8 |       0.88 |     11.85 | 3.92 |   0.19 | 136.86 |   4.63 |
| III lower wing S |   3.16 |       0.87 |     11.85 | 3.15 |   0.12 | 151.74 |  10.23 |
| II a             |    3.3 |       0.46 |      13.2 | 2.09 |   0.93 | 117.04 |  58.35 |
| II c             |   2.91 |       0.42 |      13.2 | 3.52 |   0.86 | 151.16 |  87.38 |
| II b             |   4.62 |       1.05 |      13.2 | 2.58 |   0.51 | 107.14 |   4.44 |

|     PA | PA + 90 |
|--------+---------|
| 129.84 |  219.84 |
| 104.75 |  194.75 |
|  124.9 |  214.90 |
| 106.79 |  196.79 |
|  90.18 |  180.18 |
| 117.18 |  207.18 |
| 136.86 |  226.86 |
| 151.74 |  241.74 |
| 117.04 |  207.04 |
| 151.16 |  241.16 |
| 107.14 |  197.14 |
#+TBLFM: $2=$1 + 90;%.2f

I have now renamed these features for the figure.
| region           | new name      | Bright | Bright sig | Bright BG |   VV | VV sig |     PA | PA sig | Rel Bright    |
|------------------+---------------+--------+------------+-----------+------+--------+--------+--------+---------------|
| III knot         | HH 529 III b2 |  13.47 |       1.21 |     11.85 | 2.67 |   0.03 | 129.84 |    0.9 | 1.14 +/- 0.10 |
| III knot N       | HH 529 III b1 |   11.2 |       1.06 |     11.85 | 2.98 |   0.17 | 104.75 |    3.3 | 0.95 +/- 0.09 |
| III knot S       | HH 529 III b3 |   7.57 |       0.82 |     11.85 | 3.03 |   0.23 |  124.9 |   4.24 | 0.64 +/- 0.07 |
| III apex         | HH 529 III a2 |    9.7 |        1.3 |     11.85 | 3.56 |    0.1 | 106.79 |   6.79 | 0.82 +/- 0.11 |
| III apex N       | HH 529 III a1 |   5.49 |       1.69 |     11.85 | 3.33 |   0.34 |  90.18 |   3.18 | 0.46 +/- 0.14 |
| III apex S       | HH 529 III a3 |   6.18 |       1.61 |     11.85 | 3.16 |   0.14 | 117.18 |   3.12 | 0.52 +/- 0.14 |
| III lower wing   | HH 529 III a4 |    4.8 |       0.88 |     11.85 | 3.92 |   0.19 | 136.86 |   4.63 | 0.41 +/- 0.07 |
| III lower wing S | HH 529 III a5 |   3.16 |       0.87 |     11.85 | 3.15 |   0.12 | 151.74 |  10.23 | 0.27 +/- 0.07 |
| II a             | HH 529 II a   |    3.3 |       0.46 |      13.2 | 2.09 |   0.93 | 117.04 |  58.35 | 0.25 +/- 0.03 |
| II c             | HH 529 II c   |   2.91 |       0.42 |      13.2 | 3.52 |   0.86 | 151.16 |  87.38 | 0.22 +/- 0.03 |
| II b             | HH 529 II b   |   4.62 |       1.05 |      13.2 | 2.58 |   0.51 | 107.14 |   4.44 | 0.35 +/- 0.08 |
#+TBLFM: $10=($3 +/- $4)/$5;f2

And a version for exporting to latex
| Region        | VV     | PA        | Rel Bright  |
|---------------+--------+-----------+-------------|
| HH 529 III b1 | 30 \pm 2 | 105  \pm 3  | 0.95 \pm 0.09 |
| HH 529 III b2 | 27 \pm 1 | 130  \pm 1  | 1.14 \pm 0.10 |
| HH 529 III b3 | 30 \pm 2 | 125  \pm 4  | 0.64 \pm 0.07 |
| HH 529 III a1 | 33 \pm 3 | 90  \pm  3  | 0.46 \pm 0.14 |
| HH 529 III a2 | 36 \pm 1 | 107 \pm 7   | 0.82 \pm 0.11 |
| HH 529 III a3 | 32 \pm 1 | 117  \pm  3 | 0.52 \pm 0.14 |
| HH 529 III a4 | 39 \pm 2 | 137  \pm  5 | 0.41 \pm 0.07 |
| HH 529 III a5 | 32 \pm 1 | 152  \pm 10 | 0.27 \pm 0.07 |
| HH 529 II a   | 21 \pm 9 | 117  \pm 58 | 0.25 \pm 0.03 |
| HH 529 II b   | 26 \pm 5 | 107  \pm  4 | 0.35 \pm 0.08 |
| HH 529 II c   | 35 \pm 9 | 151  \pm 87 | 0.22 \pm 0.03 |




*** Which proper motion features are in the UVIS slit
1. HH 529 III a2
   - V = 36 +/- 1 km/s
   - PA = 107 +/- 7 deg
   - contrast = 0.82 +/- 0.11
2. HH 529 III b1
   - V = 30 +/- 2 km/s
   - PA = 105 +/- 3 deg
   - contrast = 0.95 +/- 0.09
3. HH 529 II a
   - V = 21 +/- 9 km/s
   - PA = 120 +/- 50 deg
   - contrast = 0.25 +/- 0.03
4. HH 529 II b
   - V = 26 +/- 5 km/s
   - PA = 107 +/- 4 km/s
   - contrast = 0.35 +/- 0.08
*** Comparison with radial velocities
+ HH 529 II is the most straightforward, since the components are narrow
  + Suggesting either bullets are internal working surfaces
  + II a has an extent on the [Fe III] PV array of Fig 2e of [-40, -20] km/s
    + Thermal broadening should be negligible (3 km/s) and instrumental width is 6.5 km/s
    + So the corrected FWZI is sqrt(20**2 - 6.5**2 - 3**2) = 18.5 km/s, which should be the working surface speed relative to the upstream gas
    + The average Vhel is -30 km/s, which gives Vr = -57 km/s
    + Proper motion gives Vt = 21 +/- 9 km/s, so V = 61 km/s and inc = arctan2(-57, 21 +/- 9) = -70 +/- 8 deg
  + II b has Vhel in range [-25, -45]
    + V_WS - V_us = 18.5
    + Average Vhel = -35 => Vr = -62
    + Vt = 26 +/- 5 => V = -67 km/s and inc = -67 +/- 4
+ HH 529 III is a combination of a2 and b1 in the spectrum
  + a2 is part of the bow shock
  + whereas b1 may be something different
  + To start with, analyse them as a single entity
    + the fact that it goes down to near-systemic velocities suggests it is a terminal bow
    + highest velocity is -45 km/s => Vr = -72 km/s
    + Average Vt = 33 km/s
    + If we used
      + Vmax = V 0.5 (1 + sin i)
      + Vt = V cos i
      + Vmax/Vt = r = 0.5 (seci + tan i)
        + 2r - tan i = sec i
        + 4r^2 + tan^2 i - 4 r tan i = 1 + tan^2 i
        + tan i = (4r^2 - 1)/4r = r - 1/4r
      + r = 72/(33 +/- 3) = 2.18 +/- 0.20 =>  r - 1/4r = 2.07 +/- 0.20 => inc = 64 +/- 2 deg
      + V = 72 / 0.5 (1 + sin(64 +/- 2)) = 75.8 +/- 0.6  km/s
      + Alternative V = (33 +/- 3) / cos(64 +/- 2) = 75.3 +/- 0.7  - close enough
    + But this means that we should get a most red-shifted velocity of Vr = V 0.5 (sin i - 1) = -0.05 V = 4 km/s
      + This would mean Vhel = +30 km/s
      + This would be hard to see - maybe there is evidence in [O I]
  + Alternatively, we could suppose that the most redshifted velocity is actually Vhel = 0
    + Suggested at least for III b1 from the spectrum
    + This would give V_WS - V_us = 45 km/s
    + Average Vhel = -23 km/s => Vr = -50 km/s
    + Vt = 30 +/- 2 km/s => V = 58 +/- 3 km/s
      + Implying upstream V = 13 km/s
    + inc = arctan2(-50, 30) = -59 deg
  + Going back,
    + 0.5 (1 + sin(i)) V = 0.93 45 = 42 km/s
    + 0.5 (-1 + sin(i)) V = -0.07 45 = -3 km/s
    + This implies that the rest frame of upstream is Vr = +3 km/s, which is -30 km/s wrt systemic
    + I don't quite understand this, but lets carry on
  + If that was at the same angle (60 deg), then upstream V = 30 / sin(60) = 35 km/s
    + So Vt = 35 cos(60) = 17.5 km/s
    + This would be a prediction for III a2 but we actually have 36 km/s! 

** ACS 10-year interval
*** Fix the WCS of epoch 2
+ Center on the star that is superimposed on HH 529-III
  + CRPIX1, CRPIX2 = 4060.407, 4230.3817
  + CRVAL1, CRVAL2 = 83.820644, -5.3998766
+ Extract a region around HH529 and save both epochs with the same image pixels
  + Use ~reproject~ for this
+ First extract a more manageable window of the 2005 image
#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS

  datadir = Path("../Orion-HH-data/ACS")

  # Corners of window to extract from image
  xmin, xmax, ymin, ymax = 7324, 10724, 2787, 5717
  rect = slice(ymin, ymax), slice(xmin, xmax)

  # Big file from Robberto 2005 program
  hdu0 = fits.open(datadir / "hlsp_orion_hst_acs_strip0l_f775w_v1_drz.fits")["SCI"]
  # Fix stupid SIP keywords that shouldn't be there
  bad_kwds = [_ for _ in hdu0.header if _[:2] in ("A_", "B_")]
  for kwd in bad_kwds:
      hdu0.header.remove(kwd)
  # Now we are ready to create the WCS
  w = WCS(hdu0.header)

  outdir = Path("proper-motions/data")
  fits.PrimaryHDU(
      data=hdu0.data[rect],
      header=w.slice(rect).to_header(),
  ).writeto(
      outdir / "hh529_acs_f775w_2005.fits",
      overwrite=True,
  )


#+end_src

#+RESULTS:
: None
+ Next reproject the 2015 image to 2005 grid
#+begin_src python
  from pathlib import Path
  import numpy as np
  from astropy.io import fits
  from astropy.wcs import WCS
  from reproject import reproject_interp

  datadir = Path("proper-motions/data")
  bigdatadir = Path("../Orion-HH-data/ACS")

  # Orig file from Robberto 2015 program
  hdu2 = fits.open(bigdatadir / "hst_13826_06_acs_wfc_f775w_drz.fits")["SCI"]
  # Align on the star that is projected onto HH 529-III
  hdu2.header["CRPIX1"] = 4060.407
  hdu2.header["CRPIX2"] = 4230.3817
  hdu2.header["CRVAL1"] = 83.820644
  hdu2.header["CRVAL2"] = -5.3998766

  # Cropped file from Robberto 2005 program
  hdu1, = fits.open(datadir / "hh529_acs_f775w_2005.fits")

  # Reproject 2->1
  newdata, _ = reproject_interp(hdu2, hdu1.header)
  newheader = hdu2.header.copy()
  newheader.update(WCS(hdu1.header).to_header())

  fits.PrimaryHDU(
      data=newdata,
      header=newheader,
  ).writeto(
      datadir / "hh529_acs_f775w_2015.fits",
      overwrite=True,
  )

#+end_src

#+RESULTS:
: None

+ And use FLCT to calculate proper motions
#+begin_src python :results output
  import sys
  sys.path.append("../../Source/pyflct")
  import os
  from pathlib import Path
  import numpy as np
  import pyflct
  from astropy.io import fits
  from astropy.wcs import WCS

  os.environ["PATH"] = ":".join((os.environ["PATH"], "/Users/will/.local/bin"))
  datadir = Path("proper-motions/data")

  h1, = fits.open(datadir / "hh529_acs_f775w_2005.fits")
  h2, = fits.open(datadir / "hh529_acs_f775w_2015.fits")
  # Mask out pixels that are star/diffraction/bleed
  thresh = 80.0
  m = (h1.data > thresh) | (h2.data > thresh)
  # Set first epoch equal to second there
  h1.data[m] = h2.data[m]

  data_scale = h1.data.max()
  sigma = 10.0
  vx, vy, vm = pyflct.flct(h1.data.T, h2.data.T,
                           deltat=1.0, deltas=1.0, sigma=sigma,
                           thresh=0.1/data_scale,
  )
  vx[vm==0] = np.nan
  vy[vm==0] = np.nan

  fits.PrimaryHDU(
      header=h1.header,
      data=vx.T,
  ).writeto(datadir / f"hh529_acs_f775w_vx_sig{int(sigma):02d}.fits", overwrite=True)

  fits.PrimaryHDU(
      header=h1.header,
      data=vy.T,
  ).writeto(datadir / f"hh529_acs_f775w_vy_sig{int(sigma):02d}.fits", overwrite=True)
#+end_src

#+RESULTS:
#+begin_example
flct: Version 1.07     Copyright: 2007-2018 University of California
flct: small endian machine; i/o will be byteswapped
flct: infile = testin.dat
flct: outfile = testout.dat
flct: column major order assumed for data arrays
flct: deltat = 1
flct: deltas = 1
flct: sigma = 10
flct: threshold image value for LCT is 1e-05
flct: bias correction not enabled
flct: complex.h is not included
flct: from input file, nx = 2200, ny = 930
flct: nominal sliding box size = 40
flct: relative threshold in abs. units = 0.0957424
flct: progress  i = 0 out of 929flct: progress  i = 1 out of 929flct: progress  i = 2 out of 929flct: progress  i = 3 out of 929flct: progress  i = 4 out of 929flct: progress  i = 5 out of 929flct: progress  i = 6 out of 929flct: progress  i = 7 out of 929flct: progress  i = 8 out of 929flct: progress  i = 9 out of 929flct: progress  i = 10 out of 929flct: progress  i = 11 out of 929flct: progress  i = 12 out of 929flct: progress  i = 13 out of 929flct: progress  i = 14 out of 929flct: progress  i = 15 out of 929flct: progress  i = 16 out of 929flct: progress  i = 17 out of 929flct: progress  i = 18 out of 929flct: progress  i = 19 out of 929flct: progress  i = 20 out of 929flct: progress  i = 21 out of 929flct: progress  i = 22 out of 929flct: progress  i = 23 out of 929flct: progress  i = 24 out of 929flct: progress  i = 25 out of 929flct: progress  i = 26 out of 929flct: progress  i = 27 out of 929flct: progress  i = 28 out of 929flct: progress  i = 29 out of 929flct: progress  i = 30 out of 929flct: progress  i = 31 out of 929flct: progress  i = 32 out of 929flct: progress  i = 33 out of 929flct: progress  i = 34 out of 929flct: progress  i = 35 out of 929flct: progress  i = 36 out of 929flct: progress  i = 37 out of 929flct: progress  i = 38 out of 929flct: progress  i = 39 out of 929flct: progress  i = 40 out of 929flct: progress  i = 41 out of 929flct: progress  i = 42 out of 929flct: progress  i = 43 out of 929flct: progress  i = 44 out of 929flct: progress  i = 45 out of 929flct: progress  i = 46 out of 929flct: progress  i = 47 out of 929flct: progress  i = 48 out of 929flct: progress  i = 49 out of 929flct: progress  i = 50 out of 929flct: progress  i = 51 out of 929flct: progress  i = 52 out of 929flct: progress  i = 53 out of 929flct: progress  i = 54 out of 929flct: progress  i = 55 out of 929flct: progress  i = 56 out of 929flct: progress  i = 57 out of 929flct: progress  i = 58 out of 929flct: progress  i = 59 out of 929flct: progress  i = 60 out of 929flct: progress  i = 61 out of 929flct: progress  i = 62 out of 929flct: progress  i = 63 out of 929flct: progress  i = 64 out of 929flct: progress  i = 65 out of 929flct: progress  i = 66 out of 929flct: progress  i = 67 out of 929flct: progress  i = 68 out of 929flct: progress  i = 69 out of 929flct: progress  i = 70 out of 929flct: progress  i = 71 out of 929flct: progress  i = 72 out of 929flct: progress  i = 73 out of 929flct: progress  i = 74 out of 929flct: progress  i = 75 out of 929flct: progress  i = 76 out of 929flct: progress  i = 77 out of 929flct: progress  i = 78 out of 929flct: progress  i = 79 out of 929flct: progress  i = 80 out of 929flct: progress  i = 81 out of 929flct: progress  i = 82 out of 929flct: progress  i = 83 out of 929flct: progress  i = 84 out of 929flct: progress  i = 85 out of 929flct: progress  i = 86 out of 929flct: progress  i = 87 out of 929flct: progress  i = 88 out of 929flct: progress  i = 89 out of 929flct: progress  i = 90 out of 929flct: progress  i = 91 out of 929flct: progress  i = 92 out of 929flct: progress  i = 93 out of 929flct: progress  i = 94 out of 929flct: progress  i = 95 out of 929flct: progress  i = 96 out of 929flct: progress  i = 97 out of 929flct: progress  i = 98 out of 929flct: progress  i = 99 out of 929flct: progress  i = 100 out of 929flct: progress  i = 101 out of 929flct: progress  i = 102 out of 929flct: progress  i = 103 out of 929flct: progress  i = 104 out of 929flct: progress  i = 105 out of 929flct: progress  i = 106 out of 929flct: progress  i = 107 out of 929flct: progress  i = 108 out of 929flct: progress  i = 109 out of 929flct: progress  i = 110 out of 929flct: progress  i = 111 out of 929flct: progress  i = 112 out of 929flct: progress  i = 113 out of 929flct: progress  i = 114 out of 929flct: progress  i = 115 out of 929flct: progress  i = 116 out of 929flct: progress  i = 117 out of 929flct: progress  i = 118 out of 929flct: progress  i = 119 out of 929flct: progress  i = 120 out of 929flct: progress  i = 121 out of 929flct: progress  i = 122 out of 929flct: progress  i = 123 out of 929flct: progress  i = 124 out of 929flct: progress  i = 125 out of 929flct: progress  i = 126 out of 929flct: progress  i = 127 out of 929flct: progress  i = 128 out of 929flct: progress  i = 129 out of 929flct: progress  i = 130 out of 929flct: progress  i = 131 out of 929flct: progress  i = 132 out of 929flct: progress  i = 133 out of 929flct: progress  i = 134 out of 929flct: progress  i = 135 out of 929flct: progress  i = 136 out of 929flct: progress  i = 137 out of 929flct: progress  i = 138 out of 929flct: progress  i = 139 out of 929flct: progress  i = 140 out of 929flct: progress  i = 141 out of 929flct: progress  i = 142 out of 929flct: progress  i = 143 out of 929flct: progress  i = 144 out of 929flct: progress  i = 145 out of 929flct: progress  i = 146 out of 929flct: progress  i = 147 out of 929flct: progress  i = 148 out of 929flct: progress  i = 149 out of 929flct: progress  i = 150 out of 929flct: progress  i = 151 out of 929flct: progress  i = 152 out of 929flct: progress  i = 153 out of 929flct: progress  i = 154 out of 929flct: progress  i = 155 out of 929flct: progress  i = 156 out of 929flct: progress  i = 157 out of 929flct: progress  i = 158 out of 929flct: progress  i = 159 out of 929flct: progress  i = 160 out of 929flct: progress  i = 161 out of 929flct: progress  i = 162 out of 929flct: progress  i = 163 out of 929flct: progress  i = 164 out of 929flct: progress  i = 165 out of 929flct: progress  i = 166 out of 929flct: progress  i = 167 out of 929flct: progress  i = 168 out of 929flct: progress  i = 169 out of 929flct: progress  i = 170 out of 929flct: progress  i = 171 out of 929flct: progress  i = 172 out of 929flct: progress  i = 173 out of 929flct: progress  i = 174 out of 929flct: progress  i = 175 out of 929flct: progress  i = 176 out of 929flct: progress  i = 177 out of 929flct: progress  i = 178 out of 929flct: progress  i = 179 out of 929flct: progress  i = 180 out of 929flct: progress  i = 181 out of 929flct: progress  i = 182 out of 929flct: progress  i = 183 out of 929flct: progress  i = 184 out of 929flct: progress  i = 185 out of 929flct: progress  i = 186 out of 929flct: progress  i = 187 out of 929flct: progress  i = 188 out of 929flct: progress  i = 189 out of 929flct: progress  i = 190 out of 929flct: progress  i = 191 out of 929flct: progress  i = 192 out of 929flct: progress  i = 193 out of 929flct: progress  i = 194 out of 929flct: progress  i = 195 out of 929flct: progress  i = 196 out of 929flct: progress  i = 197 out of 929flct: progress  i = 198 out of 929flct: progress  i = 199 out of 929flct: progress  i = 200 out of 929flct: progress  i = 201 out of 929flct: progress  i = 202 out of 929flct: progress  i = 203 out of 929flct: progress  i = 204 out of 929flct: progress  i = 205 out of 929flct: progress  i = 206 out of 929flct: progress  i = 207 out of 929flct: progress  i = 208 out of 929flct: progress  i = 209 out of 929flct: progress  i = 210 out of 929flct: progress  i = 211 out of 929flct: progress  i = 212 out of 929flct: progress  i = 213 out of 929flct: progress  i = 214 out of 929flct: progress  i = 215 out of 929flct: progress  i = 216 out of 929flct: progress  i = 217 out of 929flct: progress  i = 218 out of 929flct: progress  i = 219 out of 929flct: progress  i = 220 out of 929flct: progress  i = 221 out of 929flct: progress  i = 222 out of 929flct: progress  i = 223 out of 929flct: progress  i = 224 out of 929flct: progress  i = 225 out of 929flct: progress  i = 226 out of 929flct: progress  i = 227 out of 929flct: progress  i = 228 out of 929flct: progress  i = 229 out of 929flct: progress  i = 230 out of 929flct: progress  i = 231 out of 929flct: progress  i = 232 out of 929flct: progress  i = 233 out of 929flct: progress  i = 234 out of 929flct: progress  i = 235 out of 929flct: progress  i = 236 out of 929flct: progress  i = 237 out of 929flct: progress  i = 238 out of 929flct: progress  i = 239 out of 929flct: progress  i = 240 out of 929flct: progress  i = 241 out of 929flct: progress  i = 242 out of 929flct: progress  i = 243 out of 929flct: progress  i = 244 out of 929flct: progress  i = 245 out of 929flct: progress  i = 246 out of 929flct: progress  i = 247 out of 929flct: progress  i = 248 out of 929flct: progress  i = 249 out of 929flct: progress  i = 250 out of 929flct: progress  i = 251 out of 929flct: progress  i = 252 out of 929flct: progress  i = 253 out of 929flct: progress  i = 254 out of 929flct: progress  i = 255 out of 929flct: progress  i = 256 out of 929flct: progress  i = 257 out of 929flct: progress  i = 258 out of 929flct: progress  i = 259 out of 929flct: progress  i = 260 out of 929flct: progress  i = 261 out of 929flct: progress  i = 262 out of 929flct: progress  i = 263 out of 929flct: progress  i = 264 out of 929flct: progress  i = 265 out of 929flct: progress  i = 266 out of 929flct: progress  i = 267 out of 929flct: progress  i = 268 out of 929flct: progress  i = 269 out of 929flct: progress  i = 270 out of 929flct: progress  i = 271 out of 929flct: progress  i = 272 out of 929flct: progress  i = 273 out of 929flct: progress  i = 274 out of 929flct: progress  i = 275 out of 929flct: progress  i = 276 out of 929flct: progress  i = 277 out of 929flct: progress  i = 278 out of 929flct: progress  i = 279 out of 929flct: progress  i = 280 out of 929flct: progress  i = 281 out of 929flct: progress  i = 282 out of 929flct: progress  i = 283 out of 929flct: progress  i = 284 out of 929flct: progress  i = 285 out of 929flct: progress  i = 286 out of 929flct: progress  i = 287 out of 929flct: progress  i = 288 out of 929flct: progress  i = 289 out of 929flct: progress  i = 290 out of 929flct: progress  i = 291 out of 929flct: progress  i = 292 out of 929flct: progress  i = 293 out of 929flct: progress  i = 294 out of 929flct: progress  i = 295 out of 929flct: progress  i = 296 out of 929flct: progress  i = 297 out of 929flct: progress  i = 298 out of 929flct: progress  i = 299 out of 929flct: progress  i = 300 out of 929flct: progress  i = 301 out of 929flct: progress  i = 302 out of 929flct: progress  i = 303 out of 929flct: progress  i = 304 out of 929flct: progress  i = 305 out of 929flct: progress  i = 306 out of 929flct: progress  i = 307 out of 929flct: progress  i = 308 out of 929flct: progress  i = 309 out of 929flct: progress  i = 310 out of 929flct: progress  i = 311 out of 929flct: progress  i = 312 out of 929flct: progress  i = 313 out of 929flct: progress  i = 314 out of 929flct: progress  i = 315 out of 929flct: progress  i = 316 out of 929flct: progress  i = 317 out of 929flct: progress  i = 318 out of 929flct: progress  i = 319 out of 929flct: progress  i = 320 out of 929flct: progress  i = 321 out of 929flct: progress  i = 322 out of 929flct: progress  i = 323 out of 929flct: progress  i = 324 out of 929flct: progress  i = 325 out of 929flct: progress  i = 326 out of 929flct: progress  i = 327 out of 929flct: progress  i = 328 out of 929flct: progress  i = 329 out of 929flct: progress  i = 330 out of 929flct: progress  i = 331 out of 929flct: progress  i = 332 out of 929flct: progress  i = 333 out of 929flct: progress  i = 334 out of 929flct: progress  i = 335 out of 929flct: progress  i = 336 out of 929flct: progress  i = 337 out of 929flct: progress  i = 338 out of 929flct: progress  i = 339 out of 929flct: progress  i = 340 out of 929flct: progress  i = 341 out of 929flct: progress  i = 342 out of 929flct: progress  i = 343 out of 929flct: progress  i = 344 out of 929flct: progress  i = 345 out of 929flct: progress  i = 346 out of 929flct: progress  i = 347 out of 929flct: progress  i = 348 out of 929flct: progress  i = 349 out of 929flct: progress  i = 350 out of 929flct: progress  i = 351 out of 929flct: progress  i = 352 out of 929flct: progress  i = 353 out of 929flct: progress  i = 354 out of 929flct: progress  i = 355 out of 929flct: progress  i = 356 out of 929flct: progress  i = 357 out of 929flct: progress  i = 358 out of 929flct: progress  i = 359 out of 929flct: progress  i = 360 out of 929flct: progress  i = 361 out of 929flct: progress  i = 362 out of 929flct: progress  i = 363 out of 929flct: progress  i = 364 out of 929flct: progress  i = 365 out of 929flct: progress  i = 366 out of 929flct: progress  i = 367 out of 929flct: progress  i = 368 out of 929flct: progress  i = 369 out of 929flct: progress  i = 370 out of 929flct: progress  i = 371 out of 929flct: progress  i = 372 out of 929flct: progress  i = 373 out of 929flct: progress  i = 374 out of 929flct: progress  i = 375 out of 929flct: progress  i = 376 out of 929flct: progress  i = 377 out of 929flct: progress  i = 378 out of 929flct: progress  i = 379 out of 929flct: progress  i = 380 out of 929flct: progress  i = 381 out of 929flct: progress  i = 382 out of 929flct: progress  i = 383 out of 929flct: progress  i = 384 out of 929flct: progress  i = 385 out of 929flct: progress  i = 386 out of 929flct: progress  i = 387 out of 929flct: progress  i = 388 out of 929flct: progress  i = 389 out of 929flct: progress  i = 390 out of 929flct: progress  i = 391 out of 929flct: progress  i = 392 out of 929flct: progress  i = 393 out of 929flct: progress  i = 394 out of 929flct: progress  i = 395 out of 929flct: progress  i = 396 out of 929flct: progress  i = 397 out of 929flct: progress  i = 398 out of 929flct: progress  i = 399 out of 929flct: progress  i = 400 out of 929flct: progress  i = 401 out of 929flct: progress  i = 402 out of 929flct: progress  i = 403 out of 929flct: progress  i = 404 out of 929flct: progress  i = 405 out of 929flct: progress  i = 406 out of 929flct: progress  i = 407 out of 929flct: progress  i = 408 out of 929flct: progress  i = 409 out of 929flct: progress  i = 410 out of 929flct: progress  i = 411 out of 929flct: progress  i = 412 out of 929flct: progress  i = 413 out of 929flct: progress  i = 414 out of 929flct: progress  i = 415 out of 929flct: progress  i = 416 out of 929flct: progress  i = 417 out of 929flct: progress  i = 418 out of 929flct: progress  i = 419 out of 929flct: progress  i = 420 out of 929flct: progress  i = 421 out of 929flct: progress  i = 422 out of 929flct: progress  i = 423 out of 929flct: progress  i = 424 out of 929flct: progress  i = 425 out of 929flct: progress  i = 426 out of 929flct: progress  i = 427 out of 929flct: progress  i = 428 out of 929flct: progress  i = 429 out of 929flct: progress  i = 430 out of 929flct: progress  i = 431 out of 929flct: progress  i = 432 out of 929flct: progress  i = 433 out of 929flct: progress  i = 434 out of 929flct: progress  i = 435 out of 929flct: progress  i = 436 out of 929flct: progress  i = 437 out of 929flct: progress  i = 438 out of 929flct: progress  i = 439 out of 929flct: progress  i = 440 out of 929flct: progress  i = 441 out of 929flct: progress  i = 442 out of 929flct: progress  i = 443 out of 929flct: progress  i = 444 out of 929flct: progress  i = 445 out of 929flct: progress  i = 446 out of 929flct: progress  i = 447 out of 929flct: progress  i = 448 out of 929flct: progress  i = 449 out of 929flct: progress  i = 450 out of 929flct: progress  i = 451 out of 929flct: progress  i = 452 out of 929flct: progress  i = 453 out of 929flct: progress  i = 454 out of 929flct: progress  i = 455 out of 929flct: progress  i = 456 out of 929flct: progress  i = 457 out of 929flct: progress  i = 458 out of 929flct: progress  i = 459 out of 929flct: progress  i = 460 out of 929flct: progress  i = 461 out of 929flct: progress  i = 462 out of 929flct: progress  i = 463 out of 929flct: progress  i = 464 out of 929flct: progress  i = 465 out of 929flct: progress  i = 466 out of 929flct: progress  i = 467 out of 929flct: progress  i = 468 out of 929flct: progress  i = 469 out of 929flct: progress  i = 470 out of 929flct: progress  i = 471 out of 929flct: progress  i = 472 out of 929flct: progress  i = 473 out of 929flct: progress  i = 474 out of 929flct: progress  i = 475 out of 929flct: progress  i = 476 out of 929flct: progress  i = 477 out of 929flct: progress  i = 478 out of 929flct: progress  i = 479 out of 929flct: progress  i = 480 out of 929flct: progress  i = 481 out of 929flct: progress  i = 482 out of 929flct: progress  i = 483 out of 929flct: progress  i = 484 out of 929flct: progress  i = 485 out of 929flct: progress  i = 486 out of 929flct: progress  i = 487 out of 929flct: progress  i = 488 out of 929flct: progress  i = 489 out of 929flct: progress  i = 490 out of 929flct: progress  i = 491 out of 929flct: progress  i = 492 out of 929flct: progress  i = 493 out of 929flct: progress  i = 494 out of 929flct: progress  i = 495 out of 929flct: progress  i = 496 out of 929flct: progress  i = 497 out of 929flct: progress  i = 498 out of 929flct: progress  i = 499 out of 929flct: progress  i = 500 out of 929flct: progress  i = 501 out of 929flct: progress  i = 502 out of 929flct: progress  i = 503 out of 929flct: progress  i = 504 out of 929flct: progress  i = 505 out of 929flct: progress  i = 506 out of 929flct: progress  i = 507 out of 929flct: progress  i = 508 out of 929flct: progress  i = 509 out of 929flct: progress  i = 510 out of 929flct: progress  i = 511 out of 929flct: progress  i = 512 out of 929flct: progress  i = 513 out of 929flct: progress  i = 514 out of 929flct: progress  i = 515 out of 929flct: progress  i = 516 out of 929flct: progress  i = 517 out of 929flct: progress  i = 518 out of 929flct: progress  i = 519 out of 929flct: progress  i = 520 out of 929flct: progress  i = 521 out of 929flct: progress  i = 522 out of 929flct: progress  i = 523 out of 929flct: progress  i = 524 out of 929flct: progress  i = 525 out of 929flct: progress  i = 526 out of 929flct: progress  i = 527 out of 929flct: progress  i = 528 out of 929flct: progress  i = 529 out of 929flct: progress  i = 530 out of 929flct: progress  i = 531 out of 929flct: progress  i = 532 out of 929flct: progress  i = 533 out of 929flct: progress  i = 534 out of 929flct: progress  i = 535 out of 929flct: progress  i = 536 out of 929flct: progress  i = 537 out of 929flct: progress  i = 538 out of 929flct: progress  i = 539 out of 929flct: progress  i = 540 out of 929flct: progress  i = 541 out of 929flct: progress  i = 542 out of 929flct: progress  i = 543 out of 929flct: progress  i = 544 out of 929flct: progress  i = 545 out of 929flct: progress  i = 546 out of 929flct: progress  i = 547 out of 929flct: progress  i = 548 out of 929flct: progress  i = 549 out of 929flct: progress  i = 550 out of 929flct: progress  i = 551 out of 929flct: progress  i = 552 out of 929flct: progress  i = 553 out of 929flct: progress  i = 554 out of 929flct: progress  i = 555 out of 929flct: progress  i = 556 out of 929flct: progress  i = 557 out of 929flct: progress  i = 558 out of 929flct: progress  i = 559 out of 929flct: progress  i = 560 out of 929flct: progress  i = 561 out of 929flct: progress  i = 562 out of 929flct: progress  i = 563 out of 929flct: progress  i = 564 out of 929flct: progress  i = 565 out of 929flct: progress  i = 566 out of 929flct: progress  i = 567 out of 929flct: progress  i = 568 out of 929flct: progress  i = 569 out of 929flct: progress  i = 570 out of 929flct: progress  i = 571 out of 929flct: progress  i = 572 out of 929flct: progress  i = 573 out of 929flct: progress  i = 574 out of 929flct: progress  i = 575 out of 929flct: progress  i = 576 out of 929flct: progress  i = 577 out of 929flct: progress  i = 578 out of 929flct: progress  i = 579 out of 929flct: progress  i = 580 out of 929flct: progress  i = 581 out of 929flct: progress  i = 582 out of 929flct: progress  i = 583 out of 929flct: progress  i = 584 out of 929flct: progress  i = 585 out of 929flct: progress  i = 586 out of 929flct: progress  i = 587 out of 929flct: progress  i = 588 out of 929flct: progress  i = 589 out of 929flct: progress  i = 590 out of 929flct: progress  i = 591 out of 929flct: progress  i = 592 out of 929flct: progress  i = 593 out of 929flct: progress  i = 594 out of 929flct: progress  i = 595 out of 929flct: progress  i = 596 out of 929flct: progress  i = 597 out of 929flct: progress  i = 598 out of 929flct: progress  i = 599 out of 929flct: progress  i = 600 out of 929flct: progress  i = 601 out of 929flct: progress  i = 602 out of 929flct: progress  i = 603 out of 929flct: progress  i = 604 out of 929flct: progress  i = 605 out of 929flct: progress  i = 606 out of 929flct: progress  i = 607 out of 929flct: progress  i = 608 out of 929flct: progress  i = 609 out of 929flct: progress  i = 610 out of 929flct: progress  i = 611 out of 929flct: progress  i = 612 out of 929flct: progress  i = 613 out of 929flct: progress  i = 614 out of 929flct: progress  i = 615 out of 929flct: progress  i = 616 out of 929flct: progress  i = 617 out of 929flct: progress  i = 618 out of 929flct: progress  i = 619 out of 929flct: progress  i = 620 out of 929flct: progress  i = 621 out of 929flct: progress  i = 622 out of 929flct: progress  i = 623 out of 929flct: progress  i = 624 out of 929flct: progress  i = 625 out of 929flct: progress  i = 626 out of 929flct: progress  i = 627 out of 929flct: progress  i = 628 out of 929flct: progress  i = 629 out of 929flct: progress  i = 630 out of 929flct: progress  i = 631 out of 929flct: progress  i = 632 out of 929flct: progress  i = 633 out of 929flct: progress  i = 634 out of 929flct: progress  i = 635 out of 929flct: progress  i = 636 out of 929flct: progress  i = 637 out of 929flct: progress  i = 638 out of 929flct: progress  i = 639 out of 929flct: progress  i = 640 out of 929flct: progress  i = 641 out of 929flct: progress  i = 642 out of 929flct: progress  i = 643 out of 929flct: progress  i = 644 out of 929flct: progress  i = 645 out of 929flct: progress  i = 646 out of 929flct: progress  i = 647 out of 929flct: progress  i = 648 out of 929flct: progress  i = 649 out of 929flct: progress  i = 650 out of 929flct: progress  i = 651 out of 929flct: progress  i = 652 out of 929flct: progress  i = 653 out of 929flct: progress  i = 654 out of 929flct: progress  i = 655 out of 929flct: progress  i = 656 out of 929flct: progress  i = 657 out of 929flct: progress  i = 658 out of 929flct: progress  i = 659 out of 929flct: progress  i = 660 out of 929flct: progress  i = 661 out of 929flct: progress  i = 662 out of 929flct: progress  i = 663 out of 929flct: progress  i = 664 out of 929flct: progress  i = 665 out of 929flct: progress  i = 666 out of 929flct: progress  i = 667 out of 929flct: progress  i = 668 out of 929flct: progress  i = 669 out of 929flct: progress  i = 670 out of 929flct: progress  i = 671 out of 929flct: progress  i = 672 out of 929flct: progress  i = 673 out of 929flct: progress  i = 674 out of 929flct: progress  i = 675 out of 929flct: progress  i = 676 out of 929flct: progress  i = 677 out of 929flct: progress  i = 678 out of 929flct: progress  i = 679 out of 929flct: progress  i = 680 out of 929flct: progress  i = 681 out of 929flct: progress  i = 682 out of 929flct: progress  i = 683 out of 929flct: progress  i = 684 out of 929flct: progress  i = 685 out of 929flct: progress  i = 686 out of 929flct: progress  i = 687 out of 929flct: progress  i = 688 out of 929flct: progress  i = 689 out of 929flct: progress  i = 690 out of 929flct: progress  i = 691 out of 929flct: progress  i = 692 out of 929flct: progress  i = 693 out of 929flct: progress  i = 694 out of 929flct: progress  i = 695 out of 929flct: progress  i = 696 out of 929flct: progress  i = 697 out of 929flct: progress  i = 698 out of 929flct: progress  i = 699 out of 929flct: progress  i = 700 out of 929flct: progress  i = 701 out of 929flct: progress  i = 702 out of 929flct: progress  i = 703 out of 929flct: progress  i = 704 out of 929flct: progress  i = 705 out of 929flct: progress  i = 706 out of 929flct: progress  i = 707 out of 929flct: progress  i = 708 out of 929flct: progress  i = 709 out of 929flct: progress  i = 710 out of 929flct: progress  i = 711 out of 929flct: progress  i = 712 out of 929flct: progress  i = 713 out of 929flct: progress  i = 714 out of 929flct: progress  i = 715 out of 929flct: progress  i = 716 out of 929flct: progress  i = 717 out of 929flct: progress  i = 718 out of 929flct: progress  i = 719 out of 929flct: progress  i = 720 out of 929flct: progress  i = 721 out of 929flct: progress  i = 722 out of 929flct: progress  i = 723 out of 929flct: progress  i = 724 out of 929flct: progress  i = 725 out of 929flct: progress  i = 726 out of 929flct: progress  i = 727 out of 929flct: progress  i = 728 out of 929flct: progress  i = 729 out of 929flct: progress  i = 730 out of 929flct: progress  i = 731 out of 929flct: progress  i = 732 out of 929flct: progress  i = 733 out of 929flct: progress  i = 734 out of 929flct: progress  i = 735 out of 929flct: progress  i = 736 out of 929flct: progress  i = 737 out of 929flct: progress  i = 738 out of 929flct: progress  i = 739 out of 929flct: progress  i = 740 out of 929flct: progress  i = 741 out of 929flct: progress  i = 742 out of 929flct: progress  i = 743 out of 929flct: progress  i = 744 out of 929flct: progress  i = 745 out of 929flct: progress  i = 746 out of 929flct: progress  i = 747 out of 929flct: progress  i = 748 out of 929flct: progress  i = 749 out of 929flct: progress  i = 750 out of 929flct: progress  i = 751 out of 929flct: progress  i = 752 out of 929flct: progress  i = 753 out of 929flct: progress  i = 754 out of 929flct: progress  i = 755 out of 929flct: progress  i = 756 out of 929flct: progress  i = 757 out of 929flct: progress  i = 758 out of 929flct: progress  i = 759 out of 929flct: progress  i = 760 out of 929flct: progress  i = 761 out of 929flct: progress  i = 762 out of 929flct: progress  i = 763 out of 929flct: progress  i = 764 out of 929flct: progress  i = 765 out of 929flct: progress  i = 766 out of 929flct: progress  i = 767 out of 929flct: progress  i = 768 out of 929flct: progress  i = 769 out of 929flct: progress  i = 770 out of 929flct: progress  i = 771 out of 929flct: progress  i = 772 out of 929flct: progress  i = 773 out of 929flct: progress  i = 774 out of 929flct: progress  i = 775 out of 929flct: progress  i = 776 out of 929flct: progress  i = 777 out of 929flct: progress  i = 778 out of 929flct: progress  i = 779 out of 929flct: progress  i = 780 out of 929flct: progress  i = 781 out of 929flct: progress  i = 782 out of 929flct: progress  i = 783 out of 929flct: progress  i = 784 out of 929flct: progress  i = 785 out of 929flct: progress  i = 786 out of 929flct: progress  i = 787 out of 929flct: progress  i = 788 out of 929flct: progress  i = 789 out of 929flct: progress  i = 790 out of 929flct: progress  i = 791 out of 929flct: progress  i = 792 out of 929flct: progress  i = 793 out of 929flct: progress  i = 794 out of 929flct: progress  i = 795 out of 929flct: progress  i = 796 out of 929flct: progress  i = 797 out of 929flct: progress  i = 798 out of 929flct: progress  i = 799 out of 929flct: progress  i = 800 out of 929flct: progress  i = 801 out of 929flct: progress  i = 802 out of 929flct: progress  i = 803 out of 929flct: progress  i = 804 out of 929flct: progress  i = 805 out of 929flct: progress  i = 806 out of 929flct: progress  i = 807 out of 929flct: progress  i = 808 out of 929flct: progress  i = 809 out of 929flct: progress  i = 810 out of 929flct: progress  i = 811 out of 929flct: progress  i = 812 out of 929flct: progress  i = 813 out of 929flct: progress  i = 814 out of 929flct: progress  i = 815 out of 929flct: progress  i = 816 out of 929flct: progress  i = 817 out of 929flct: progress  i = 818 out of 929flct: progress  i = 819 out of 929flct: progress  i = 820 out of 929flct: progress  i = 821 out of 929flct: progress  i = 822 out of 929flct: progress  i = 823 out of 929flct: progress  i = 824 out of 929flct: progress  i = 825 out of 929flct: progress  i = 826 out of 929flct: progress  i = 827 out of 929flct: progress  i = 828 out of 929flct: progress  i = 829 out of 929flct: progress  i = 830 out of 929flct: progress  i = 831 out of 929flct: progress  i = 832 out of 929flct: progress  i = 833 out of 929flct: progress  i = 834 out of 929flct: progress  i = 835 out of 929flct: progress  i = 836 out of 929flct: progress  i = 837 out of 929flct: progress  i = 838 out of 929flct: progress  i = 839 out of 929flct: progress  i = 840 out of 929flct: progress  i = 841 out of 929flct: progress  i = 842 out of 929flct: progress  i = 843 out of 929flct: progress  i = 844 out of 929flct: progress  i = 845 out of 929flct: progress  i = 846 out of 929flct: progress  i = 847 out of 929flct: progress  i = 848 out of 929flct: progress  i = 849 out of 929flct: progress  i = 850 out of 929flct: progress  i = 851 out of 929flct: progress  i = 852 out of 929flct: progress  i = 853 out of 929flct: progress  i = 854 out of 929flct: progress  i = 855 out of 929flct: progress  i = 856 out of 929flct: progress  i = 857 out of 929flct: progress  i = 858 out of 929flct: progress  i = 859 out of 929flct: progress  i = 860 out of 929flct: progress  i = 861 out of 929flct: progress  i = 862 out of 929flct: progress  i = 863 out of 929flct: progress  i = 864 out of 929flct: progress  i = 865 out of 929flct: progress  i = 866 out of 929flct: progress  i = 867 out of 929flct: progress  i = 868 out of 929flct: progress  i = 869 out of 929flct: progress  i = 870 out of 929flct: progress  i = 871 out of 929flct: progress  i = 872 out of 929flct: progress  i = 873 out of 929flct: progress  i = 874 out of 929flct: progress  i = 875 out of 929flct: progress  i = 876 out of 929flct: progress  i = 877 out of 929flct: progress  i = 878 out of 929flct: progress  i = 879 out of 929flct: progress  i = 880 out of 929flct: progress  i = 881 out of 929flct: progress  i = 882 out of 929flct: progress  i = 883 out of 929flct: progress  i = 884 out of 929flct: progress  i = 885 out of 929flct: progress  i = 886 out of 929flct: progress  i = 887 out of 929flct: progress  i = 888 out of 929flct: progress  i = 889 out of 929flct: progress  i = 890 out of 929flct: progress  i = 891 out of 929flct: progress  i = 892 out of 929flct: progress  i = 893 out of 929flct: progress  i = 894 out of 929flct: progress  i = 895 out of 929flct: progress  i = 896 out of 929flct: progress  i = 897 out of 929flct: progress  i = 898 out of 929flct: progress  i = 899 out of 929flct: progress  i = 900 out of 929flct: progress  i = 901 out of 929flct: progress  i = 902 out of 929flct: progress  i = 903 out of 929flct: progress  i = 904 out of 929flct: progress  i = 905 out of 929flct: progress  i = 906 out of 929flct: progress  i = 907 out of 929flct: progress  i = 908 out of 929flct: progress  i = 909 out of 929flct: progress  i = 910 out of 929flct: progress  i = 911 out of 929flct: progress  i = 912 out of 929flct: progress  i = 913 out of 929flct: progress  i = 914 out of 929flct: progress  i = 915 out of 929flct: progress  i = 916 out of 929flct: progress  i = 917 out of 929flct: progress  i = 918 out of 929flct: progress  i = 919 out of 929flct: progress  i = 920 out of 929flct: progress  i = 921 out of 929flct: progress  i = 922 out of 929flct: progress  i = 923 out of 929flct: progress  i = 924 out of 929flct: progress  i = 925 out of 929flct: progress  i = 926 out of 929flct: progress  i = 927 out of 929flct: progress  i = 928 out of 929flct: progress  i = 929 out of 929flct: mean value of gamma^2/sigma^2 = 0.261179

flct: finished
#+end_example

+ Make an high-pass filtered version
#+begin_src sh :results verbatim :dir proper-motions/data
python /Users/will/Dropbox/Teresa-Turtle/scripts/smooth-image.py hh529_acs_f775w_2015.fits -w 16 
#+end_src

#+RESULTS:

#+begin_src sh :results verbatim :dir proper-motions/data
python /Users/will/Dropbox/Teresa-Turtle/scripts/smooth-image.py hh529_acs_f775w_2005.fits -w 16 
#+end_src
#+RESULTS:

+ And now do FLCT on the high-pass filtered images
#+begin_src python :results output
  import sys
  sys.path.append("../../Source/pyflct")
  import os
  from pathlib import Path
  import numpy as np
  import pyflct
  from astropy.io import fits
  from astropy.wcs import WCS

  os.environ["PATH"] = ":".join((os.environ["PATH"], "/Users/will/.local/bin"))
  datadir = Path("proper-motions/data")

  h1, = fits.open(datadir / "hh529_acs_f775w_2005_sharp_16.fits")
  h2, = fits.open(datadir / "hh529_acs_f775w_2015_sharp_16.fits")
  # Mask out pixels that are star/diffraction/bleed
  thresh = 1.6
  m = (h1.data > thresh) | (h2.data > thresh)
  # Set first epoch equal to second there
  h1.data[m] = h2.data[m]

  data_scale = h1.data.max()
  sigma = 20.0
  vx, vy, vm = pyflct.flct(h1.data.T, h2.data.T,
                           deltat=1.0, deltas=1.0, sigma=sigma,
                           thresh=0.1/data_scale,
  )
  vx[vm==0] = np.nan
  vy[vm==0] = np.nan

  fits.PrimaryHDU(
      header=h1.header,
      data=vx.T,
  ).writeto(datadir / f"hh529_acs_f775w_sharp_16_vx_sig{int(sigma):02d}.fits", overwrite=True)

  fits.PrimaryHDU(
      header=h1.header,
      data=vy.T,
  ).writeto(datadir / f"hh529_acs_f775w_sharp_16_vy_sig{int(sigma):02d}.fits", overwrite=True)
#+end_src

#+RESULTS:
#+begin_example
flct: Version 1.07     Copyright: 2007-2018 University of California
flct: small endian machine; i/o will be byteswapped
flct: infile = testin.dat
flct: outfile = testout.dat
flct: column major order assumed for data arrays
flct: deltat = 1
flct: deltas = 1
flct: sigma = 20
flct: threshold image value for LCT is 0.000888
flct: bias correction not enabled
flct: complex.h is not included
flct: from input file, nx = 1700, ny = 930
flct: nominal sliding box size = 84
flct: relative threshold in abs. units = 0.0999972
flct: progress  i = 0 out of 929flct: progress  i = 1 out of 929flct: progress  i = 2 out of 929flct: progress  i = 3 out of 929flct: progress  i = 4 out of 929flct: progress  i = 5 out of 929flct: progress  i = 6 out of 929flct: progress  i = 7 out of 929flct: progress  i = 8 out of 929flct: progress  i = 9 out of 929flct: progress  i = 10 out of 929flct: progress  i = 11 out of 929flct: progress  i = 12 out of 929flct: progress  i = 13 out of 929flct: progress  i = 14 out of 929flct: progress  i = 15 out of 929flct: progress  i = 16 out of 929flct: progress  i = 17 out of 929flct: progress  i = 18 out of 929flct: progress  i = 19 out of 929flct: progress  i = 20 out of 929flct: progress  i = 21 out of 929flct: progress  i = 22 out of 929flct: progress  i = 23 out of 929flct: progress  i = 24 out of 929flct: progress  i = 25 out of 929flct: progress  i = 26 out of 929flct: progress  i = 27 out of 929flct: progress  i = 28 out of 929flct: progress  i = 29 out of 929flct: progress  i = 30 out of 929flct: progress  i = 31 out of 929flct: progress  i = 32 out of 929flct: progress  i = 33 out of 929flct: progress  i = 34 out of 929flct: progress  i = 35 out of 929flct: progress  i = 36 out of 929flct: progress  i = 37 out of 929flct: progress  i = 38 out of 929flct: progress  i = 39 out of 929flct: progress  i = 40 out of 929flct: progress  i = 41 out of 929flct: progress  i = 42 out of 929flct: progress  i = 43 out of 929flct: progress  i = 44 out of 929flct: progress  i = 45 out of 929flct: progress  i = 46 out of 929flct: progress  i = 47 out of 929flct: progress  i = 48 out of 929flct: progress  i = 49 out of 929flct: progress  i = 50 out of 929flct: progress  i = 51 out of 929flct: progress  i = 52 out of 929flct: progress  i = 53 out of 929flct: progress  i = 54 out of 929flct: progress  i = 55 out of 929flct: progress  i = 56 out of 929flct: progress  i = 57 out of 929flct: progress  i = 58 out of 929flct: progress  i = 59 out of 929flct: progress  i = 60 out of 929flct: progress  i = 61 out of 929flct: progress  i = 62 out of 929flct: progress  i = 63 out of 929flct: progress  i = 64 out of 929flct: progress  i = 65 out of 929flct: progress  i = 66 out of 929flct: progress  i = 67 out of 929flct: progress  i = 68 out of 929flct: progress  i = 69 out of 929flct: progress  i = 70 out of 929flct: progress  i = 71 out of 929flct: progress  i = 72 out of 929flct: progress  i = 73 out of 929flct: progress  i = 74 out of 929flct: progress  i = 75 out of 929flct: progress  i = 76 out of 929flct: progress  i = 77 out of 929flct: progress  i = 78 out of 929flct: progress  i = 79 out of 929flct: progress  i = 80 out of 929flct: progress  i = 81 out of 929flct: progress  i = 82 out of 929flct: progress  i = 83 out of 929flct: progress  i = 84 out of 929flct: progress  i = 85 out of 929flct: progress  i = 86 out of 929flct: progress  i = 87 out of 929flct: progress  i = 88 out of 929flct: progress  i = 89 out of 929flct: progress  i = 90 out of 929flct: progress  i = 91 out of 929flct: progress  i = 92 out of 929flct: progress  i = 93 out of 929flct: progress  i = 94 out of 929flct: progress  i = 95 out of 929flct: progress  i = 96 out of 929flct: progress  i = 97 out of 929flct: progress  i = 98 out of 929flct: progress  i = 99 out of 929flct: progress  i = 100 out of 929flct: progress  i = 101 out of 929flct: progress  i = 102 out of 929flct: progress  i = 103 out of 929flct: progress  i = 104 out of 929flct: progress  i = 105 out of 929flct: progress  i = 106 out of 929flct: progress  i = 107 out of 929flct: progress  i = 108 out of 929flct: progress  i = 109 out of 929flct: progress  i = 110 out of 929flct: progress  i = 111 out of 929flct: progress  i = 112 out of 929flct: progress  i = 113 out of 929flct: progress  i = 114 out of 929flct: progress  i = 115 out of 929flct: progress  i = 116 out of 929flct: progress  i = 117 out of 929flct: progress  i = 118 out of 929flct: progress  i = 119 out of 929flct: progress  i = 120 out of 929flct: progress  i = 121 out of 929flct: progress  i = 122 out of 929flct: progress  i = 123 out of 929flct: progress  i = 124 out of 929flct: progress  i = 125 out of 929flct: progress  i = 126 out of 929flct: progress  i = 127 out of 929flct: progress  i = 128 out of 929flct: progress  i = 129 out of 929flct: progress  i = 130 out of 929flct: progress  i = 131 out of 929flct: progress  i = 132 out of 929flct: progress  i = 133 out of 929flct: progress  i = 134 out of 929flct: progress  i = 135 out of 929flct: progress  i = 136 out of 929flct: progress  i = 137 out of 929flct: progress  i = 138 out of 929flct: progress  i = 139 out of 929flct: progress  i = 140 out of 929flct: progress  i = 141 out of 929flct: progress  i = 142 out of 929flct: progress  i = 143 out of 929flct: progress  i = 144 out of 929flct: progress  i = 145 out of 929flct: progress  i = 146 out of 929flct: progress  i = 147 out of 929flct: progress  i = 148 out of 929flct: progress  i = 149 out of 929flct: progress  i = 150 out of 929flct: progress  i = 151 out of 929flct: progress  i = 152 out of 929flct: progress  i = 153 out of 929flct: progress  i = 154 out of 929flct: progress  i = 155 out of 929flct: progress  i = 156 out of 929flct: progress  i = 157 out of 929flct: progress  i = 158 out of 929flct: progress  i = 159 out of 929flct: progress  i = 160 out of 929flct: progress  i = 161 out of 929flct: progress  i = 162 out of 929flct: progress  i = 163 out of 929flct: progress  i = 164 out of 929flct: progress  i = 165 out of 929flct: progress  i = 166 out of 929flct: progress  i = 167 out of 929flct: progress  i = 168 out of 929flct: progress  i = 169 out of 929flct: progress  i = 170 out of 929flct: progress  i = 171 out of 929flct: progress  i = 172 out of 929flct: progress  i = 173 out of 929flct: progress  i = 174 out of 929flct: progress  i = 175 out of 929flct: progress  i = 176 out of 929flct: progress  i = 177 out of 929flct: progress  i = 178 out of 929flct: progress  i = 179 out of 929flct: progress  i = 180 out of 929flct: progress  i = 181 out of 929flct: progress  i = 182 out of 929flct: progress  i = 183 out of 929flct: progress  i = 184 out of 929flct: progress  i = 185 out of 929flct: progress  i = 186 out of 929flct: progress  i = 187 out of 929flct: progress  i = 188 out of 929flct: progress  i = 189 out of 929flct: progress  i = 190 out of 929flct: progress  i = 191 out of 929flct: progress  i = 192 out of 929flct: progress  i = 193 out of 929flct: progress  i = 194 out of 929flct: progress  i = 195 out of 929flct: progress  i = 196 out of 929flct: progress  i = 197 out of 929flct: progress  i = 198 out of 929flct: progress  i = 199 out of 929flct: progress  i = 200 out of 929flct: progress  i = 201 out of 929flct: progress  i = 202 out of 929flct: progress  i = 203 out of 929flct: progress  i = 204 out of 929flct: progress  i = 205 out of 929flct: progress  i = 206 out of 929flct: progress  i = 207 out of 929flct: progress  i = 208 out of 929flct: progress  i = 209 out of 929flct: progress  i = 210 out of 929flct: progress  i = 211 out of 929flct: progress  i = 212 out of 929flct: progress  i = 213 out of 929flct: progress  i = 214 out of 929flct: progress  i = 215 out of 929flct: progress  i = 216 out of 929flct: progress  i = 217 out of 929flct: progress  i = 218 out of 929flct: progress  i = 219 out of 929flct: progress  i = 220 out of 929flct: progress  i = 221 out of 929flct: progress  i = 222 out of 929flct: progress  i = 223 out of 929flct: progress  i = 224 out of 929flct: progress  i = 225 out of 929flct: progress  i = 226 out of 929flct: progress  i = 227 out of 929flct: progress  i = 228 out of 929flct: progress  i = 229 out of 929flct: progress  i = 230 out of 929flct: progress  i = 231 out of 929flct: progress  i = 232 out of 929flct: progress  i = 233 out of 929flct: progress  i = 234 out of 929flct: progress  i = 235 out of 929flct: progress  i = 236 out of 929flct: progress  i = 237 out of 929flct: progress  i = 238 out of 929flct: progress  i = 239 out of 929flct: progress  i = 240 out of 929flct: progress  i = 241 out of 929flct: progress  i = 242 out of 929flct: progress  i = 243 out of 929flct: progress  i = 244 out of 929flct: progress  i = 245 out of 929flct: progress  i = 246 out of 929flct: progress  i = 247 out of 929flct: progress  i = 248 out of 929flct: progress  i = 249 out of 929flct: progress  i = 250 out of 929flct: progress  i = 251 out of 929flct: progress  i = 252 out of 929flct: progress  i = 253 out of 929flct: progress  i = 254 out of 929flct: progress  i = 255 out of 929flct: progress  i = 256 out of 929flct: progress  i = 257 out of 929flct: progress  i = 258 out of 929flct: progress  i = 259 out of 929flct: progress  i = 260 out of 929flct: progress  i = 261 out of 929flct: progress  i = 262 out of 929flct: progress  i = 263 out of 929flct: progress  i = 264 out of 929flct: progress  i = 265 out of 929flct: progress  i = 266 out of 929flct: progress  i = 267 out of 929flct: progress  i = 268 out of 929flct: progress  i = 269 out of 929flct: progress  i = 270 out of 929flct: progress  i = 271 out of 929flct: progress  i = 272 out of 929flct: progress  i = 273 out of 929flct: progress  i = 274 out of 929flct: progress  i = 275 out of 929flct: progress  i = 276 out of 929flct: progress  i = 277 out of 929flct: progress  i = 278 out of 929flct: progress  i = 279 out of 929flct: progress  i = 280 out of 929flct: progress  i = 281 out of 929flct: progress  i = 282 out of 929flct: progress  i = 283 out of 929flct: progress  i = 284 out of 929flct: progress  i = 285 out of 929flct: progress  i = 286 out of 929flct: progress  i = 287 out of 929flct: progress  i = 288 out of 929flct: progress  i = 289 out of 929flct: progress  i = 290 out of 929flct: progress  i = 291 out of 929flct: progress  i = 292 out of 929flct: progress  i = 293 out of 929flct: progress  i = 294 out of 929flct: progress  i = 295 out of 929flct: progress  i = 296 out of 929flct: progress  i = 297 out of 929flct: progress  i = 298 out of 929flct: progress  i = 299 out of 929flct: progress  i = 300 out of 929flct: progress  i = 301 out of 929flct: progress  i = 302 out of 929flct: progress  i = 303 out of 929flct: progress  i = 304 out of 929flct: progress  i = 305 out of 929flct: progress  i = 306 out of 929flct: progress  i = 307 out of 929flct: progress  i = 308 out of 929flct: progress  i = 309 out of 929flct: progress  i = 310 out of 929flct: progress  i = 311 out of 929flct: progress  i = 312 out of 929flct: progress  i = 313 out of 929flct: progress  i = 314 out of 929flct: progress  i = 315 out of 929flct: progress  i = 316 out of 929flct: progress  i = 317 out of 929flct: progress  i = 318 out of 929flct: progress  i = 319 out of 929flct: progress  i = 320 out of 929flct: progress  i = 321 out of 929flct: progress  i = 322 out of 929flct: progress  i = 323 out of 929flct: progress  i = 324 out of 929flct: progress  i = 325 out of 929flct: progress  i = 326 out of 929flct: progress  i = 327 out of 929flct: progress  i = 328 out of 929flct: progress  i = 329 out of 929flct: progress  i = 330 out of 929flct: progress  i = 331 out of 929flct: progress  i = 332 out of 929flct: progress  i = 333 out of 929flct: progress  i = 334 out of 929flct: progress  i = 335 out of 929flct: progress  i = 336 out of 929flct: progress  i = 337 out of 929flct: progress  i = 338 out of 929flct: progress  i = 339 out of 929flct: progress  i = 340 out of 929flct: progress  i = 341 out of 929flct: progress  i = 342 out of 929flct: progress  i = 343 out of 929flct: progress  i = 344 out of 929flct: progress  i = 345 out of 929flct: progress  i = 346 out of 929flct: progress  i = 347 out of 929flct: progress  i = 348 out of 929flct: progress  i = 349 out of 929flct: progress  i = 350 out of 929flct: progress  i = 351 out of 929flct: progress  i = 352 out of 929flct: progress  i = 353 out of 929flct: progress  i = 354 out of 929flct: progress  i = 355 out of 929flct: progress  i = 356 out of 929flct: progress  i = 357 out of 929flct: progress  i = 358 out of 929flct: progress  i = 359 out of 929flct: progress  i = 360 out of 929flct: progress  i = 361 out of 929flct: progress  i = 362 out of 929flct: progress  i = 363 out of 929flct: progress  i = 364 out of 929flct: progress  i = 365 out of 929flct: progress  i = 366 out of 929flct: progress  i = 367 out of 929flct: progress  i = 368 out of 929flct: progress  i = 369 out of 929flct: progress  i = 370 out of 929flct: progress  i = 371 out of 929flct: progress  i = 372 out of 929flct: progress  i = 373 out of 929flct: progress  i = 374 out of 929flct: progress  i = 375 out of 929flct: progress  i = 376 out of 929flct: progress  i = 377 out of 929flct: progress  i = 378 out of 929flct: progress  i = 379 out of 929flct: progress  i = 380 out of 929flct: progress  i = 381 out of 929flct: progress  i = 382 out of 929flct: progress  i = 383 out of 929flct: progress  i = 384 out of 929flct: progress  i = 385 out of 929flct: progress  i = 386 out of 929flct: progress  i = 387 out of 929flct: progress  i = 388 out of 929flct: progress  i = 389 out of 929flct: progress  i = 390 out of 929flct: progress  i = 391 out of 929flct: progress  i = 392 out of 929flct: progress  i = 393 out of 929flct: progress  i = 394 out of 929flct: progress  i = 395 out of 929flct: progress  i = 396 out of 929flct: progress  i = 397 out of 929flct: progress  i = 398 out of 929flct: progress  i = 399 out of 929flct: progress  i = 400 out of 929flct: progress  i = 401 out of 929flct: progress  i = 402 out of 929flct: progress  i = 403 out of 929flct: progress  i = 404 out of 929flct: progress  i = 405 out of 929flct: progress  i = 406 out of 929flct: progress  i = 407 out of 929flct: progress  i = 408 out of 929flct: progress  i = 409 out of 929flct: progress  i = 410 out of 929flct: progress  i = 411 out of 929flct: progress  i = 412 out of 929flct: progress  i = 413 out of 929flct: progress  i = 414 out of 929flct: progress  i = 415 out of 929flct: progress  i = 416 out of 929flct: progress  i = 417 out of 929flct: progress  i = 418 out of 929flct: progress  i = 419 out of 929flct: progress  i = 420 out of 929flct: progress  i = 421 out of 929flct: progress  i = 422 out of 929flct: progress  i = 423 out of 929flct: progress  i = 424 out of 929flct: progress  i = 425 out of 929flct: progress  i = 426 out of 929flct: progress  i = 427 out of 929flct: progress  i = 428 out of 929flct: progress  i = 429 out of 929flct: progress  i = 430 out of 929flct: progress  i = 431 out of 929flct: progress  i = 432 out of 929flct: progress  i = 433 out of 929flct: progress  i = 434 out of 929flct: progress  i = 435 out of 929flct: progress  i = 436 out of 929flct: progress  i = 437 out of 929flct: progress  i = 438 out of 929flct: progress  i = 439 out of 929flct: progress  i = 440 out of 929flct: progress  i = 441 out of 929flct: progress  i = 442 out of 929flct: progress  i = 443 out of 929flct: progress  i = 444 out of 929flct: progress  i = 445 out of 929flct: progress  i = 446 out of 929flct: progress  i = 447 out of 929flct: progress  i = 448 out of 929flct: progress  i = 449 out of 929flct: progress  i = 450 out of 929flct: progress  i = 451 out of 929flct: progress  i = 452 out of 929flct: progress  i = 453 out of 929flct: progress  i = 454 out of 929flct: progress  i = 455 out of 929flct: progress  i = 456 out of 929flct: progress  i = 457 out of 929flct: progress  i = 458 out of 929flct: progress  i = 459 out of 929flct: progress  i = 460 out of 929flct: progress  i = 461 out of 929flct: progress  i = 462 out of 929flct: progress  i = 463 out of 929flct: progress  i = 464 out of 929flct: progress  i = 465 out of 929flct: progress  i = 466 out of 929flct: progress  i = 467 out of 929flct: progress  i = 468 out of 929flct: progress  i = 469 out of 929flct: progress  i = 470 out of 929flct: progress  i = 471 out of 929flct: progress  i = 472 out of 929flct: progress  i = 473 out of 929flct: progress  i = 474 out of 929flct: progress  i = 475 out of 929flct: progress  i = 476 out of 929flct: progress  i = 477 out of 929flct: progress  i = 478 out of 929flct: progress  i = 479 out of 929flct: progress  i = 480 out of 929flct: progress  i = 481 out of 929flct: progress  i = 482 out of 929flct: progress  i = 483 out of 929flct: progress  i = 484 out of 929flct: progress  i = 485 out of 929flct: progress  i = 486 out of 929flct: progress  i = 487 out of 929flct: progress  i = 488 out of 929flct: progress  i = 489 out of 929flct: progress  i = 490 out of 929flct: progress  i = 491 out of 929flct: progress  i = 492 out of 929flct: progress  i = 493 out of 929flct: progress  i = 494 out of 929flct: progress  i = 495 out of 929flct: progress  i = 496 out of 929flct: progress  i = 497 out of 929flct: progress  i = 498 out of 929flct: progress  i = 499 out of 929flct: progress  i = 500 out of 929flct: progress  i = 501 out of 929flct: progress  i = 502 out of 929flct: progress  i = 503 out of 929flct: progress  i = 504 out of 929flct: progress  i = 505 out of 929flct: progress  i = 506 out of 929flct: progress  i = 507 out of 929flct: progress  i = 508 out of 929flct: progress  i = 509 out of 929flct: progress  i = 510 out of 929flct: progress  i = 511 out of 929flct: progress  i = 512 out of 929flct: progress  i = 513 out of 929flct: progress  i = 514 out of 929flct: progress  i = 515 out of 929flct: progress  i = 516 out of 929flct: progress  i = 517 out of 929flct: progress  i = 518 out of 929flct: progress  i = 519 out of 929flct: progress  i = 520 out of 929flct: progress  i = 521 out of 929flct: progress  i = 522 out of 929flct: progress  i = 523 out of 929flct: progress  i = 524 out of 929flct: progress  i = 525 out of 929flct: progress  i = 526 out of 929flct: progress  i = 527 out of 929flct: progress  i = 528 out of 929flct: progress  i = 529 out of 929flct: progress  i = 530 out of 929flct: progress  i = 531 out of 929flct: progress  i = 532 out of 929flct: progress  i = 533 out of 929flct: progress  i = 534 out of 929flct: progress  i = 535 out of 929flct: progress  i = 536 out of 929flct: progress  i = 537 out of 929flct: progress  i = 538 out of 929flct: progress  i = 539 out of 929flct: progress  i = 540 out of 929flct: progress  i = 541 out of 929flct: progress  i = 542 out of 929flct: progress  i = 543 out of 929flct: progress  i = 544 out of 929flct: progress  i = 545 out of 929flct: progress  i = 546 out of 929flct: progress  i = 547 out of 929flct: progress  i = 548 out of 929flct: progress  i = 549 out of 929flct: progress  i = 550 out of 929flct: progress  i = 551 out of 929flct: progress  i = 552 out of 929flct: progress  i = 553 out of 929flct: progress  i = 554 out of 929flct: progress  i = 555 out of 929flct: progress  i = 556 out of 929flct: progress  i = 557 out of 929flct: progress  i = 558 out of 929flct: progress  i = 559 out of 929flct: progress  i = 560 out of 929flct: progress  i = 561 out of 929flct: progress  i = 562 out of 929flct: progress  i = 563 out of 929flct: progress  i = 564 out of 929flct: progress  i = 565 out of 929flct: progress  i = 566 out of 929flct: progress  i = 567 out of 929flct: progress  i = 568 out of 929flct: progress  i = 569 out of 929flct: progress  i = 570 out of 929flct: progress  i = 571 out of 929flct: progress  i = 572 out of 929flct: progress  i = 573 out of 929flct: progress  i = 574 out of 929flct: progress  i = 575 out of 929flct: progress  i = 576 out of 929flct: progress  i = 577 out of 929flct: progress  i = 578 out of 929flct: progress  i = 579 out of 929flct: progress  i = 580 out of 929flct: progress  i = 581 out of 929flct: progress  i = 582 out of 929flct: progress  i = 583 out of 929flct: progress  i = 584 out of 929flct: progress  i = 585 out of 929flct: progress  i = 586 out of 929flct: progress  i = 587 out of 929flct: progress  i = 588 out of 929flct: progress  i = 589 out of 929flct: progress  i = 590 out of 929flct: progress  i = 591 out of 929flct: progress  i = 592 out of 929flct: progress  i = 593 out of 929flct: progress  i = 594 out of 929flct: progress  i = 595 out of 929flct: progress  i = 596 out of 929flct: progress  i = 597 out of 929flct: progress  i = 598 out of 929flct: progress  i = 599 out of 929flct: progress  i = 600 out of 929flct: progress  i = 601 out of 929flct: progress  i = 602 out of 929flct: progress  i = 603 out of 929flct: progress  i = 604 out of 929flct: progress  i = 605 out of 929flct: progress  i = 606 out of 929flct: progress  i = 607 out of 929flct: progress  i = 608 out of 929flct: progress  i = 609 out of 929flct: progress  i = 610 out of 929flct: progress  i = 611 out of 929flct: progress  i = 612 out of 929flct: progress  i = 613 out of 929flct: progress  i = 614 out of 929flct: progress  i = 615 out of 929flct: progress  i = 616 out of 929flct: progress  i = 617 out of 929flct: progress  i = 618 out of 929flct: progress  i = 619 out of 929flct: progress  i = 620 out of 929flct: progress  i = 621 out of 929flct: progress  i = 622 out of 929flct: progress  i = 623 out of 929flct: progress  i = 624 out of 929flct: progress  i = 625 out of 929flct: progress  i = 626 out of 929flct: progress  i = 627 out of 929flct: progress  i = 628 out of 929flct: progress  i = 629 out of 929flct: progress  i = 630 out of 929flct: progress  i = 631 out of 929flct: progress  i = 632 out of 929flct: progress  i = 633 out of 929flct: progress  i = 634 out of 929flct: progress  i = 635 out of 929flct: progress  i = 636 out of 929flct: progress  i = 637 out of 929flct: progress  i = 638 out of 929flct: progress  i = 639 out of 929flct: progress  i = 640 out of 929flct: progress  i = 641 out of 929flct: progress  i = 642 out of 929flct: progress  i = 643 out of 929flct: progress  i = 644 out of 929flct: progress  i = 645 out of 929flct: progress  i = 646 out of 929flct: progress  i = 647 out of 929flct: progress  i = 648 out of 929flct: progress  i = 649 out of 929flct: progress  i = 650 out of 929flct: progress  i = 651 out of 929flct: progress  i = 652 out of 929flct: progress  i = 653 out of 929flct: progress  i = 654 out of 929flct: progress  i = 655 out of 929flct: progress  i = 656 out of 929flct: progress  i = 657 out of 929flct: progress  i = 658 out of 929flct: progress  i = 659 out of 929flct: progress  i = 660 out of 929flct: progress  i = 661 out of 929flct: progress  i = 662 out of 929flct: progress  i = 663 out of 929flct: progress  i = 664 out of 929flct: progress  i = 665 out of 929flct: progress  i = 666 out of 929flct: progress  i = 667 out of 929flct: progress  i = 668 out of 929flct: progress  i = 669 out of 929flct: progress  i = 670 out of 929flct: progress  i = 671 out of 929flct: progress  i = 672 out of 929flct: progress  i = 673 out of 929flct: progress  i = 674 out of 929flct: progress  i = 675 out of 929flct: progress  i = 676 out of 929flct: progress  i = 677 out of 929flct: progress  i = 678 out of 929flct: progress  i = 679 out of 929flct: progress  i = 680 out of 929flct: progress  i = 681 out of 929flct: progress  i = 682 out of 929flct: progress  i = 683 out of 929flct: progress  i = 684 out of 929flct: progress  i = 685 out of 929flct: progress  i = 686 out of 929flct: progress  i = 687 out of 929flct: progress  i = 688 out of 929flct: progress  i = 689 out of 929flct: progress  i = 690 out of 929flct: progress  i = 691 out of 929flct: progress  i = 692 out of 929flct: progress  i = 693 out of 929flct: progress  i = 694 out of 929flct: progress  i = 695 out of 929flct: progress  i = 696 out of 929flct: progress  i = 697 out of 929flct: progress  i = 698 out of 929flct: progress  i = 699 out of 929flct: progress  i = 700 out of 929flct: progress  i = 701 out of 929flct: progress  i = 702 out of 929flct: progress  i = 703 out of 929flct: progress  i = 704 out of 929flct: progress  i = 705 out of 929flct: progress  i = 706 out of 929flct: progress  i = 707 out of 929flct: progress  i = 708 out of 929flct: progress  i = 709 out of 929flct: progress  i = 710 out of 929flct: progress  i = 711 out of 929flct: progress  i = 712 out of 929flct: progress  i = 713 out of 929flct: progress  i = 714 out of 929flct: progress  i = 715 out of 929flct: progress  i = 716 out of 929flct: progress  i = 717 out of 929flct: progress  i = 718 out of 929flct: progress  i = 719 out of 929flct: progress  i = 720 out of 929flct: progress  i = 721 out of 929flct: progress  i = 722 out of 929flct: progress  i = 723 out of 929flct: progress  i = 724 out of 929flct: progress  i = 725 out of 929flct: progress  i = 726 out of 929flct: progress  i = 727 out of 929flct: progress  i = 728 out of 929flct: progress  i = 729 out of 929flct: progress  i = 730 out of 929flct: progress  i = 731 out of 929flct: progress  i = 732 out of 929flct: progress  i = 733 out of 929flct: progress  i = 734 out of 929flct: progress  i = 735 out of 929flct: progress  i = 736 out of 929flct: progress  i = 737 out of 929flct: progress  i = 738 out of 929flct: progress  i = 739 out of 929flct: progress  i = 740 out of 929flct: progress  i = 741 out of 929flct: progress  i = 742 out of 929flct: progress  i = 743 out of 929flct: progress  i = 744 out of 929flct: progress  i = 745 out of 929flct: progress  i = 746 out of 929flct: progress  i = 747 out of 929flct: progress  i = 748 out of 929flct: progress  i = 749 out of 929flct: progress  i = 750 out of 929flct: progress  i = 751 out of 929flct: progress  i = 752 out of 929flct: progress  i = 753 out of 929flct: progress  i = 754 out of 929flct: progress  i = 755 out of 929flct: progress  i = 756 out of 929flct: progress  i = 757 out of 929flct: progress  i = 758 out of 929flct: progress  i = 759 out of 929flct: progress  i = 760 out of 929flct: progress  i = 761 out of 929flct: progress  i = 762 out of 929flct: progress  i = 763 out of 929flct: progress  i = 764 out of 929flct: progress  i = 765 out of 929flct: progress  i = 766 out of 929flct: progress  i = 767 out of 929flct: progress  i = 768 out of 929flct: progress  i = 769 out of 929flct: progress  i = 770 out of 929flct: progress  i = 771 out of 929flct: progress  i = 772 out of 929flct: progress  i = 773 out of 929flct: progress  i = 774 out of 929flct: progress  i = 775 out of 929flct: progress  i = 776 out of 929flct: progress  i = 777 out of 929flct: progress  i = 778 out of 929flct: progress  i = 779 out of 929flct: progress  i = 780 out of 929flct: progress  i = 781 out of 929flct: progress  i = 782 out of 929flct: progress  i = 783 out of 929flct: progress  i = 784 out of 929flct: progress  i = 785 out of 929flct: progress  i = 786 out of 929flct: progress  i = 787 out of 929flct: progress  i = 788 out of 929flct: progress  i = 789 out of 929flct: progress  i = 790 out of 929flct: progress  i = 791 out of 929flct: progress  i = 792 out of 929flct: progress  i = 793 out of 929flct: progress  i = 794 out of 929flct: progress  i = 795 out of 929flct: progress  i = 796 out of 929flct: progress  i = 797 out of 929flct: progress  i = 798 out of 929flct: progress  i = 799 out of 929flct: progress  i = 800 out of 929flct: progress  i = 801 out of 929flct: progress  i = 802 out of 929flct: progress  i = 803 out of 929flct: progress  i = 804 out of 929flct: progress  i = 805 out of 929flct: progress  i = 806 out of 929flct: progress  i = 807 out of 929flct: progress  i = 808 out of 929flct: progress  i = 809 out of 929flct: progress  i = 810 out of 929flct: progress  i = 811 out of 929flct: progress  i = 812 out of 929flct: progress  i = 813 out of 929flct: progress  i = 814 out of 929flct: progress  i = 815 out of 929flct: progress  i = 816 out of 929flct: progress  i = 817 out of 929flct: progress  i = 818 out of 929flct: progress  i = 819 out of 929flct: progress  i = 820 out of 929flct: progress  i = 821 out of 929flct: progress  i = 822 out of 929flct: progress  i = 823 out of 929flct: progress  i = 824 out of 929flct: progress  i = 825 out of 929flct: progress  i = 826 out of 929flct: progress  i = 827 out of 929flct: progress  i = 828 out of 929flct: progress  i = 829 out of 929flct: progress  i = 830 out of 929flct: progress  i = 831 out of 929flct: progress  i = 832 out of 929flct: progress  i = 833 out of 929flct: progress  i = 834 out of 929flct: progress  i = 835 out of 929flct: progress  i = 836 out of 929flct: progress  i = 837 out of 929flct: progress  i = 838 out of 929flct: progress  i = 839 out of 929flct: progress  i = 840 out of 929flct: progress  i = 841 out of 929flct: progress  i = 842 out of 929flct: progress  i = 843 out of 929flct: progress  i = 844 out of 929flct: progress  i = 845 out of 929flct: progress  i = 846 out of 929flct: progress  i = 847 out of 929flct: progress  i = 848 out of 929flct: progress  i = 849 out of 929flct: progress  i = 850 out of 929flct: progress  i = 851 out of 929flct: progress  i = 852 out of 929flct: progress  i = 853 out of 929flct: progress  i = 854 out of 929flct: progress  i = 855 out of 929flct: progress  i = 856 out of 929flct: progress  i = 857 out of 929flct: progress  i = 858 out of 929flct: progress  i = 859 out of 929flct: progress  i = 860 out of 929flct: progress  i = 861 out of 929flct: progress  i = 862 out of 929flct: progress  i = 863 out of 929flct: progress  i = 864 out of 929flct: progress  i = 865 out of 929flct: progress  i = 866 out of 929flct: progress  i = 867 out of 929flct: progress  i = 868 out of 929flct: progress  i = 869 out of 929flct: progress  i = 870 out of 929flct: progress  i = 871 out of 929flct: progress  i = 872 out of 929flct: progress  i = 873 out of 929flct: progress  i = 874 out of 929flct: progress  i = 875 out of 929flct: progress  i = 876 out of 929flct: progress  i = 877 out of 929flct: progress  i = 878 out of 929flct: progress  i = 879 out of 929flct: progress  i = 880 out of 929flct: progress  i = 881 out of 929flct: progress  i = 882 out of 929flct: progress  i = 883 out of 929flct: progress  i = 884 out of 929flct: progress  i = 885 out of 929flct: progress  i = 886 out of 929flct: progress  i = 887 out of 929flct: progress  i = 888 out of 929flct: progress  i = 889 out of 929flct: progress  i = 890 out of 929flct: progress  i = 891 out of 929flct: progress  i = 892 out of 929flct: progress  i = 893 out of 929flct: progress  i = 894 out of 929flct: progress  i = 895 out of 929flct: progress  i = 896 out of 929flct: progress  i = 897 out of 929flct: progress  i = 898 out of 929flct: progress  i = 899 out of 929flct: progress  i = 900 out of 929flct: progress  i = 901 out of 929flct: progress  i = 902 out of 929flct: progress  i = 903 out of 929flct: progress  i = 904 out of 929flct: progress  i = 905 out of 929flct: progress  i = 906 out of 929flct: progress  i = 907 out of 929flct: progress  i = 908 out of 929flct: progress  i = 909 out of 929flct: progress  i = 910 out of 929flct: progress  i = 911 out of 929flct: progress  i = 912 out of 929flct: progress  i = 913 out of 929flct: progress  i = 914 out of 929flct: progress  i = 915 out of 929flct: progress  i = 916 out of 929flct: progress  i = 917 out of 929flct: progress  i = 918 out of 929flct: progress  i = 919 out of 929flct: progress  i = 920 out of 929flct: progress  i = 921 out of 929flct: progress  i = 922 out of 929flct: progress  i = 923 out of 929flct: progress  i = 924 out of 929flct: progress  i = 925 out of 929flct: progress  i = 926 out of 929flct: progress  i = 927 out of 929flct: progress  i = 928 out of 929flct: progress  i = 929 out of 929flct: mean value of gamma^2/sigma^2 = 0.100611

flct: finished
#+end_example


+ Plot the proper motions
  + Convert to physical velocities
  + ACS pixel scale is 1.38888888888896E-05 deg = 0.05 arcsec = 50 mas
  + Time span
    + MJD = 57081.4732 = 2015-02-28 = 2015.16
    + 2005-04 = 2005.25
    + dt = 2015.16 - 2005.25 = 9.91 years
  + 1 pixel in 9.91 yrs is 50 / 9.91  = 5.045 mas/yr
  + At a distance of 417 pc, this is 5.045 417 au / 1000 yr km = 9.973 km/s
#+begin_src python :return figfile :results file
  from pathlib import Path
  import numpy as np
  from matplotlib import pyplot as plt
  import matplotlib.patheffects as path_effects
  import seaborn as sns
  from astropy.io import fits
  from astropy.wcs import WCS

  figdir = Path("proper-motions")
  datadir = figdir / "data"

  figfile = figdir / "hh529_acs_f775w_proper_motions.jpg"

  hdu, = fits.open(datadir / "hh529_acs_f775w_2015_sharp_16.fits")
  w = WCS(hdu)
  im = hdu.data
  #s1, s2 = "_sharp_16", "_sig20"
  s1, s2 = "", "_sig10"
  vx = fits.open(datadir / f"hh529_acs_f775w{s1}_vx{s2}.fits")[0].data
  vy = fits.open(datadir / f"hh529_acs_f775w{s1}_vy{s2}.fits")[0].data
  vv = np.hypot(vx, vy)
  pa = np.rad2deg(np.arctan2(-vx, vy)) % 360
  fits.PrimaryHDU(
      header=hdu.header,
      data=vv,
  ).writeto(
      datadir / f"hh529_acs_f775w{s1}_vv{s2}.fits",
      overwrite=True,
  )
  fits.PrimaryHDU(
      header=hdu.header,
      data=pa,
  ).writeto(
      datadir / f"hh529_acs_f775w{s1}_pa{s2}.fits",
      overwrite=True,
  )
  vx[abs(vv) > 5.0] = np.nan
  vx[vv < 0.1] = np.nan
  vx[(im < 1.0)] = np.nan 

  ny, nx = im.shape
  X, Y = np.meshgrid(np.arange(nx), np.arange(ny))

  fig, ax = plt.subplots(figsize=(10, 4), subplot_kw=dict(projection=w))
  ax.imshow(im, vmin=0.8, vmax=1.5, origin="lower", cmap="gray_r")
  # A faint version for the faint emission
  step = slice(None, None, 7), slice(None, None, 7)
  Q = ax.quiver(X[step], Y[step], vx[step], vy[step], pivot="middle",
                headwidth=4, headlength=6, minlength=0.01,
                units="xy", scale=0.2, width=1.5, minshaft=2.0, color="r", alpha=1.0)
  Q.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  QK = ax.quiverkey(Q, 0.05, 0.2, 4.0,
               "40 km/s", labelcolor="red",
               fontproperties=dict(size=8))
  QK.set_path_effects(
      [
          path_effects.PathPatchEffect(
              edgecolor='white', linewidth=0.1, facecolor='red', capstyle="projecting",
          ),
      ]
  )
  #ax.text(0.05, 0.95, "[O III] proper motions", color="w", transform=ax.transAxes)
  ax.set(
      xlabel="RA",
      ylabel="Dec",
      xlim=[150, 1000],
      ylim=[200, 550],
  )
  fig.tight_layout(rect=(0.1, 0.1, 1.0, 1.0))
  fig.savefig(figfile, dpi=1200)
#+end_src

#+RESULTS:
[[file:proper-motions/hh529_acs_f775w_proper_motions.jpg]]

*** Make some GIFs

**** Frame of reference of star cluster
#+begin_src sh :dir proper-motions :results silent
ORDER="HH-529-ACS-GO10246-2005-04.png HH-529-ACS-GO13826-2015-10.png"
convert $(for a in "$ORDER"; do printf -- "-delay 25 %s " $a; done; ) HH529-motions.gif
#+end_src

#+RESULTS:
#+BEGIN_SRC sh :results silent
open -a Safari proper-motions/HH529-motions.gif
#+END_SRC

**** Frame of reference of HH 529-III bow shock
#+begin_src sh :dir proper-motions :results silent
ORDER="HH529-III-bowshock-frame-2005.png HH529-III-bowshock-frame-2015.png"
convert $(for a in "$ORDER"; do printf -- "-delay 25 %s " $a; done; ) HH529-III-bowshock-frame.gif
#+end_src

#+RESULTS:
#+BEGIN_SRC sh :results silent
open -a Safari proper-motions/HH529-III-bowshock-frame.gif
#+END_SRC



*** Measurements of HH 529 PM 
+ HH 529-III
  + PA = 98 +/- 10 deg
  + V_t = 35 +/- 2 km/s
+ HH 529-II
  + PA = 105 +/- 13
  + V_t = 28 +/- 5
+ HH 529-I
  + PA = 83 +/- 50
  + V_t = 25 +/- 15
+ HH 529-east
  + V_t = 28 +/- 6
  + PA = 95 +/- 13
+ HH 529-1.5
  + V_t = 13 +/- 3
  + PA = 61 +/- 20
+ HH 529-0
  + V_t = 25 +/- 7
  + PA = 96 +/- 60
+ East shock
  + PA = 170 +/- 8
  + V_t = 9 +/- 2 km/s
+ HH 529-Ram
  + V_t = 25 +/- 10
  + PA = 130 +/- 70
+ HH 998
  + PA = 224 +/- 24
  + V_t = 54 +/- 27


*** Align on the HH529-III motion
+ Move the CRPIX according to the motion
  + -35 sin(98) / 10 = -3.466 pix
  + +35 cos(98) / 10 = -0.487 pix
  + [676.0 - 3.466, -37.0 - 0.487] = [672.534, -37.487]
+ Turns out that the bowshock frame is a bit different
  + CRPIX = [671.534, -37.987]
  + So shift is [671.534, -37.987] - [676.0, -37.0] = [-4.466, -0.987]
  + 4.5738 pixels = 46 km/s
  + PA = arctan2(4.466, -0.987) = 102.4 deg
+ /Why is this different from the results from FLCT?/
  + Because there is sub-structure to HH 529-III with different velocities
  + The bow shock is moving the fastest
  + There is a bright knot, with its own half mini-bow to north, which is moving slower

*** Figure showing the ACS proper motions for HH 529
+ Objects that I name here (not all are exactly new)
  + HH 529-1.5
    - This is what ODell:2015a calls "several west-moving intervening high-ionization knots" and "a faint series of moving knots centered 8.3 arcsec east of COUP 769. The axis of these knots is about 82°" (sec 3.3.1.1)
    - They are aligned with HH 529-east
  + HH 529-0
    - This is just above the E end of the "East shock", about 2 arcsec W of the HH 998 knot

** Radio observations
+ Epoch: 2012
+ Published in Forbrich:2016a
+ Data is [[file:~/Dropbox/RadioProplyds/JanData/concat_nouvra_inner4k.fits]]
+ In principle, these should be better absolute coordinates
+ They don't quite align with Robberto 2005
+ I had to subtract (1.0, -0.5) pixels from the CRPIX of the radio data
  + But a better solution would be to shift the optical coordinates
* TODO Make a new version of Fig 1
+ Remove the labels
+ [X] Query about position
  + Corrected in email from Eduardo
* Compare with MUSE spectral maps
** Copy the files that we want from /Volumes/SSD-2TB/OrionMuse/LineMaps/
#+begin_src sh :dir ../Orion-HH-data/MUSE :results verbatim
  files="mean-Fe_III-4658-patfixx.fits
  mean-Fe_II-8617-patfixx.fits
  mean-Ar_IV-4740-patfixx.fits
  mean-Cl_IV-8046-patfixx.fits
  mean-H_I-6563-patfixx.fits
  mean-H_I-4861-patfixx.fits
  mean-He_I-5876-patfixx.fits
  mean-He_I-6678-patfixx.fits
  mean-N_II-6548-patfixx.fits
  mean-N_II-6583-patfixx.fits
  mean-O_I-6300-patfixx.fits
  mean-O_III-4959-patfixx.fits
  mean-O_III-5007-patfixx.fits
  mean-S_II-6716-patfixx.fits
  mean-S_II-6731-patfixx.fits
  mean-S_III-9069-patfixx.fits"
  for f in $files;do
      cp -pv /Volumes/SSD-2TB/OrionMuse/LineMaps/$f .
  done
#+end_src

#+RESULTS:
#+begin_example
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Fe_III-4658-patfixx.fits -> ./mean-Fe_III-4658-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Fe_II-8617-patfixx.fits -> ./mean-Fe_II-8617-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Ar_IV-4740-patfixx.fits -> ./mean-Ar_IV-4740-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Cl_IV-8046-patfixx.fits -> ./mean-Cl_IV-8046-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-H_I-6563-patfixx.fits -> ./mean-H_I-6563-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-H_I-4861-patfixx.fits -> ./mean-H_I-4861-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-He_I-5876-patfixx.fits -> ./mean-He_I-5876-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-He_I-6678-patfixx.fits -> ./mean-He_I-6678-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-N_II-6548-patfixx.fits -> ./mean-N_II-6548-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-N_II-6583-patfixx.fits -> ./mean-N_II-6583-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-O_I-6300-patfixx.fits -> ./mean-O_I-6300-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-O_III-4959-patfixx.fits -> ./mean-O_III-4959-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-O_III-5007-patfixx.fits -> ./mean-O_III-5007-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-S_II-6716-patfixx.fits -> ./mean-S_II-6716-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-S_II-6731-patfixx.fits -> ./mean-S_II-6731-patfixx.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-S_III-9069-patfixx.fits -> ./mean-S_III-9069-patfixx.fits
#+end_example

#+begin_src sh :dir ../Orion-HH-data/MUSE :results verbatim
  files="linesum-Fe_III-4881.fits
  linesum-Fe_III-4881-bin004.fits
  linesum-Fe_III-4658-bin004.fits
  linesum-Fe_III-5270-bin004.fits
  linesum-Fe_III-4702-bin004.fits
  ratio-4702-4658-multibin-SN0010.fits
  ratio-4658-4861-bin004.fits
  ratio-9069-9229.fits
  ratio-6583-6563.fits
  linesum-Fe_III-4702-multibin-SN0005.fits"
  for f in $files;do
      cp -pv /Volumes/SSD-2TB/OrionMuse/LineMaps/$f .
  done
#+end_src

#+RESULTS:
#+begin_example
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4881.fits -> ./linesum-Fe_III-4881.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4881-bin004.fits -> ./linesum-Fe_III-4881-bin004.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4658-bin004.fits -> ./linesum-Fe_III-4658-bin004.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-5270-bin004.fits -> ./linesum-Fe_III-5270-bin004.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4702-bin004.fits -> ./linesum-Fe_III-4702-bin004.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/ratio-4702-4658-multibin-SN0010.fits -> ./ratio-4702-4658-multibin-SN0010.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/ratio-4658-4861-bin004.fits -> ./ratio-4658-4861-bin004.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/ratio-9069-9229.fits -> ./ratio-9069-9229.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/ratio-6583-6563.fits -> ./ratio-6583-6563.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4702-multibin-SN0005.fits -> ./linesum-Fe_III-4702-multibin-SN0005.fits
#+end_example


Original batch
#+begin_src sh :dir ../Orion-HH-data/MUSE :results verbatim
  files="linesum-Fe_III-5270-multibin-SN0005.fits
  linesum-Fe_III-4658-multibin-SN0005.fits
  linesum-Fe_II-8617-multibin-SN0005.fits
  linesum-Ni_II-7378-multibin-SN0005.fits
  linesum-Si_III-5740-bin032.fits
  linesum-S_III-9069.fits
  linesum-S_III-6312.fits
  linesum-Ar_III-7136.fits
  linesum-O_III-5007.fits
  mean-Ar_III-7136-patfixx-bin001.fits
  mean-O_II-7318-patfixx-bin001.fits
  mean-O_I-8446-bin001.fits
  sigma-O_I-8446-bin001.fits
  mean-Ni_II-7378-bin008.fits
  muse-derived-Ne-iii-multibin-SN0003.fits
  muse-derived-Ne-multibin-SN0010.fits
  muse-derived-Te-multibin-SN0030.fits
  muse-derived-Te-iii-multibin-SN0003.fits
  linesum-O_III-5007.fits
  linesum-O_II-7318.fits
  linesum-O_I-8446.fits
  linesum-N_II-6583.fits
  linesum-Fe_III-5270-multibin-SN0005.fits
  linesum-O_II-7330.fits
  linesum-O_I-8446-multibin-SN0005.fits
  linesum-Ni_II-7378-multibin-SN0005.fits
  linesum-Fe_II-8617-multibin-SN0005.fits
  linesum-S_III-9069.fits
  linesum-Ar_III-7136.fits
  linesum-O_III-5007.fits
  ratio-5007-7318.fits"
  for f in $files;do
      cp -pv /Volumes/SSD-2TB/OrionMuse/LineMaps/$f .
  done
#+end_src

#+RESULTS:
#+begin_example
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-5270-multibin-SN0005.fits -> ./linesum-Fe_III-5270-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-4658-multibin-SN0005.fits -> ./linesum-Fe_III-4658-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_II-8617-multibin-SN0005.fits -> ./linesum-Fe_II-8617-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Ni_II-7378-multibin-SN0005.fits -> ./linesum-Ni_II-7378-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Si_III-5740-bin032.fits -> ./linesum-Si_III-5740-bin032.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-S_III-9069.fits -> ./linesum-S_III-9069.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-S_III-6312.fits -> ./linesum-S_III-6312.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Ar_III-7136.fits -> ./linesum-Ar_III-7136.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_III-5007.fits -> ./linesum-O_III-5007.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Ar_III-7136-patfixx-bin001.fits -> ./mean-Ar_III-7136-patfixx-bin001.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-O_II-7318-patfixx-bin001.fits -> ./mean-O_II-7318-patfixx-bin001.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-O_I-8446-bin001.fits -> ./mean-O_I-8446-bin001.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/sigma-O_I-8446-bin001.fits -> ./sigma-O_I-8446-bin001.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/mean-Ni_II-7378-bin008.fits -> ./mean-Ni_II-7378-bin008.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/muse-derived-Ne-iii-multibin-SN0003.fits -> ./muse-derived-Ne-iii-multibin-SN0003.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/muse-derived-Ne-multibin-SN0010.fits -> ./muse-derived-Ne-multibin-SN0010.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/muse-derived-Te-multibin-SN0030.fits -> ./muse-derived-Te-multibin-SN0030.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/muse-derived-Te-iii-multibin-SN0003.fits -> ./muse-derived-Te-iii-multibin-SN0003.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_III-5007.fits -> ./linesum-O_III-5007.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_II-7318.fits -> ./linesum-O_II-7318.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_I-8446.fits -> ./linesum-O_I-8446.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-N_II-6583.fits -> ./linesum-N_II-6583.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_III-5270-multibin-SN0005.fits -> ./linesum-Fe_III-5270-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_II-7330.fits -> ./linesum-O_II-7330.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_I-8446-multibin-SN0005.fits -> ./linesum-O_I-8446-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Ni_II-7378-multibin-SN0005.fits -> ./linesum-Ni_II-7378-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Fe_II-8617-multibin-SN0005.fits -> ./linesum-Fe_II-8617-multibin-SN0005.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-S_III-9069.fits -> ./linesum-S_III-9069.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-Ar_III-7136.fits -> ./linesum-Ar_III-7136.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/linesum-O_III-5007.fits -> ./linesum-O_III-5007.fits
/Volumes/SSD-2TB/OrionMuse/LineMaps/ratio-5007-7318.fits -> ./ratio-5007-7318.fits
#+end_example
** Extra line ratios
*** O I / [O II]
#+begin_src python :dir ../Orion-HH-data/MUSE
  import numpy as np
  from astropy.io import fits

  hdu = {
      id_: fits.open(f"linesum-{id_}.fits")[0]
      for id_ in ["O_III-5007", "O_II-7330", "O_II-7318", "O_I-8446"]
  }

  pairs = [
      ["O_I-8446", "O_II-7330"],
      ["O_II-7318", "O_II-7330"],
      ["O_II-7318", "O_III-5007"],
  ]
  for wav1, wav2 in pairs:
      ratio = hdu[wav1].data/hdu[wav2].data
      fits.PrimaryHDU(
          header=hdu[wav1].header,
          data=ratio,
          ).writeto(f"ratio-{wav1}-{wav2}.fits", overwrite=True)

#+end_src

#+RESULTS:
: None

*** [Fe III] density and temperature sensitive
+ 4881/4658 varies from 0.3 @ 1000 pcc to 0.45 @ 1e4, then falls again at higher densities
+ 5271/4658 is mainly T sensitive when n = 1e3 \to 1e5: 0.6 @ 6000 K, falling to 0.4 @ 14,000 K
+ 4702/4658 is density-sensitive (and monotonic this time), from 0.26 @ 1000 pcc to 0.33 @ 1e4 pcc to 0.46 @ 1e5 pcc


#+begin_src python :dir ../Orion-HH-data/MUSE
  import numpy as np
  from astropy.io import fits

  hdu = {
      wav: fits.open(f"linesum-Fe_III-{wav}-bin004.fits")["SCALED"]
      for wav in ["4881", "5270", "4702", "4658"]
  }

  pairs = [
      ["4881", "4658"],
      ["5270", "4658"],
      ["4702", "4658"],
  ]
  mask = (hdu["4658"].data > 15000.0) 
  for wav1, wav2 in pairs:
      ratio = hdu[wav1].data/hdu[wav2].data
      ratio[~mask] = np.nan
      fits.PrimaryHDU(
          header=hdu[wav1].header,
          data=ratio,
          ).writeto(f"ratio-Fe_III-{wav1}-{wav2}-bin004.fits", overwrite=True)

#+end_src

#+RESULTS:
: None

Measurements of features in [Fe III] lines

#+name: fe-iii-ratios
| Feature       | 4658 | 4702/4658     | 4881/4658     | 5270/4658     | N(S II)/1000 |
|---------------+------+---------------+---------------+---------------+--------------|
| Outside Bar   |      | 0.26 +/- 0.06 | 0.37 +/- 0.05 | 0.56 +/- 0.06 |              |
| Bar NE        |      | 0.29 +/- 0.04 | 0.42 +/- 0.04 | 0.57 +/- 0.05 |              |
| HH 204        |      | 0.30 +/- 0.05 | 0.45 +/- 0.03 | 0.64 +/- 0.06 |              |
| HH 203        |      | 0.31 +/- 0.07 | 0.43 +/- 0.03 | 0.61 +/- 0.04 |              |
| Bar SW        |      | 0.31 +/- 0.06 | 0.44 +/- 0.06 | 0.58 +/- 0.06 |              |
| HH 529-III/II |      | 0.31 +/- 0.07 | 0.46 +/- 0.07 | 0.59 +/- 0.08 |              |
| knots         |      | 0.32 +/- 0.07 | 0.48 +/- 0.06 | 0.56 +/- 0.13 |              |
| shock         |      | 0.32 +/- 0.05 | 0.47 +/- 0.05 | 0.66 +/- 0.06 |              |
| minibar       |      | 0.32 +/- 0.04 | 0.43 +/- 0.02 | 0.60 +/- 0.06 | 8.4 +/- 1.0  |
| HH 202        |      | 0.33 +/- 0.04 | 0.48 +/- 0.05 | 0.59 +/- 0.04 | 5.0 +/- 1.2  |
| HH 529-0      |      | 0.35 +/- 0.03 | 0.45 +/= 0.06 | 0.68 +/- 0.05 |              |
| HH 269 base   |      | 0.37 +/- 0.06 | 0.32 +/- 0.02 | 0.64 +/- 0.06 |              |


** Region for the slit
+ Slit size: 1 x 12 arcsec in red; 1 x 10 arcsec in blue
+ Slit center: RA(J2000) 05:35:16.80, DEC(J2000) -05:23:57.48
* TODO Compare with SPM horizontal slits
+ For instance [[file:~/Dropbox/SPMFEB13/OrionS/spm-vstack-oiii.fits][file:~/Dropbox/SPMFEB13/OrionS/spm-vstack-oiii.fits]]
+ Zoom factor needs to be 4.5x10 to match 1.68 on MUSE images
+ Bowshock III and bowshock-east show up best in the Vhel = +4 channel
  + /actually, +5.6 - see [[id:E11A6C8A-C304-41E8-A374-8D4E67665D1A][below]]/
+ II and the III knot show up best around -28
+ 0 and Ram show peak atound -46
+ /strange velocity gradient/
  + Diagonally across II/III from NW \to SE
** Analysis of Bowshock III profile
:PROPERTIES:
:ID:       E11A6C8A-C304-41E8-A374-8D4E67665D1A
:END:
 + III bowshock contrast (wrt interpolation from either side)
   + -4.4 : 1500 = 300% - starting to see knot too
   + -2.4 : 2000 = 400%
   + -0.4 : 2400 = 400%
   + +1.6 : 2500 = 250%
   + +3.6 : 2700 = 180%
   + +5.6 : 2800 = 107%
   + +7.6 : 2700 = 67%
   + +9.6 : 2500 = 42%
   + +11.6 : 2000 = 25%
   + +13.6 : 1750 = 20%
   + +15.6: 1500 = 16%
   + +17.6: 1000 = 11%
 + So, peak is at +5.6
 + Also, half-maximum points are at [-4.4, +15.6], with mean at +5.6 too
** Yet another component at -12 km/s
+ This is strongest in S wing of III
+ 
** Implication for 3D kinematics
* Flow from HH 1149-CW down to Bright Bar
+ There are some bright knots just below HH 529-III
  + [[file:~/Dropbox/Orion-HH-data/MUSE/fe-ii-knots.reg][file:~/Dropbox/Orion-HH-data/MUSE/fe-ii-knots.reg]]
  + They turn out to be HH 1149-CW bows
+ I had thought this might be feeding HH 203
  + But now it doesn't look like it
+ Some interesting low-ionization knots near HST 10
  + [[file:~/Dropbox/Orion-HH-data/MUSE/oi-sii-knots.reg][file:~/Dropbox/Orion-HH-data/MUSE/oi-sii-knots.reg]]
  + Possibly an extension of the HH 1149-CW flow
  + Not moving very fast
    + At least that is what I get by comparing by eye F658N 1996 with F373N 2015
      + ~final658-radec.fits~
        + Shifted 5 pix to CRPIX1=1360
      + ~icaz02040_drz.fits~
    + Also possibly visible in 2005 ACS F658N

* Interesting proper motion projects in the field of HH 529
** Colliding shocks - 162-341
+ Bow shock with fat shell driven by p159-350 (?) moving to NE at 15 km/s
+ Fainter, thinner bow shock moving to E at 25 km/s
  + Fed by jet from p155-337
** Overlapping filaments - 152-359 and 153-360
+ These look like these are a super-slow jet that is feeding HH 1149-CW
+ But actually they are the wings of the HH 529 bow shocks passing over a stationary filament
** Moving dark filament
** Multipolar jet from 160-353
+ Star is AC Ori, also known as:
  + [HC2000] 202 - near-IR
  + COUP 768 - X-ray
  + JW503
  + [FRM2016] 266 - Radio
+ 
** New proplyd? 170-360
+ This is projected onto the HH 529-III shock
+ It has a shadow disk, surrounded by faint, circularly symmetric emission
+ This is similar to 171-340, but even more circular
+ Looking in catalogues
  + Coordinates are 5:35:16.9570 -5:23:59.567
  + Searching in SIMBAD finds MLLA 264
    + Muench:2002a - The Luminosity and Mass Function of the Trapezium Cluster: From B Stars to the Deuterium-burning Limit
    + Source 264 in catalog
    + Coordinates 05 35 16.95, -05 23 59.6
      + Agree within 0.1 arcsec
    + [[https://vizier.u-strasbg.fr/viz-bin/VizieR-5?-ref=VIZ5efd0fa33bb9&-out.add=.&-source=J/ApJ/573/366/table6&recno=274][Full record for this source]]
    + Only photometry is from NTT
      + J = 15.26 +/- 0.16
      + H = 14.62 +/- 0.06
      + K = 13.90 +/- 0.01
    + Cross-ref to [HC2000] 182
      + This is Hillenbrand:2000a
      + Same coords (within 0.1 arcsec)
      + H=14.264, K=13.237 mags are a bit brighter
  + Other matches
    + [FRM2016] 329
      + Forbrich:2016a - Radio 4cm and 6cm survey
      + Flux density 0.1964 +/- 0.0026 mJy
    + Eisner:2018a
      + Calls it HC182
      + F(850 mic) = 2.0 +/- 0.2 mJy
      + F(dust) = 2.0 +/- 0.2 mJy
      + M(dust) = 3.5 +/- 0.3 Mearth = 1e-5 Msun
      + R(disk) = 14.8 +/- 1.9 AU = 0.03 arcsec
      + This puts it at the faint and small end of the distribution of detected sources
    + In the HST images I measure a disk shadow diameter of 0.13 arcsec
      + This gives a radius of 0.065 arcsec = 27 AU

*** Comparison with 175-355
+ 5:35:17.5401 -5:23:55.023
+ Previously classified as proplyd in OW94
+ Very similar morphology
  + Circular rim of Ha
  + Inner disk extinction
